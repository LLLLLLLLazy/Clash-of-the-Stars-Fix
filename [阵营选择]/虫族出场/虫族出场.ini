
[core]
name: 虫族出场
tags: 虫族出场
#displayText: 母巢
price: 0
maxHp: 4000
mass: 0
radius: 30
isBuilding: true

#隐藏单位本身
#showInEditor: false
fogOfWarSightRange: 10
ignoreInUnitCapCalculation: true
disableAllUnitCollisions: true
isUnselectable:	true
canNotBeDamaged: true
canOnlyBeAttackedByUnitsWithTags: 不可被攻击

#禁止死亡痕迹
numBitsOnDeath:	0
explodeOnDeath:	false
hideScorchMark: true

showOnMinimap: true

autoTriggerCooldownTime:0.01s
autoTriggerCooldownTime_allowDangerousHighCPU:true

energyMax: 1
energyRegen: 0
energyStartingPercentage: 0

canBuild_4_name: setRally

[canBuild_建造虫制造]
name: bugSpore
pos: 1

[canBuild_3]
name: 蚊子, 巡林者
pos: 2

[action_erosion]
@copyFromSection: template_腐蚀蔓延简介
isActive: if ${HalfCorrosion}
isGuiBlinking: if ${HalfCorrosion}
text: 腐蚀蔓延
#description: -请见复制自全局代码
displayType: infoOnly
convertTo: 母巢T2
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
convertTo_keepCurrentTags: true
addResources: hp=5000
isVisible: true
buildSpeed: 0s
pos: -1
ai_isHighPriority: true
temporarilyAddTags: 主母巢, 母巢T2
temporarilyRemoveTags: 狂猎时刻生产加速
alsoTriggerAction: 属性变化, 狂猎时刻, 首次半腐

[hiddenAction_首次半腐]
requireConditional: if not self.globalTeamTags(includes='首次半腐')
addGlobalTeamTags: 首次半腐
showMessageToPlayer: 腐蚀……
spawnUnits: 普拉克勒斯之眼

[hiddenAction_狂猎时刻]
requireConditional: if not self.globalTeamTags(includes='半腐狂猎') and self.globalTeamTags(includes='狂猎')
addGlobalTeamTags: 半腐狂猎
sendMessageTo: globalSearchForFirstUnit(withTag='单位系统', relation='own')
sendMessageWithTags: 狂猎时刻激活
sendMessageWithData: 时间=30
addResources: 腐蚀=500


[action_普拉克勒斯]
isVisible: if numberOfUnitsInTeam(withTag='天神草', lessThan=1, incompleteBuildings=true) and not self.globalTeamTags(includes='天神草初唤')
displayType: queueUnit
@define units: 天神草
textAddUnitName: ${units}
descriptionAddFromUnit: ${units}
descriptionAddUnitStats: ${units}
fireTurretXAtGround: 1
fireTurretXAtGround_withProjectile: summon
fireTurretXAtGround_onlyOverPassableTileOf: BUILDING
allowMultipleInQueue: false
highPriorityQueue: true
onlyOneUnitAtATime: true
unitShownInUI: 天神草
buildSpeed: 0s
pos: 10

[action_普拉克勒斯2]
isVisible: if numberOfUnitsInTeam(withTag='天神草', lessThan=1, incompleteBuildings=true) and self.globalTeamTags(includes='天神草初唤')
@copyFromSection: action_普拉克勒斯
textPostFix: (腐蚀: 500)
price: 腐蚀=500
pos: 10

[action_快捷选择-衍黎]
removeGlobalTeamTags: 选择衍黎
isVisible: if numberOfUnitsInTeam(withTag='天神草', lessThan=1, incompleteBuildings=true) and not self.globalTeamTags(includes='天神草初唤')
displayType: queueUnit
text: 快捷选择·衍黎
description: -快速放置普拉克勒斯并选择分支[衍黎]
iconExtraImage: 虫矿.png
fireTurretXAtGround: 1
fireTurretXAtGround_withProjectile: 天神草衍黎
fireTurretXAtGround_withOffset: 0, 80
addResources: setFlag=5
onlyOneUnitAtATime: true
allowMultipleInQueue: false
highPriorityQueue: true
alwaysSinglePress: true
buildSpeed: 0s
pos: 10.1
[action_快捷选择-狂猎]
@copyFromSection: action_快捷选择-衍黎
removeGlobalTeamTags: 选择狂猎
text: 快捷选择·狂猎
description: -快速放置普拉克勒斯并选择分支[狂猎]
iconExtraImage: 虫矿[狂猎].png
fireTurretXAtGround_withProjectile: 天神草狂猎
addResources: 0
pos: 10.2

[canBuild_1]
#避免开局判定失败
name:礼花
pos:100
isVisible: if not self.hasFlag(id=3)

[hiddenAction_create]
autoTrigger: if not self.hasFlag(id=1)
addResources: setFlag=1, energy=-1
spawnUnits: 母体(offsetY=700)

[hiddenAction_correct]
autoTrigger: if not self.hasFlag(id=2) and self.timeAlive(laterThanSeconds=2) and self.lastConverted(laterThanSeconds=2)
addResources: setFlag=2

[hiddenAction_receive]
autoTrigger: if self.hasFlag(id=2) and not self.hasFlag(id=3) and not self.hasFlag(id=4)
addResources: setFlag=3
spawnEffects: CUSTOM:影散, CUSTOM:核眼, CUSTOM:projectileLight2, 黑影胞, 消莹胞, 散莹雾
offsetSelfAbsolute:	0, 0, -20
convertTo: 虫族出场[可选中]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}

[hiddenAction_receive2]
@copyFromSection: hiddenAction_receive
autoTrigger: if self.hasFlag(id=2) and not self.hasFlag(id=3) and self.hasFlag(id=4)
spawnEffects: CUSTOM:核眼, CUSTOM:projectileLight2

[hiddenAction_rise]
autoTrigger: if self.hasFlag(id=3) and self.height(greaterThan=-15, lessThan=0)
offsetSelfAbsolute:	0, 0, 1

[hiddenAction_appear]
autoTrigger: if self.hasFlag(id=3) and self.isAtGroundHeight and not self.hasFlag(id=5)
fireTurretXAtGround: explode
fireTurretXAtGround_withProjectile: explode
fireTurretXAtGround_withOffset: 0, 0
spawnEffects: CUSTOM:绿闪光
convertTo: 母巢
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
produceUnits: bugSpore
alsoQueueAction: 起始建造者+
#playSoundAtUnit: large_gun_fire2:0.3
#deleteSelf: true

[hiddenAction_起始建造者+]
id: 起始建造者+
buildSpeed: 0s

[hiddenAction_appearYanli]
@copyFromSection: hiddenAction_appear
autoTrigger: if self.hasFlag(id=3) and self.isAtGroundHeight and self.hasFlag(id=5)
fireTurretXAtGround_withProjectile: explode衍

[graphics]
isVisible: if self.hasFlag(id=3)
image:   ROOT:/-虫族-/建筑虫/建筑_母巢/母巢_back.png
scaleImagesTo: 60
image_wreak: NONE
disableLowHpSmoke: true
disableLowHpFire: true
icon_zoomed_out_neverShow: true
showHealthBar: false
showEnergyBar: false

[attack]
canAttack: false
maxAttackRange: 280

[turret_1]
x: 0
y: 25
shoot_light: #FF00CCCC

[turret_explode]
x:0
y:0
canShoot:false
projectile:explode

[projectile_explode]
life:99
instant:true
largeHitEffect:true
targetGround:true
areaDamage:0
areaRadius:180
spawnProjectilesOnExplode:explode2*5
explodeEffect: CUSTOM:shockwavebig

[projectile_explode衍]
@copyFromSection: projectile_explode
spawnProjectilesOnExplode: explode2*2, 衍黎弹*3


[projectile_explode2]
life:99

speed: 2
targetSpeed: 5
targetSpeedAcceleration: 0.07
initialUnguidedSpeedY: -0.5

explodeOnEndOfLife:true
targetGround:true
targetGroundSpread:150
areaDamage:0
areaRadius:60
frame:6
drawSize:1.5
deflectionPower: -1

initialUnguidedSpeedHeight: 1.2
gravity:0.18

lightSize: 0.6
lightColor: #FF3BFF00
explodeEffect: CUSTOM:explodeSmall, CUSTOM:shockwave, CUSTOM:shockwave2, CUSTOM:绿光, CUSTOM:绿闪光

[projectile_衍黎弹]
@copyFromSection: projectile_explode2
targetGroundSpread: 250
spawnUnit: 虫塔(gridAlign=true, addResources=野性:1)

[resource_野性]
displayName: 野性


[projectile_summon]
life: 60
instant: true
areaDamage: 0
spawnUnit: 天神草(alwayStartDirAtZero=true)
explodeEffect: CUSTOM:毒雾3*4

[projectile_天神草衍黎]
@copyFromSection: projectile_summon
spawnUnit: 天神草(alwayStartDirAtZero=true, addResources=setFlag:1)

[projectile_天神草狂猎]
@copyFromSection: projectile_summon
spawnUnit: 天神草(alwayStartDirAtZero=true, addResources=setFlag:2)

[effect_毒雾3]
stripIndex: effects
frameIndex: 0
priority:low

life: 200
fadeOut: true
attachedToUnit: false
color: #AEFF00
fadeInTime:5
hSpeed: 0.8
scaleFrom: 1.0
scaleTo: 2.5
alpha: 0.4
drawUnderUnits:false
#yOffsetRelative:-7
xSpeedRelativeRandom:0.2
ySpeedRelativeRandom:0.2

shadow: true
atmospheric: true


[effect_explodeSmall]
life: 25
image: explode_big2.png
scaleFrom: 0.9
scaleTo: 0.9
alpha: 0.8
total_frames: 14
animateFrameStart: 0
animateFrameEnd: 13
animateFrameSpeed: 0.5
fadeOut: false

[effect_shockwave]
stripIndex: shockwave
life: 25
scaleFrom: 0
scaleTo: 1
alpha: 0.8
dirSpeed: 5
drawUnderUnits: true

[effect_shockwave2]
@copyFromSection: effect_shockwave
life: 30
scaleTo: 1.3
color: #FF3BFF00
dirSpeed: -5

[effect_shockwavebig]
@copyFromSection: effect_shockwave
life: 20
scaleTo: 1.8
dirSpeed: 0

[effect_绿光]
image: SHARED:light_50.png
life: 40
fadeOut: true
color: #3BFF00
scaleFrom: 1.2
scaleTo: 0.6
alpha: 0.6
drawUnderUnits: true

[effect_绿闪光]
@copyFromSection: effect_绿光
life: 20
scaleFrom: 1.7
scaleTo: 1.3

[movement]
movementType: NONE
moveSpeed: 0
moveAccelerationSpeed: 0
moveDecelerationSpeed: 0
heightChangeRate: 20

[effect_影散]
attachedToUnit: true
createWhenOffscreen: true
priority: critical
image: 别西卜模糊伸影.png
life: 30
scaleFrom: 6.5
scaleTo: 10
alpha: 0.6
total_frames: 2
animateFrameStart: 0
animateFrameEnd: 1
animateFrameSpeed: 0.5
animateFrameLooping: true
ySpeedRelative: 3

[effect_黑影胞]
attachedToUnit: true
createWhenOffscreen: true
priority: critical
image: 模糊神经元胞B.png
life: 40
fadeInTime: 2
scaleFrom: 1
scaleTo: 0.1
alpha: 1
color: #000000
dirOffsetRandom: 180
dirSpeed: 16
trailEffect: 随影胞
trailEffectRate: 2

[effect_随影胞]
attachedToUnit: false
createWhenOffscreen: true
priority: critical
image: 模糊神经元胞B.png
life: 15
lifeRandom: 5
fadeInTime: 2
scaleFrom: 0.6
scaleTo: 0.1
alpha: 0.4
color: #3BFF00
ySpeedRelative: 3
yOffsetRelativeRandom: 1
drawUnderUnits: true

[effect_消莹胞]
createWhenOffscreen: true
priority: critical
image: 模糊神经元胞B.png
life: 150
fadeInTime: 5
scaleFrom: 0.6
scaleTo: 0.7
alpha: 0.2
color: #3BFF00
delayedStartTimer: 35
drawUnderUnits: true

[effect_散莹雾]
attachedToUnit: true
createWhenOffscreen: true
priority: critical
image: fog.png
life: 50
fadeInTime: 5
scaleFrom: 0.6
scaleTo: 2
alpha: 0.5
color: #3BFF00
dirOffsetRandom: 180
delayedStartTimer: 35


[effect_核眼]
attachedToUnit: true
createWhenOffscreen: true
priority: critical
image: 核心.png
life: 60
scaleFrom: 2
scaleTo: 3.5
alpha: 1

[effect_projectileLight]
#未使用
priority:veryhigh
image: SHARED:light_50.png
life: 200
fadeOut: true
attachedToUnit: true
color: #FF3BFF00
fadeInTime:20
scaleFrom: 2.4
scaleTo: 2.4
alpha: 1
drawUnderUnits: true
liveAfterAttachedDies: false

[effect_projectileLight2]
@copyFromSection: effect_projectileLight
life: 60
fadeInTime: 15
scaleFrom: 2.4
scaleTo: 1.2
alpha: 2
drawUnderUnits: false


[global_resource_玩家总数]
displayName: 玩家总数
