[core]



name: 母巢T2
maxHp: 5000
mass: 1000
price: 10800
tags: units, 虫族, 虫建筑, 腐蚀蔓延, 母巢, 母巢T2, 基地, 资源池建筑
radius: 35
selfRegenRate: 0.3
isBuilding: true
isBug:true
isBio:true
isPickableStartingUnit:true
footprint: -1,-1,1,1
constructionFootprint: -1,-1,1,1
placeOnlyOnResPool: false
buildSpeed: 15s
generation_resources: 腐蚀=2
generation_credits: 50
fogOfWarSightRange: 34
nanoFactorySpeed: 2
displayDescription: -虫族阵营 \n -产出资源与腐蚀 \n -被毁后会对己方造成小范围击退|对建筑造成大量伤害 \n -起始基地被毁会损失资源 \n -腐蚀的蔓延 ${diYanli}
@define diYanli:\n -毒素附加: 50

energyMax: 2

effectOnDeath: CUSTOM:shockwaveLarge, CUSTOM:explosionFlashLarge, CUSTOM:motherLight
soundOnDeath: bug_die:1

[hiddenAction_破碎之星]
autoTriggerOnEvent: destroyed
requireConditional: if self.hasResources(起始基地=1)
spawnUnits: 碎星核, 基地亡语, 赛法草(offsetHeight=-8, addResources=setFlag:1)

[resource_起始基地]
displayName: 起始基地

[resource_AI快捷分支随机]
hidden: true
displayName: AI快捷分支随机

[hiddenAction_主母巢]
autoTriggerOnEvent: newMessage(withTag='主母巢')
temporarilyAddTags: 主母巢

[hiddenAction_主母巢移除]
autoTrigger: if globalSearchForFirstUnit(withTag='主母巢', relation='own')!=self and globalSearchForFirstUnit(withTag='主母巢', relation='own')!=null
temporarilyRemoveTags: 主母巢


[hiddenAction_erosions]
requireConditional: if self.globalTeamTags(includes='衍黎')
autoTriggerOnEvent: created
autoTrigger: if self.customTimer(laterThanSeconds=60)
spawnEffects: custom:curewave
resetCustomTimer: true

[effect_curewave]
priority: critical
liveAfterAttachedDies: false
fadeOut: false
attachedToUnit: true
drawUnderUnits: true
image: SHARED:light_50.png
color: #AEFF00
life: 3660
scaleFrom: 16.0
scaleTo: 16.0
alpha: 0.1

[hiddenAction_狂猎]
autoTrigger:if self.globalTeamTags(includes='狂猎')
convertTo: 母巢T2[狂猎]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}


[canBuild_设置集结点]
name: setRally
pos:  -1

[canBuild_建造虫制造]
name: bugSpore
pos: 2
isVisible: if not self.globalTeamTags(includes='AI系统') or not self.globalTeamTags(includes='战隙{I}') or self.globalTeamTags(includes='中刻{I}')
isLocked: if self.globalTeamTags(includes='AI系统')
isLockedMessage: AI:已离开前期阶段,不制造此单位

[canBuild_bugFly]
name: bugFly
pos: 2.4

[canBuild_T2]
name: 两栖蝇
pos: 2.5
isVisible: if not self.globalTeamTags(includes='AI系统') or numberOfUnitsInTeam(withTag='两栖蝇', greaterThan=2, withinRange=1000)

[canBuild_3]
name: 蚊子
pos: 3
isLocked: if self.globalTeamTags(includes='AI系统')
isLockedMessage: AI:已离开前期阶段,不制造此单位

[canBuild_3.2]
name: 巡林者
pos: 3.2
isLocked: if self.globalTeamTags(includes='AI系统')
isLockedMessage: AI:已离开前期阶段,不制造此单位

[canBuild_5]
name: 收成者
pos: 5
isVisible: if (${CompleteCorrosion} ${CompleteCorrosionLimit}) and ( not self.globalTeamTags(includes='AI系统') or numberOfUnitsInTeam(withTag='修复点', greaterThan=0, withinRange=1000))


[action_普拉克勒斯]
isVisible: if numberOfUnitsInTeam(withTag='天神草', lessThan=1, incompleteBuildings=true) and not self.globalTeamTags(includes='天神草初唤')
displayType: queueUnit
@define units: 天神草
textAddUnitName: ${units}
descriptionAddFromUnit: ${units}
descriptionAddUnitStats: ${units}
fireTurretXAtGround: 1
fireTurretXAtGround_withProjectile: summon
fireTurretXAtGround_onlyOverPassableTileOf: BUILDING
allowMultipleInQueue: false
highPriorityQueue: true
onlyOneUnitAtATime: true
unitShownInUI: 天神草
buildSpeed: 0s
pos: 0.5

[action_普拉克勒斯2]
isVisible: if numberOfUnitsInTeam(withTag='天神草', lessThan=1, incompleteBuildings=true) and self.globalTeamTags(includes='天神草初唤')
@copyFromSection: action_普拉克勒斯
textPostFix: (腐蚀: 1000)
price: 腐蚀=1000
pos: 10

[action_快捷选择-衍黎]
autoTrigger: if self.globalTeamTags(includes='选择衍黎') and not self.globalTeamTags(includes='天神草初唤')
removeGlobalTeamTags: 选择衍黎
isVisible: if numberOfUnitsInTeam(withTag='天神草', lessThan=1, incompleteBuildings=true) and not self.globalTeamTags(includes='天神草初唤')
displayType: queueUnit
text: 快捷选择·衍黎
description: -快速放置普拉克勒斯并选择分支[衍黎]
fireTurretXAtGround: 1
fireTurretXAtGround_withProjectile: 天神草衍黎
fireTurretXAtGround_withOffset: 0, 40
onlyOneUnitAtATime: true
allowMultipleInQueue: false
highPriorityQueue: true
alwaysSinglePress: true
buildSpeed: 0s
pos: 0.51
[action_快捷选择-狂猎]
@copyFromSection: action_快捷选择-衍黎
autoTrigger: if self.globalTeamTags(includes='选择狂猎') and not self.globalTeamTags(includes='天神草初唤')
removeGlobalTeamTags: 选择狂猎
text: 快捷选择·狂猎
description: -快速放置普拉克勒斯并选择分支[狂猎]
fireTurretXAtGround_withProjectile: 天神草狂猎
pos: 0.52

[hiddenAction_AI升级T2快捷分支随机数]
autoTriggerOnEvent: created
autoTrigger: if self.globalTeamTags(includes='AI系统') and not self.globalTeamTags(includes='天神草初唤') and numberOfUnitsInTeam(withTag='天神草', lessThan=1, incompleteBuildings=true)
setResourcesWithLogic: AI快捷分支随机=rnd(0,100)

[hiddenAction_AI升级T2快捷分支-衍黎]
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.timeAlive(laterThanSeconds=0.2) and not self.tags(includes='AI快捷分支已选') and not self.globalTeamTags(includes='天神草初唤') and numberOfUnitsInTeam(withTag='天神草', lessThan=1, incompleteBuildings=true) and self.resource(type='AI快捷分支随机', lessThan=50)
alsoQueueAction: 快捷选择-衍黎
temporarilyAddTags: AI快捷分支已选

[hiddenAction_AI升级T2快捷分支-狂猎]
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.timeAlive(laterThanSeconds=0.2) and not self.tags(includes='AI快捷分支已选') and not self.globalTeamTags(includes='天神草初唤') and numberOfUnitsInTeam(withTag='天神草', lessThan=1, incompleteBuildings=true) and self.resource(type='AI快捷分支随机', greaterThan=49)
alsoQueueAction: 快捷选择-狂猎
temporarilyAddTags: AI快捷分支已选

[action_trigger]
autoTrigger: if self.energy(greaterThan=0) and self.globalTeamTags(includes='衍黎')
addResources: energy=-1
fireTurretXAtGround: 1
fireTurretXAtGround_withOffset:0,0
fireTurretXAtGround_withProjectile: 衍黎塔
alsoTriggerAction: 腐蚀塔
isVisible: false

[action_trigger2]
autoTrigger: if self.globalTeamTags(includes='衍黎')
fireTurretXAtGround: magic
fireTurretXAtGround_withOffset:0,0
fireTurretXAtGround_withProjectile: 衍黎复
isVisible: false

[hiddenAction_腐蚀塔]
requireConditional: if self.globalTeamTags(includes='衍黎') and self.globalTeamTags(includes='狂猎')
fireTurretXAtGround: 1
fireTurretXAtGround_withOffset:0,0
fireTurretXAtGround_withProjectile: 腐蚀塔

[action_erosion]
@copyFromSection: template_腐蚀蔓延简介
@define descriptionPrefix: -正在扩散......\n
isActive: false
text: 腐蚀蔓延
#description: -正在扩散……\n${DescriptionCorrosionSpread}
displayType: infoOnly
#isGuiBlinking:  if numberOfUnitsInTeam(withTag='腐蚀蔓延', greaterThan=5)
iconImage: 母巢_back.png
isVisible: if not ${CompleteCorrosion}
buildSpeed: 0s
pos: -1

[action_erosion2]
isActive: if ${CompleteCorrosion} and not self.globalTeamTags(includes='扩散达成')
isGuiBlinking: if ${CompleteCorrosion}
text: 腐蚀蔓延
description: -扩散达成\n-腐蚀蔓延进度: (%{min( (numberOfUnitsInTeam(withTag='腐蚀蔓延')+self.numberOfUnitsInAllyNotOwnTeam(withTag='腐蚀蔓延')-self.numberOfUnitsInAllyNotOwnTeam(withTag='主母巢')) / max(11, numberOfUnitsInAllTeams(withTag='资源池')/max(self.resource.玩家总数, 2)*2) * 100, select(numberOfUnitsInTeam(withTag='星核')+self.numberOfUnitsInAllyNotOwnTeam(withTag='星核')<=0, 99.99, 100))}%%{select(numberOfUnitsInTeam(withTag='星核')+self.numberOfUnitsInAllyNotOwnTeam(withTag='星核')<=0, '|缺少星核', '')})
displayType: infoOnly
iconImage: 母巢_back.png
isVisible: if ${CompleteCorrosion}
addGlobalTeamTags: 扩散达成
buildSpeed: 0s
pos: -0.9
ai_isHighPriority: true
allowMultipleInQueue: false
showMessageToAllPlayers: 扩散……达成
sendMessageTo: globalSearchForFirstUnit(withTag='单位系统', relation='own')
sendMessageWithTags: 狂猎时刻激活
sendMessageWithData: 时间=40, 色幕=2
alsoTriggerAction: 狂猎时刻
spawnUnits: 普拉克勒斯之眼*3
spawnEffects: 黑影胞, 腐蚀胞波
playSoundAtUnit: Darkness5.ogg:0.15

[hiddenAction_狂猎时刻]
requireConditional: if self.globalTeamTags(includes='狂猎')
addResources: 腐蚀=1000

[hiddenAction_全腐提示]
autoTrigger: if ${CompleteCorrosion} and not self.globalTeamTags(includes='全腐提示')
addGlobalTeamTags: 全腐提示
showQuickWarLogToPlayer: 腐蚀蔓延扩散条件已达成

[effect_黑影胞]
attachedToUnit: true
createWhenOffscreen: true
priority: critical
image: 模糊神经元胞B.png
life: 40
fadeInTime: 2
scaleFrom: 1
scaleTo: 0.1
alpha: 1
color: #000000
dirOffsetRandom: 180
dirSpeed: 16
trailEffect: 随影胞
trailEffectRate: 2

[effect_随影胞]
attachedToUnit: false
createWhenOffscreen: true
priority: critical
image: 模糊神经元胞B.png
life: 15
lifeRandom: 5
fadeInTime: 2
scaleFrom: 0.6
scaleTo: 0.1
alpha: 0.4
color: #3BFF00
ySpeedRelative: 3
yOffsetRelativeRandom: 1
drawUnderUnits: true

[effect_腐蚀胞波]
attachedToUnit: false
createWhenOffscreen: true
priority: critical
stripIndex: shockwave_large
life: 120
fadeInTime: 2
scaleFrom: 0
scaleTo: 9
alpha: 0.5
color: #3BFF00
dirOffsetRandom: 180
dirSpeed: 8
drawUnderUnits: true


[action_生存防御巩固]
@copyFromSection: template_生存防御巩固
@define buildMultiplier: 2
pos: 0.1

[effect_生存防御巩固形]
@copyFromSection: template_生存防御巩固形


#--------------------
[action_沙盒-获取腐蚀蔓延]
isVisible: if substring(str(createMarker(x=-1000,y=-1000).nearestUnit),0,15) == "editorOrBuilder"
displayType: action
id: ${section.text}
text: 沙盒-获取腐蚀蔓延
description: -沙盒特供 \n -300范围内随机位置生成8个赛法草+1个星核
iconImage: SHARED:cone_inverted_normal_128.png
spawnUnits: 赛法草*8(offsetRandomXY=300, falling=true), 星核(offsetRandomXY=300, falling=true)
highPriorityQueue: true
buildSpeed: 0.05s
#--------------------


[hiddenAction_阵营]
autoTrigger: if not self.globalTeamTags(includes='虫族')
addGlobalTeamTags: 虫族


[hiddenAction_顶点之处]
autoTrigger: if self.globalTeamTags(includes="顶点") and not self.tags(includes="顶点之处")
temporarilyAddTags: 顶点之处

[hiddenAction_落下顶点]
autoTrigger: if not self.globalTeamTags(includes="顶点") and self.tags(includes="顶点之处")
temporarilyRemoveTags: 顶点之处

[animation_1]
onActions:idle, move, attack
pingPong: true
scale_start: 1
scale_end: 1.01
speed: 80

[graphics]
image: 母巢T2.png
image_back: 母巢T2_back.png
scaleImagesTo: 75
showEnergyBar: false

[attack]
canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits: true
canAttackUnderwaterUnits: false
maxAttackRange: 330
shootDelay: 45
[movement]
movementType: BUILDING
[turret_1]
x: 0
y: 25
invisible: true
projectile: 1
turnSpeedAcceleration: 1.0
shoot_light:#FF00CCCC

[projectile_1]
tags= T-projectile
directDamage: 100
initialUnguidedSpeedY: -5
lightColor:#00ff00
lightSize:0.6
life: 150
speed: 1
targetSpeed: 15
largeHitEffect:true
frame: 6
drawSize: 1.1
trailEffect: CUSTOM:尾气雾

spawnUnit: 有毒的雾
mutatorX_ifUnitWithoutTags: 毒免疫, 效果免疫, 不会受伤
mutatorX_addResourcesDirectHit: 毒素=50

[resource_毒素]
displayName: 毒素

[turret_magic]
x: 0
y: 0
canShoot: false

[projectile_衍黎塔]
tags= T-projectile
life: 50
speed: 1000
invisible: true
deflectionPower: -1
flameWeapon: true

targetGround:true
targetGroundSpread: 330

areaDamage: 0
areaRadius: 0

explodeEffect:NONE
spawnUnit: 虫塔(spawnChance=0.9, maxSpawnLimit=1, gridAlign=true, addResources=野性:1), 赛法草(maxSpawnLimit=1, gridAlign=true)

[projectile_腐蚀塔]
@copyFromSection: projectile_衍黎塔
spawnUnit: 毒蚀塔(spawnChance=0.1, gridAlign=true, addResources=野性:1)

[resource_野性]
displayName: 野性


[projectile_衍黎复]
tags= T-projectile
areaDamage:-8
areaRadius:330
areaDamageNoFalloff:true
areaHitAirAndLandAtSameTime:true
areaHitUnderwaterAlways:true
life:50
instant: true
targetGround:true
friendlyFire:only-ignoreEnemy
mutator1_ifUnitWithTags: 中立资源
mutator1_areaDamageMultiplier: 0
explodeEffect:NONE

[projectile_summon]
tags= T-projectile
life: 60
instant: true
areaDamage: 0
spawnUnit: 天神草(alwayStartDirAtZero=true)
explodeEffect: CUSTOM:毒雾3*4

[projectile_天神草衍黎]
@copyFromSection: projectile_summon
spawnUnit: 天神草(alwayStartDirAtZero=true, addResources=setFlag:1)

[projectile_天神草狂猎]
@copyFromSection: projectile_summon
spawnUnit: 天神草(alwayStartDirAtZero=true, addResources=setFlag:2)

[effect_尾气雾]
stripIndex: effects
frameIndex: 0
priority: veryhigh

life: 20
fadeOut: true
attachedToUnit: false
color: #FF3BFF00
hSpeed: 0.3
scaleFrom: 0.7
scaleTo: 0.1
alpha: 0.6
drawUnderUnits: false
yOffsetRelative: -1
xOffsetRelativeRandom: 2
xSpeedRelativeRandom: 0.1
atmospheric: true

[effect_毒雾3]
stripIndex: effects
frameIndex: 0
priority:low

life: 200
fadeOut: true
attachedToUnit: false
color: #AEFF00
fadeInTime:5
hSpeed: 0.8
scaleFrom: 1.0
scaleTo: 2.5
alpha: 0.4
drawUnderUnits:false
#yOffsetRelative:-7
xSpeedRelativeRandom:0.2
ySpeedRelativeRandom:0.2

shadow: true
atmospheric: true


[effect_shockwaveLarge]
stripIndex: shockwave_large
scaleFrom: 0.2
scaleTo: 1.7
life: 36
alpha: 0.4
color: #FF3BFF00

[effect_explosionFlashLarge]
image: SHARED:light_50.png
scaleFrom: 4
scaleTo: 4
life: 20
fadeOut: true
priority: critical
color: #FF3BFF00

[effect_motherLight]
image: SHARED:light_50.png
life: 45
fadeOut: true
color: #FF3BFF00
scaleFrom: 1
scaleTo: 1





#————联动-未来科技:皎红————

@global JiaohongYanli: (self.globalTeamTags(includes='衍黎') and self.globalTeamTags(includes='皎红'))

[hiddenAction_虚红感染区]
autoTrigger: if ${JiaohongYanli} and not self.tags(includes='虚红感染区')
temporarilyAddTags: 虚红感染区

[hiddenAction_虚红感染雾]
autoTrigger: if numberOfUnitsInTeam(withTag='虚红感染区', withinRange=600)<3 and ${JiaohongYanli}
spawnEffects: 感染*3

[effect_感染]
priority: verylow
life: 300
fadeInTime: 30
image: fog.png
color:#ff0000
scaleFrom:2
scaleTo:2.5
attachedToUnit:false
drawUnderUnits: true
alpha:0.1
atmospheric: true
ySpeedAbsolute:-0.2
xSpeedRelativeRandom:0.1
delayedStartTimerRandom:60
hSpeed:0.3
hSpeedRandom:0.1
dirSpeedRandom: 0.1
dirOffsetRandom: 180
xOffsetRelativeRandom:420
yOffsetRelativeRandom:420


[template_提取目标]
takeResources_includeUnitsWithinRange: 600
takeResources_includeUnitsWithinRange_team: own
takeResources_excludeUnitsWithoutTags: units
takeResources_discardCollected: true
takeResources_maxUnits: 9999

[template_提取目标2]
@copyFromSection: template_提取目标
autoTrigger: if numberOfUnitsInTeam(withTag="units", greaterThan=0, withinRange=${section.takeResources_includeUnitsWithinRange}) and ${JiaohongYanli}


[hiddenAction_虚红感染附中检测]
@copyFromSection: template_提取目标2
autoTriggerOnEvent: newMessage(withTag='虚红感染更新')
autoTrigger: if numberOfUnitsInTeam(withTag="units", greaterThan=0, withinRange=${section.takeResources_includeUnitsWithinRange}) and ${JiaohongYanli} and numberOfUnitsInTeam(withTag='虚红感染附停系统激活')<1
requireConditional: if numberOfUnitsInTeam(withTag="units", greaterThan=0, withinRange=${section.takeResources_includeUnitsWithinRange}) and ${JiaohongYanli} and numberOfUnitsInTeam(withTag='虚红感染附停系统激活')<1
takeResources: hp=0
takeResources_excludeUnitsWithTheseResources: 虚红感染附中=10
takeResources_triggerActionForEach: 虚红感染附中

[hiddenAction_虚红感染附中]
requireConditional: if thisActionTarget.resource.虚红感染附停<1
takeResources: 虚红感染附中=-2, 虚红感染附停=-1
takeResources_includeReference: thisActionTarget
takeResources_discardCollected: true
sendMessageTo: globalSearchForFirstUnit(withTag='单位系统', relation='own')
sendMessageWithTags: 虚红感染附停激活

fireTurretXAtGround: magic
fireTurretXAtGround_withProjectile: 虚红感染特效
fireTurretXAtGround_withTarget: thisActionTarget.getOffsetAbsolute(y=-thisActionTarget.height)


[hiddenAction_虚红感染附加检测]
@copyFromSection: template_提取目标2
takeResources: hp=0
takeResources_excludeUnitsWithTheseResources: 虚红感染=2
takeResources_triggerActionForEach: 虚红感染时间

[hiddenAction_虚红感染时间]
requireConditional: if thisActionTarget.resource.虚红感染附中>=10
takeResources: 虚红感染=-1
takeResources_includeReference: thisActionTarget
takeResources_discardCollected: true


[hiddenAction_虚红感染负面检测]
@copyFromSection: template_提取目标2
takeResources: hp=0
takeResources_triggerActionForEach: 虚红感染负面恢复

[hiddenAction_虚红感染负面恢复]
requireConditional: if thisActionTarget.resource.虚红感染负面状态>=1
takeResources: 虚红感染负面状态=1, 负虚红感染=1
takeResources_includeReference: thisActionTarget
takeResources_discardCollected: true

fireTurretXAtGround: magic
fireTurretXAtGround_withProjectile: 虚红感染特效2
fireTurretXAtGround_withTarget: thisActionTarget.getOffsetAbsolute(y=-thisActionTarget.height)


[resource_虚红感染附中]
displayName: 虚红感染附中
hidden: true

[resource_虚红感染附停]
displayName: 虚红感染附停
hidden: true

[resource_虚红感染]
displayName: 虚红感染
hidden: true

[resource_虚红感染负面状态]
displayName: 虚红感染负面状态
hidden: true

[resource_负虚红感染]
displayName: 负虚红感染
hidden: true


[projectile_虚红感染特效]
directDamage: 0
invisible: true
life: 10
instant: true
targetGround_includeTargetHeight: true
explodeEffect: 虚红感染标, 虚红感染光, 虚红感染散

[projectile_虚红感染特效2]
@copyFromSection: projectile_虚红感染特效
explodeEffect: 虚红感染标, 弱虚红感染光, 弱虚红感染散


[effect_虚红感染标]
priority: low
life: 25
fadeInTime: 2
scaleFrom: 0.2
scaleTo: 0.25
alpha: 0.6
image: 皎红icon.png
attachedToUnit: true
alwayStartDirAtZero: true

[effect_虚红感染光]
priority: low
life: 30
scaleFrom: 1.3
scaleTo: 2.6
alpha: 1
image: SHARED:light_50.png
color: #FF0000
attachedToUnit: true
dirSpeedRandom: 3
dirOffsetRandom: 180

[effect_虚红感染散]
priority: low
life: 160
fadeOut: true
fadeInTime: 5
scaleFrom: 0.08
scaleTo: 0.2
alpha: 0.4
image: 红曜散裂.png
color: #FF0000
attachedToUnit: true

[effect_弱虚红感染光]
@copyFromSection: effect_虚红感染光
alpha: 0.8

[effect_弱虚红感染散]
@copyFromSection: effect_虚红感染散
life: 80
scaleTo: 0.16


[arm_1]
x: 0
y: 0
image_end: SHARED:blank.png
spinRate: 0.1

[arm_2]
@copyFromSection: arm_1
spinRate: 0.3

[arm_3]
@copyFromSection: arm_1
spinRate: -0.01

[decal_虚红感染区]
isVisible: if numberOfUnitsInTeam(withTag='虚红感染区', withinRange=600)<20 and ${JiaohongYanli}
alwaysStartHeightAtZero: true
layer: shadow
image: 红光圈2.png
basePositionFromLegEnd: arm1
imageScale: 2.7
alpha: 0.05

[decal_感染显示圈]
isVisible: if numberOfUnitsInTeam(withTag='虚红感染区', withinRange=80)<3 and ${JiaohongYanli}
alwaysStartHeightAtZero: true
alwaysStartDirAtZero: true
layer: beforeUI
image: 红范围圈1200.png
imageScale: ${600/600}
alpha: 0.4
onlyWhenSelectedByAnyPlayer: true

[decal_感染红区]
isVisible: if numberOfUnitsInTeam(withTag='虚红感染区', withinRange=600)<15 and ${JiaohongYanli}
alwaysStartHeightAtZero: true
layer: beforeUI
image: 红范围底.png
imageScale: ${600/600}
alpha: 0.05 / max( (numberOfUnitsInTeam(withTag='虚红感染区', withinRange=600) /2), 1 )

[decal_感染环圈]
@copyFromSection: decal_虚红感染区
isVisible: if numberOfUnitsInTeam(withTag='虚红感染区', withinRange=600)<3 and ${JiaohongYanli} and not self.globalTeamTags(includes='关闭感染区高级效果')
basePositionFromLegEnd: arm2
image: 红外光圈2.png
imageScale: ${2.7 * 0.73}

[decal_黑感染环圈]
@copyFromSection: decal_感染环圈
image: 黑红外光圈2.png
dirOffset: 60

[decal_感染裂面]
isVisible: if numberOfUnitsInTeam(withTag='虚红感染区', withinRange=600)<4 and ${JiaohongYanli} and not self.globalTeamTags(includes='关闭感染区高级效果')
alwaysStartHeightAtZero: true
layer: shadow
image: 红散裂.png
imageScale: ${2.7 * 0.15} * (0.95 + cos( ${timer_10s} * 360 - ${b}) * 0.05)
basePosition: getOffsetRelative(x=0, y=0, dirOffset=self.timeAlive-self.dir)
onlyWithZoomLevelOrMore: 0.7

@define timer_10s: ((self.timeAlive() % 10) / 10)
alpha: 0.05+cos( ${timer_10s} * 360 - ${b}) * 0.04
@define b: 0

[decal_感染裂面2]
@copyFromSection: decal_感染裂面
imageScale: ${2.7 * 0.2} * (0.95 + cos( ${timer_10s} * 360 - ${b}) * 0.05)
@define b: 72

[decal_感染裂面3]
@copyFromSection: decal_感染裂面
imageScale: ${2.7 * 0.3} * (0.95 + cos( ${timer_10s} * 360 - ${b}) * 0.05)
@define b: 144

[decal_感染裂面4]
@copyFromSection: decal_感染裂面
imageScale: ${2.7 * 0.45} * (0.95 + cos( ${timer_10s} * 360 - ${b}) * 0.05)
alpha: 0.04+cos( ${timer_10s} * 360 - ${b}) * 0.03
@define b: 216

[decal_感染裂面5]
@copyFromSection: decal_感染裂面
imageScale: ${2.7 * 0.65} * (0.95 + cos( ${timer_10s} * 360 - ${b}) * 0.05)
alpha: 0.04+cos( ${timer_10s} * 360 - ${b}) * 0.03
@define b: 288


[decal_感染缠乱线]
isVisible: if (numberOfUnitsInTeam(withTag='虚红感染区', withinRange=600)<3 or self.tags(includes='主母巢')) and ${JiaohongYanli} and not self.globalTeamTags(includes='关闭感染区高级效果')
alwaysStartHeightAtZero: true
layer: shadow
image: 红缠乱线.png
imageScale: ${2.7 * 0.5} * (0.8 + cos( ${timer_20s} * 360 - ${b}) * 0.2)
basePosition: getOffsetRelative(x=0, y=0, dirOffset=-self.timeAlive*2 -self.dir)
onlyWithZoomLevelOrMore: 0.5

@define timer_20s: ((self.timeAlive() % 20) / 20)
alpha: 0.35+cos( ${timer_20s} * 360 - ${b}) * 0.25
@define b: 0

[decal_感染缠乱线2]
@copyFromSection: decal_感染缠乱线
dirOffset: 90
@define b: 90

[decal_感染缠乱线3]
@copyFromSection: decal_感染缠乱线
dirOffset: 180
@define b: 180

[decal_感染缠乱线4]
@copyFromSection: decal_感染缠乱线
dirOffset: 270
@define b: 270

[decal_内感染缠乱线]
@copyFromSection: decal_感染缠乱线
isVisible: if (numberOfUnitsInTeam(withTag='虚红感染区', withinRange=600)<2 or self.tags(includes='主母巢')) and ${JiaohongYanli} and not self.globalTeamTags(includes='关闭感染区高级效果')
imageScale: ${2.7 * 0.5} * (0.4 + cos( ${timer_20s} * 360 - ${b}) * 0.2)
alpha: 0.45+sin( ${timer_20s} * 360 - ${b}) * 0.25
dirOffset: 45
@define b: 45

[decal_内感染缠乱线2]
@copyFromSection: decal_内感染缠乱线
dirOffset: 135
@define b: 135

[decal_内感染缠乱线3]
@copyFromSection: decal_内感染缠乱线
dirOffset: 225
@define b: 225

[decal_内感染缠乱线4]
@copyFromSection: decal_内感染缠乱线
dirOffset: 315
@define b: 315

[action_感染区高级效果]
isVisible: if ${JiaohongYanli} and not self.globalTeamTags(includes='关闭感染区高级效果')
id: 感染区高级效果开
text: {感染区高级效果:开}
description: -关闭后可立即隐藏自身感染区的特殊贴花特效 \n -可用于缓解卡顿
buildSpeed: 0s
pos: 20
iconExtraImage: icon_on.png
iconExtraColor: #64FFFFFF
displayType: infoOnly
highPriorityQueue: true
allowMultipleInQueue: false
addGlobalTeamTags: 关闭感染区高级效果

[action_感染区高级效果2]
@copyFromSection: action_感染区高级效果
isVisible: if ${JiaohongYanli} and self.globalTeamTags(includes='关闭感染区高级效果')
id: 感染区高级效果关
iconExtraImage: icon_off.png
addGlobalTeamTags: IGNORE
removeGlobalTeamTags: 关闭感染区高级效果



[action_AI建造虫征集]
isVisible: if self.globalTeamTags(includes='AI系统') and self.globalTeamTags(includes='战隙{I}') and not self.globalTeamTags(includes='中刻{I}') and not self.globalTeamTags(includes='AI爆发')
unitShownInUI: bugSpore
textAddUnitName: bugSpore
descriptionAddFromUnit: bugSpore
descriptionAddUnitStats: bugSpore
produceUnits: bugSpore
buildSpeed: 0.005
price: 100
pos: 1
isLocked: if self.globalTeamTags(includes='战隙{I}') and self.globalTeamTags(includes='AI系统')
isLockedMessage: AI:进入前期阶段,低级单位已停止建造

[action_AI两栖蝇征集]
isVisible: if self.globalTeamTags(includes='AI系统') and not numberOfUnitsInTeam(withTag='两栖蝇', greaterThan=2, withinRange=1000)
unitShownInUI: 两栖蝇
textAddUnitName: 两栖蝇
descriptionAddFromUnit: 两栖蝇
descriptionAddUnitStats: 两栖蝇
produceUnits: 两栖蝇
buildSpeed: 0.005
price: 1000
pos: 2.5

[action_AI收成者征集]
isVisible: if (${CompleteCorrosion} ${CompleteCorrosionLimit}) and self.globalTeamTags(includes='AI系统') and numberOfUnitsInTeam(withTag='修复点', lessThan=1, withinRange=1000)
unitShownInUI: 收成者
textAddUnitName: 收成者
descriptionAddFromUnit: 收成者
descriptionAddUnitStats: 收成者
produceUnits: 收成者
buildSpeed: 21.7s
price: 6000
pos: 5

[hiddenAction_AIbuildbugSpore]
autoTrigger:if self.globalTeamTags(includes='AI系统') and self.hasResources(100) and self.globalTeamTags(includes='战隙{I}') and not self.globalTeamTags(includes='AI爆发') and not self.tags(includes='一隙之巢')
alsoQueueAction: AI建造虫征集
addResources: credits=-100
temporarilyAddTags: 一隙之巢

[hiddenAction_AIbuild两栖蝇]
autoTrigger:if self.globalTeamTags(includes='AI系统') and self.hasResources(1000) and not numberOfUnitsInTeam(withTag='两栖蝇', greaterThan=2, withinRange=1000) and self.queueSize(empty=true)
alsoQueueAction: AI两栖蝇征集
addResources: credits=-1000

[hiddenAction_AIbuildRecipient]
autoTrigger:if self.globalTeamTags(includes='AI系统') and self.hasResources(6000) and numberOfUnitsInTeam(withTag='修复点', lessThan=1, withinRange=1000) and (${CompleteCorrosion} ${CompleteCorrosionLimit}) and self.queueSize(empty=true)
alsoQueueAction: AI收成者征集
addResources: credits=-6000

[hiddenAction_AI爆发重型征集]
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.globalTeamTags(includes='AI爆发') and self.globalTeamTags(includes='中刻{I}') and self.hasResources(12000) and numberOfUnitsInTeam(withTag='修复点', lessThan=2, withinRange=1000) and (${CompleteCorrosion} ${CompleteCorrosionLimit}) and self.queueSize(empty=true)
alsoQueueAction: AI收成者征集, AI收成者征集
addResources: credits=-12000

[hiddenAction_AI屯兵重型单征集]
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.globalTeamTags(includes='AI屯兵') and self.globalTeamTags(includes='中刻{I}') and self.hasResources(6500) and numberOfUnitsInTeam(withTag='修复点', lessThan=2, withinRange=1000) and (${CompleteCorrosion} ${CompleteCorrosionLimit}) and self.queueSize(empty=true)
alsoQueueAction: AI收成者征集
addResources: credits=-6000
