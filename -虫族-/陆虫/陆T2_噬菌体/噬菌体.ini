
[core]
name: 噬菌体
displayText: 噬菌体
displayDescription: -攻击地面单位 \n -可原地部署以提升射程并快速再生 \n -攻击可引爆目标100毒素造成额外200伤害
class: CustomUnitMetadata
price: 5500
maxHp: 1800
mass: 6000

techLevel: 2
buildSpeed: 0.0006
#availableInDemo: true

radius: 22
softCollisionOnAll: 5

isBio: true
isBug: true

tags: units, 虫族, 中型虫

selfRegenRate:0.1

transportSlotsNeeded: 2

[action_deploy]
isVisible: true
id: ${section.text}
tags=${section.text}
text: Deploy
description: -部署\n-在池虫上子弹伤害减半
convertTo: 噬菌体[部署]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
convertTo_keepCurrentFields: maxHp, maxShield
displayType: action
price:  0
buildSpeed: 0.01
alwaysSinglePress: true
whenBuilding_cannotMove: true

[action_Upgrade]
isVisible: if self.resource.腐蚀>=0
convertTo: 光辉噬菌体
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
price: 腐蚀=600
text: 腐蚀 - 光辉
displayType:upgrade
buildSpeed: 23.8s
pos: -1
description: -子弹将在一定延迟后快速攻击敌人 \n -部署时小范围治愈并回复光辉护盾 \n -移速与再生上升 \n -攻速大大提升 \n -照亮四周迷雾 \n -净化腐蚀...
descriptionAddUnitStats: ${section.convertTo}
iconExtraImage:SHARED:icon_upgrade_top.png
iconExtraColor:#AAFFFFFF
tags=腐蚀
setUnitMemory: 属性[24]=0

[action_纯净Upgrade]
@copyFromSection: action_Upgrade
isVisible: if self.resource.腐蚀<0
price: 2400
streamingCost: hp=600
text: 纯净 - 光辉
buildSpeed: 11.9s
addResources: 腐蚀=-600
description: -子弹将在一定延迟后快速攻击敌人 \n -部署时小范围治愈并回复光辉护盾 \n -移速与再生上升 \n -攻速大大提升 \n -照亮四周迷雾 \n -净化腐蚀-600
iconExtraImage: 纯净升级.png
iconExtraColor: #AAFFFFFF
spawnEffects: CUSTOM:hitLightFlash, 光粒*10
tags=纯净
setUnitMemory: 属性[24]=0

[hiddenAction_腐蚀中]
autoTrigger: if self.queueSize(withActionTag="腐蚀")>0 and not self.tags(includes='腐蚀中')
setUnitMemory: 属性[24]=-${movement.moveSpeed}*0.6
alsoTriggerAction: 属性变化
temporarilyAddTags: 腐蚀中

[hiddenAction_腐蚀停止]
autoTrigger: if self.queueSize(withActionTag="腐蚀")<1 and self.tags(includes='腐蚀中')
setUnitMemory: 属性[24]=0
alsoTriggerAction: 属性变化
temporarilyRemoveTags: 腐蚀中

[hiddenAction_自动腐蚀]
autoTrigger: if (self.hasUnitInTeam(withTag="腐蚀-光辉噬菌体") and self.hasUnitInTeam(withTag="腐蚀之意")) and self.hasResources(${action_Upgrade.price}) and self.queueSize(empty=true) and not self.isAttacking
alsoQueueAction: Upgrade
addResourcesWithLogic: ${action_Upgrade.price}*-1


[hiddenAction_自动部署]
autoTrigger: if self.hasParent and self.queueSize(withActionTag='Deploy')<1
alsoQueueAction: deploy


[hiddenAction_净化]
autoTrigger: if self.queueSize(withActionTag="纯净")>0
spawnEffects: CUSTOM:hitLightFlash, 光粒*3

[effect_hitLightFlash]
priority:high

image: SHARED:light_50.png
life: 100
fadeOut: true
attachedToUnit: true
color: #FFFFFF

scaleFrom: 1.4
scaleTo: 1.4
alpha: 0.4
drawUnderUnits:false

[effect_光粒]
priority: verylow
attachedToUnit: false
life: 100
image: SHARED:spark.png
color: #FFFFFF
scaleFrom: 2
scaleTo: 1
hSpeed: 1
hSpeedRandom: 0.2
xOffsetRelativeRandom: 18
yOffsetRelativeRandom: 18
delayedStartTimerRandom: 30
drawUnderUnits: false

[graphics]
total_frames: 1

image:        壳.png
image_wreak:  NONE
image_turret: 虫炮.png
#scaleImagesTo: 20
#scaleTurretImagesTo: 9

teamColorsOnTurret: true

#AUTO
image_shadow: AUTO
shadowOffsetX:1
shadowOffsetY:1

animation_idle_start: 0
animation_idle_end: 0
animation_idle_speed: 80
animation_idle_scale_start: 1
animation_idle_scale_end: 1.03
animation_idle_pingPong: true

movementEffect: CUSTOM:trace
movementEffectRate: 10

[effect_trace]
priority: verylow
attachedToUnit: false
life: 200
image: SHARED:spark.png
color: #176917
scaleFrom: 2
scaleTo: 2
yOffsetRelative: -10
xOffsetRelativeRandom: 18
drawUnderUnits: true

[attack]
canAttack: true
canAttackFlyingUnits: false
canAttackLandUnits:   true
canAttackUnderwaterUnits: false

turretSize: 32
turretTurnSpeed: 4

maxAttackRange: 190
shootDelay: 35

[turret_1]
x: 0
y: 0

projectile: 1

shoot_sound:plasma_fire2
shoot_sound_vol:0.3
shoot_flame:CUSTOM:尾气雾*4
shoot_light:#FF3BFF00

recoilOffset: -3
recoilOutTime: 6
recoilReturnTime: 18

[turret_部署范围]
invisible: true
x: 0
y: 0
canShoot: false
limitingRange: 320
showRangeUIGuide: true

[projectile_1]
tags= T-projectile
directDamage:55
largeHitEffect:true
life:80
speed:5
targetSpeed:8
#frame: 0
frame:6

lightColor:#00ff00
lightSize:0.6

trailEffect: CUSTOM:尾气雾

spawnProjectilesOnExplode: 毒爆

[projectile_毒爆]
tags= T-projectile
directDamage: 0
life: 100
speed: 999
invisible: true
targetGround: true
explodeEffect: NONE
spawnUnit: 额外伤害(addResources=energy:1)

[effect_尾气雾]
stripIndex: effects
frameIndex: 0
priority: low

life: 20
fadeOut: true
attachedToUnit: true
color: #FF3BFF00
scaleFrom: 0.7
scaleTo: 0.1
alpha: 0.6
drawUnderUnits: false
ySpeedRelative: -2
xSpeedRelativeRandom: 0.5
atmospheric: true

[arm_1]
x: 0
y: 18
image_end: 虫头.png
drawOverBody: false

[arm_2]
x: 0
y: 0
image_end: 粘液.png
drawUnderAllUnits: true

[movement]
movementType: OVER_CLIFF

moveSpeed: 0.5
moveAccelerationSpeed: 0.07
moveDecelerationSpeed: 0.17

maxTurnSpeed: 1.0
turnAcceleration: 0.5

#moveSlidingMode :false
#moveIgnoringBody:false

moveSlidingMode :true
moveIgnoringBody:true
moveSlidingDir:  181