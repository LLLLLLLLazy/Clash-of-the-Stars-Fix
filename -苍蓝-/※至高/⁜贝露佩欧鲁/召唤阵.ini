[core]
name:召唤阵
displayText:贝露佩欧露
class: CustomUnitMetadata
price:0
disableDeathOnZeroHp:true
maxHp: 10000
armour:0
mass:1000000
selfRegenRate: 10000
techLevel:1
buildSpeed:1
radius: -10
displayRadius: -10
isBuilding:false
numBitsOnDeath:8
isBio:false
energyMax:28
isUnselectable:true
tags:scorch, 贝露召唤阵, 贝露佩欧鲁, 虚无
disableAllUnitCollisions:true
canOnlyBeAttackedByUnitsWithTags:alk
canNotBeDamaged: true
explodeOnDeath:true
isUnrepairableUnit:true
showInEditor: false
showOnMinimap:false
@memory alpha:float
@memory dir:float
@memory 透明度:float
@memory 当前血量:float
autoTriggerCooldownTime: 0.1s
autoTriggerCooldownTime_allowDangerousHighCPU:true

[graphics]
drawLayer:bottom
total_frames:1
imageScale:0.6
image:SHARED:blank.png
image_wreak:NONE
image_turret:SHARED:blank.png
image_shadow:NONE
disableLowHpFire:true
disableLowHpSmoke:true
showHealthBar:false
showEnergyBar:false
icon_zoomed_out_neverShow:true
icon_build:贝露佩欧露图标.png
showQueueBar:false

[attack]
canAttack:false
canAttackFlyingUnits: false
canAttackLandUnits:true
canAttackUnderwaterUnits:false
turretSize: 0
aimOffsetSpread: -0.01
turretTurnSpeed: 100
shootDelay:0.1
maxAttackRange:30

[movement]
movementType:AIR
moveSpeed: 0
moveAccelerationSpeed: 0.00001
moveDecelerationSpeed: 0.00001
maxTurnSpeed: 0
turnAcceleration: 0.00001
moveSlidingMode :false
moveIgnoringBody:false
targetHeight:0
startingHeightOffset:0

#[decal_召唤阵]
#order: 0
#layer: beforeBody
#image:召唤阵.png
#hOffset:0
#basePosition:getOffsetRelative(dirOffset=self.readUnitMemory('dir',type='float'))
#imageScale:0.6
#alpha:self.readUnitMemory('alpha',type='float')

#[hiddenAction_ad]
#autoTrigger:if self.readUnitMemory('alpha',type='float')<1.0
#setUnitMemory:alpha=memory.alpha+0.1

#[hiddenAction_ad2]
#autoTrigger:true
#setUnitMemory:dir=memory.dir+0.1
#alsoTriggerAction:ad2

[arm_1]
x: 0
y: 0
hidden: if not self.tags(includes="start")
drawDirOffset: -0.16
image_end: 召唤阵.png
spinRate: 0.16

[animation_召唤阵]
arm1_0s:{alpha:0}
arm1_1s:{alpha:1}
arm1_2s:{alpha:0.95}
arm1_3s:{alpha:1}
arm1_4s:{alpha:0.95}
arm1_5s:{alpha:1}
arm1_6s:{alpha:0.95}
arm1_7s:{alpha:1}
arm1_8s:{alpha:1}

[hiddenAction_start]
autoTriggerOnEvent:completeAndActive
autoTrigger: if not self.tags(includes="start")
requireConditional: if not self.tags(includes="start")
alsoQueueAction:set0
playSoundAtUnit:召唤.ogg:0.8
playAnimation:召唤阵
temporarilyAddTags: start

[hiddenAction_set0]
buildSpeed:2s
addResources:setFlag=0
alsoQueueAction:set1

[hiddenAction_生雾]
autoTrigger:if self.hasFlag(id=0)
spawnEffects:CUSTOM:fog4

[hiddenAction_生雾2]
autoTrigger:if self.hasFlag(id=1)
spawnEffects:CUSTOM:fog4+

[hiddenAction_set1]
buildSpeed:2s
addResources:setFlag=1,unsetFlag=0
spawnEffects:CUSTOM:what,CUSTOM:dust*5
playSoundAtUnit:地震.ogg:0.7
fireTurretXAtGround:1
alsoQueueAction:set2

[hiddenAction_set2]
buildSpeed:1s
addResources:setFlag=2
spawnEffects:CUSTOM:雨云*10
playSoundAtUnit:召云.ogg:0.7
alsoQueueAction:com

[hiddenAction_com]
buildSpeed:3s
convertTo: 贝露佩欧鲁
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
spawnUnits: 气流对冲*5(offsetRandomDir=180)
spawnEffects:CUSTOM:what
addResources: setFlag=0, setFlag=5, unsetFlag=1-2
setUnitMemory:透明度=1.0,当前血量=${core.maxHp}

[hiddenAction_唤雷]
autoTrigger:if self.hasFlag(id=2)
spawnEffects:CUSTOM:spawnEffects
fireTurretXAtGround:1
fireTurretXAtGround_withProjectile:落雷

[turret_1]
x:0
y:0
image:SHARED:blank.png
turnSpeed:0
projectile:颤动
canShoot:false
canAttackFlyingUnits:true
canAttackLandUnits:   true
canAttackUnderwaterUnits: false

[projectile_颤动]
areaDamage: 125
areaRadius: 330
life:0
speed:0
drawSize:0
image:SHARED:blank.png
buildingDamageMultiplier:2.0
areaExpandTime:5
areaDamageNoFalloff:true
deflectionPower: -1
targetGround:true
explodeEffect:NONE
explodeEffectOnShield:NONE
explodeOnEndOfLife:true
pushVelocity:0.5
pushForce:0.5

[projectile_落雷]
areaDamage:100
areaRadius:330
life:0
speed: 0
drawSize:0
image:SHARED:blank.png
explodeEffect:NONE
explodeOnEndOfLife:true
areaHitAirAndLandAtSameTime:true
shieldDamageMultiplier:1.5
shieldDefectionMultiplier:-1

[effect_fog4]
priority: high
life:160
fadeInTime: 20
image:fog4.png
scaleFrom:1.4
scaleTo: 2.0
alpha: 0.3
hSpeed: 0.5
fadeOut: true
hSpeedRandom: 0.8
ySpeedRelativeRandom: 0.4
xSpeedRelativeRandom: 0.4
xOffsetRelativeRandom:120
yOffsetRelativeRandom:120
dirOffsetRandom: 180
attachedToUnit: false
drawUnderUnits: false
spawnChance:0.7

[effect_fog4+]
priority: high
life:160
fadeInTime: 20
image:fog4+.png
scaleFrom:1.4
scaleTo: 2.0
alpha: 0.3
hSpeed: 0.5
fadeOut: true
hSpeedRandom: 0.8
ySpeedRelativeRandom: 0.4
xSpeedRelativeRandom: 0.4
xOffsetRelativeRandom:120
yOffsetRelativeRandom:120
dirOffsetRandom: 180
attachedToUnit: false
drawUnderUnits: false
spawnChance:0.7

[effect_what]
drawType: displacement
image:what.png
life:20
fadeOut:true
attachedToUnit: true
scaleFrom:100
scaleTo:100
alpha:0.05
drawUnderUnits:false
alwayStartDirAtZero: true
total_frames: 2
animateFrameStart: 0
animateFrameEnd:1
animateFrameSpeed: 0.4
animateFrameLooping:true

[effect_dust]
priority: high
life:90
lifeRandom: 25
image:dust.png
scaleFrom: 2.0
scaleTo: 4.8
alpha: 0.8
hSpeed: 0.5
hSpeedRandom: 0.8
ySpeedRelativeRandom: 0.4
xSpeedRelativeRandom: 0.4
xOffsetRelativeRandom:120
yOffsetRelativeRandom:120
imageShadow: SHADOW:spray.png
dirOffsetRandom: 180
attachedToUnit: false
drawUnderUnits: false
trailEffect:CUSTOM:dust2
trailEffectRate:2.0

[effect_dust2]
priority: high
life: 90
lifeRandom: 25
image:dust.png
scaleFrom: 2.0
scaleTo: 4.8
physics: true
physicsGravity: 0.4
alpha: 0.8
dirOffsetRandom: 180
attachedToUnit: false
drawUnderUnits:false
spawnChance:0.3

[effect_雨云]
attachedToUnit:false
life:560
alpha:1.0
image:大雨云.png
ySpeedRelativeRandom:0.17
fadeOut: true
fadeInTime:30
scaleFrom:2.5
scaleTo:2.5
priority:veryhigh
showInFog:true
hOffset:500
hSpeedRandom:0.15
imageShadow:SHADOW:大雨云.png
xOffsetRelativeRandom:240
yOffsetRelativeRandom:240
alwayStartDirAtZero:true
liveAfterAttachedDies:true

[effect_spawnEffects]
life: 0
scaleFrom: 0
scaleTo: 0
alpha:0
alwayStartDirAtZero:true
xOffsetRelativeRandom:180
yOffsetRelativeRandom:180
image:SHARED:blank.png
spawnChance:0.4
alsoEmitEffectsOnDeath:CUSTOM:scorch,CUSTOM:落雷,CUSTOM:白光

[effect_落雷]
priority:veryhigh
life: 120
alwayStartDirAtZero:false
fadeInTime: 0
fadeOut:true
attachedToUnit: true
drawUnderUnits:false
image:雷暴\落雷.png
scaleFrom:2.8
scaleTo: 2.8
hOffset:250
total_frames: 7
animateFrameStart: 0
animateFrameEnd: 6
animateFramePingPong: false
animateFrameSpeed: 0.55
alpha:0.7
alsoPlaySound:雷击.ogg

[effect_白光]
priority:veryhigh
life: 10
alwayStartDirAtZero:true
fadeInTime: 0
fadeOut:true
attachedToUnit:false
drawUnderUnits:false
image:SHARED:light_50.png
scaleFrom:99
scaleTo:99
alpha:0.15

[effect_scorch]
priority:veryhigh
life:1000
alwayStartDirAtZero:true
fadeInTime: 0
fadeOut:true
attachedToUnit:false
drawUnderUnits:true
image:雷暴\scorch.png
scaleFrom:0.8
scaleTo:0.8
alpha:0.8
hOffset:-2
dirOffsetRandom:180
createWhenOverLiquid: false