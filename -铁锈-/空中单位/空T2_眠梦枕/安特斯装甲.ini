
[core]
name: 安特斯装甲
displayText: 眠梦枕
displayDescription: -可搭载于一个地面单位并飞行 \n -闲置时降落在陆地上 \n -可短暂开启无敌屏障\n\n-2024.1.30 冠军限定-

class: CustomUnitMetadata
price: 2500
maxHp: 600
mass: 16000

tags: units, 眠梦枕, 附件单位

techLevel: 2

buildSpeed: 0.0006
availableInDemo: true

radius: 15
displayRadius: 17

softCollisionOnAll: 3

transportSlotsNeeded: 2
maxTransportingUnits: 1
transportUnitsBlockOtherTransports: false
transportUnitsRequireMovementType: LAND, HOVER, OVER_CLIFF, OVER_CLIFF_WATER, AIR
transportUnitsKillOnDeath: false
transportUnitsCanUnloadUnits: if self.queueSize(withActionTag='融合升级')<1

energyMax: 9
energyRegen: 0.005
energyStartingPercentage: 0.4

autoTriggerCooldownTime: 0.1s

@memory 指定坐标:unit

[action_范围运输]
@copyFromSection: template_范围运输

[hiddenAction_运输路径]
@copyFromSection: template_运输路径

[decal_运输范围]
@copyFromSection: template_运输范围

[action_冠军签名]
iconImage: 佳木-签名.png
isVisible: if self.timeAlive < 10
isActive: false
id: 冠军签名
description: -冠军签名- \n (10s后隐藏)
pos: 99
displayType: infoOnlyStockpile
buildSpeed: 0s

[action_dreaming]
isLocked: if not self.energy(greaterThan=4.5)
isLockedMessage: 充能中...
isLockedAlt: if numberOfUnitsInEnemyTeam(withTag='真视之眼', greaterThan=0)
isLockedAltMessage: 无法避实入虚境之中 \n -真视之眼-
id: ${section.text}
text: [入梦]
description: -根据剩余能量进入较长的梦幻时间 \n -梦幻时间中搭载单位不能攻击 \n \n "梦幻" \n [免疫任何伤害] \n [更快的移动] \n [耐久正在治愈]
buildSpeed: 0.5s
pos: 1

convertTo: 安特斯装甲[梦幻]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}

[hiddenAction_攻击范围]
autoTrigger: if attachment.readUnitMemory("属性", type='float', index=4) != memory.属性[4]
setUnitMemory: 属性[20]=attachment.readUnitMemory("属性", type='float', index=4)
alsoTriggerAction: 属性变化

[hiddenAction_移动速度]
autoTrigger: if self.numberOfAttachedUnits(greaterThan=0) and attachment.maxMoveSpeed != memory.属性[7]
setUnitMemory: 属性[24]=attachment.readUnitMemory("属性", type='float', index=7) - ${movement.moveSpeed}
alsoTriggerAction: 属性变化

[hiddenAction_移动速度重置]
autoTrigger: if self.numberOfAttachedUnits(lessThan=1) and self.maxMoveSpeed != ${movement.moveSpeed}
setUnitMemory: 属性[24]=0
alsoTriggerAction: 属性变化


[hiddenAction_开始部署]
autoTrigger: if attachment.queueSize(withActionTag="部署")>0
alsoQueueAction: 部署
alsoTriggerOrQueueActionConditional: if self.queueSize(withActionTag="部署")<1

[hiddenAction_部署]
tags=部署
buildSpeed: 0.0055
whenBuilding_cannotMove: true
whenBuilding_rotateTo: 0
whenBuilding_rotateTo_orBackwards: true

[hiddenAction_部署状态]
autoTrigger: if self.numberOfAttachedUnits(greaterThan=0) and attachment.maxMoveSpeed == 0 and not self.hasFlag(id=2)
setUnitMemory: 属性[42]=memory.属性[42]-1
alsoTriggerAction: 属性变化
addResources: setFlag=2

[hiddenAction_部署状态结束]
autoTrigger: if (self.numberOfAttachedUnits(lessThan=1) or attachment.maxMoveSpeed != 0) and self.hasFlag(id=2)
setUnitMemory: 属性[42]=memory.属性[42]+1
alsoTriggerAction: 属性变化
addResources: unsetFlag=2

[attachment_1]
x: 0
y: 0
lockRotation: false
rotateWithParent: true
resetRotationWhenNotAttacking: true

isUnselectable: true
addTransportedUnits: true
setDrawLayerOnBottom: true
keepAliveWhenParentDies: true
prioritizeParentsMainTarget: true
canBeAttackedAndDamaged: false

showAllActionsFrom: true

[hiddenAction_亡灵虫断开]
autoTrigger: if self.numberOfAttachedUnits(withTag='亡灵虫')>0
attachments_disconnect: true
attachments_onlyOnSlots: 1

[hiddenAction_接收传送]
autoTriggerOnEvent: newMessage(withTag='传送')
teleportTo: eventData('目标', type='unit')

[graphics]

total_frames: 1
image: SHARED:blank.png
image_wreak: 眠梦枕_死亡.png
image_turret: NONE
image_shield: C.png
#scaleImagesTo: 20
#scaleTurretImagesTo: 9

#AUTO
image_shadow: AUTO
shadowOffsetX:1
shadowOffsetY:1

splastEffect: true

movementEffect: CUSTOM:projectileTrail
movementEffectRate: 4

[decal_主体]
onlyWhileAlive: true
layer: afterBody
image: 安特斯装甲.png
image_shadow: SHADOW:安特斯装甲.png
shadowOffsetX: 1
shadowOffsetY: 1
alpha: 1 * select(self.numberOfAttachedUnits(greaterThan=0), 0.9, 1)
isVisible: if not self.numberOfAttachedUnits(greaterThan=0)

[decal_固定主体]
@copyFromSection: decal_主体
isVisible: if self.numberOfAttachedUnits(greaterThan=0) and self.numberOfAttachedUnits(withTag="转向攻击")==0 or self.numberOfAttachedUnits(withTag="固定射击")>0
basePosition: attachment

[decal_炮塔主体]
@copyFromSection: decal_主体
isVisible: if self.numberOfAttachedUnits(withTag="转向攻击")>0 and self.numberOfAttachedUnits(withTag="固定射击")==0
basePositionFromTurret: 1

[effect_projectileTrail]
createWhenZoomedOut: false
priority: verylow

image: SHARED:light_50.png
life: 30
fadeOut: true
attachedToUnit: false
color: #FFFFFF
fadeInTime:2
scaleFrom: 0.7
scaleTo: 0.7
alpha: 0.4
drawUnderUnits:true
ySpeedRelative:-0.4
atmospheric: true

[attack]
canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits:   true
canAttackUnderwaterUnits: false

turretSize: 0
turretTurnSpeed: 4.1

maxAttackRange: 0
shootDelay: 50

[turret_1]
x: 0
y: 0
energyUsage: 99
canAttackLandUnits: if attachment.attacking.isAtGroundHeight
canAttackFlyingUnits: if attachment.attacking.isFlying

[projectile_1]
tags= T-projectile
directDamage: 0
invisible: true
life: 0

[turret_skill]
x: 0
y: 0
invisible: true
canShoot: false
limitingRange: 9999

[movement]
movementType: AIR
moveSpeed: 1.2
moveAccelerationSpeed: 0.07
moveDecelerationSpeed: 0.1

landOnGround: onlyIdle

targetHeight: 20
targetHeightDrift: 1

reverseSpeedPercentage: 0.6

maxTurnSpeed: 4.1
turnAcceleration: 0.1

moveSlidingMode :true
moveIgnoringBody:true


[hiddenAction_生产跟随移动工厂]
@copyFromSection: template_生产跟随移动工厂
