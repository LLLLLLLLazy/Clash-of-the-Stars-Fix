
[core]
name: 单位系统
tags: 单位系统
maxHp: 1
price: 0
mass: 99999999

disableDeathOnZeroHp: true

onNewMapSpawn: mapCenter_eachActiveTeam

#隐藏单位本身
showInEditor: false
radius: 0
fogOfWarSightRange: 0
showOnMinimap: false
ignoreInUnitCapCalculation: true
disableAllUnitCollisions: true
isUnselectable:	true
canNotBeDirectlyAttacked: true
isUnrepairableUnit:	true

#禁止死亡痕迹
numBitsOnDeath:	0
explodeOnDeath:	false
hideScorchMark: true

autoTriggerCooldownTime: 10

@memory 数据更新单位:unit[]
@memory 狂猎色幕:unit

#——测试——

[action_测试信息显示]
isVisible: true
displayType: infoOnly
id: 测试信息显示
buildSpeed: 0s
pos: 0
text: 
highPriorityQueue: true
alwaysSinglePress: true
isAlsoViewableByAllies: true
isAlsoViewableByEnemies: true

#——胜利——
[hiddenAction_群星的丰碑]
autoTrigger: if numberOfUnitsInEnemyTeam(withTag='units', incompleteBuildings=true, factoryQueue=true)+numberOfUnitsInEnemyTeam(withTag='单位系统', incompleteBuildings=true, factoryQueue=true)==0 and numberOfUnitsInTeam(withTag='units', incompleteBuildings=true, factoryQueue=true)>0 and not self.globalTeamTags(includes="群星的丰碑")
addGlobalTeamTags: 群星的丰碑
spawnUnits: 群星的丰碑(spawnSource=globalSearchForFirstUnit(withTag='units', relation='own'))

#——负资金——
[hiddenAction_负资金提示]
autoTrigger: if self.resource.credits <0 and not self.globalTeamTags(includes='负资金提示')
addGlobalTeamTags: 负资金提示
showMessageToPlayer: [警告:能源不足以支撑单位运行]

[hiddenAction_负资金扣血]
autoTrigger: if self.resource.credits <0
takeResources: hp=5
takeResources_excludeUnitsWithoutAllResources: false
takeResources_includeUnitsWithinRange: 999999
takeResources_includeUnitsWithinRange_team: own
takeResources_excludeUnitsWithoutTags: units
takeResources_maxUnits: 999999

[hiddenAction_资金恢复正常]
autoTrigger: if self.hasResources(credits=1000) and self.globalTeamTags(includes='负资金提示')
removeGlobalTeamTags: 负资金提示

#——顶点——

[hiddenAction_资源终刻时间]
autoTrigger: if self.resource.资源对比时间>=0
addResources: 资源对比时间=-10

[hiddenAction_资源终刻对比值]
autoTrigger: if (numberOfUnitsInAggressiveTeam(withTag="恐虐大恶魔", greaterThan=0) or numberOfUnitsInAllTeams(withTag="真视之眼", greaterThan=0)) and self.resource.资源对比时间<=0
setResourcesWithLogic: 资源终刻=self.resource.credits, 资源比值=self.resource.资源终刻 - self.resource.资源初刻
alsoTriggerAction: 资源经济增长, 资源经济顶点, 资源经济淡顶点, 资源初刻记录, 顶点之位标签
addResources: 顶点对比时间=40, 资源对比时间=40

[hiddenAction_资源初刻记录]
setResourcesWithLogic: 资源初刻=self.resource.credits

[hiddenAction_资源经济增长]
requireConditional: if self.resource.资源终刻 >= self.resource.资源初刻
setResourcesWithLogic: 资源经济=self.resource.资源比值


[hiddenAction_资源经济顶点]
requireConditional: if numberOfUnitsInAggressiveTeam(withTag="恐虐大恶魔", greaterThan=0) and self.globalTeamTags(includes="顶点")
setResourcesWithLogic: 顶点=self.resource.资源经济, 淡顶点=0

[hiddenAction_资源经济淡顶点]
requireConditional: if numberOfUnitsInAggressiveTeam(withTag="恐虐大恶魔", greaterThan=0) and not self.globalTeamTags(includes="顶点")
setResourcesWithLogic: 淡顶点=self.resource.资源经济, 顶点=0

[hiddenAction_顶点之位标签]
requireConditional: if self.resource.顶点对比时间 >= 120 and numberOfUnitsInAggressiveTeam(withTag="恐虐大恶魔", greaterThan=0)
setResourcesWithLogic: 顶点对比时间=0
temporarilyAddTags: 顶点之位

[hiddenAction_最高顶点对比]
autoTrigger: if self.tags(includes="顶点之位") and self.resource.资源经济 > nearestUnit(withTag='顶点之位', relation='any').self.resource.资源经济 and self.resource.顶点较低<1
takeResources: 顶点较低=-1
takeResources_includeReference: nearestUnit(withTag='顶点之位', relation='any')
takeResources_discardCollected: true

[hiddenAction_最高顶点之位]
autoTrigger: if self.tags(includes="顶点之位") and numberOfUnitsInEnemyTeam(withTag="顶点之位", lessThan=1) and self.numberOfUnitsInAllyNotOwnTeam(withTag="顶点之位", lessThan=1) and numberOfUnitsInAggressiveTeam(withTag="恐虐大恶魔", greaterThan=0)
addGlobalTeamTags: 顶点

[hiddenAction_顶点低于对方]
autoTrigger: if self.resource.顶点较低>0
setResourcesWithLogic: 顶点较低=0
temporarilyRemoveTags: 顶点之位
removeGlobalTeamTags: 顶点

[hiddenAction_顶点系统停止]
autoTrigger: if numberOfUnitsInAggressiveTeam(withTag="恐虐大恶魔", lessThan=1) and numberOfUnitsInEnemyTeam(withTag="真视之眼", lessThan=1) and self.numberOfUnitsInAllyNotOwnTeam(withTag="真视之眼", lessThan=1) and self.resource.顶点>0
setResourcesWithLogic: 顶点=0, 淡顶点=0
removeGlobalTeamTags: 顶点

#——阵营投票者——
[hiddenAction_禁虫投票者]
autoTrigger: if numberOfUnitsInTeam(withTag="禁虫投票", greaterThan=0)
temporarilyAddTags: 禁虫投票者

#——技能CD——

[hiddenAction_帝国技能CD]
autoTrigger: if self.resource.帝国CD>0
addResources: 帝国CD=-0.16666

[hiddenAction_帝国CD更新]
autoTrigger: if self.resource.帝国CD<=599.59 and self.globalTeamTags(includes='帝国CD')
removeGlobalTeamTags: 帝国CD

[hiddenAction_铁锈技能CD]
autoTrigger: if self.resource.铁锈CD>0
addResources: 铁锈CD=-0.16666

[hiddenAction_虫族技能CD]
autoTrigger: if self.resource.虫族CD>0
addResources: 虫族CD=-0.16666

#——帝国支配卫星——

[hiddenAction_其他支配卫星]
autoTrigger: if self.resource.其他支配卫星>0
addResources: 支配值=-10, 其他支配卫星=-1
alsoTriggerAction: 帝国卫星升空

[hiddenAction_帝国卫星升空]
requireConditional: if self.globalTeamTags(includes='帝国')
showMessageToPlayer: 检测到卫星升空

#———虫族———
[hiddenAction_主母巢选定]
autoTrigger: if self.globalTeamTags(includes='虫族') and numberOfUnitsInTeam(withTag="主母巢") < 1 and numberOfUnitsInTeam(withTag="母巢") > 0
sendMessageTo: globalSearchForFirstUnit(withTag='母巢', relation='own')
sendMessageWithTags: 主母巢

#——狂猎时刻——
[hiddenAction_狂猎时刻激活]
autoTriggerOnEvent: newMessage(withTag='狂猎时刻激活')
requireConditional: if self.globalTeamTags(includes='狂猎')
addResourcesWithLogic: 预狂猎时刻=eventData(name='时间', type='number'), 预狂猎色幕=eventData(name='色幕', type='number')
setResourcesWithLogic: 狂猎时刻即将开始=15
temporarilyAddTags: 狂猎时刻即将开始
setUnitMemory: 狂猎色幕=eventSource.getAsMarker
showMessageToAllPlayers: 被腐蚀的生物们蓄势待发……

[hiddenAction_狂猎时刻开始计时]
autoTrigger: if self.resource.狂猎时刻即将开始>0
addResources: 狂猎时刻即将开始=-${1/6}

[hiddenAction_狂猎时刻开始]
autoTrigger: if self.tags(includes='狂猎时刻即将开始') and self.resource.狂猎时刻即将开始<=0
setResourcesWithLogic: 狂猎时刻即将开始=0
temporarilyRemoveTags: 狂猎时刻即将开始
alsoTriggerAction: 狂猎时刻

[hiddenAction_狂猎时刻]
autoTriggerOnEvent: newMessage(withTag='狂猎时刻')
requireConditional: if self.globalTeamTags(includes='狂猎')
addResourcesWithLogic: 狂猎时刻=eventData(name='时间', type='number')+self.resource.预狂猎时刻, 预狂猎时刻=-self.resource.预狂猎时刻
addGlobalTeamTags: 狂猎时刻
showMessageToAllPlayers: -[狂猎时刻]-

fireTurretXAtGround: 1
fireTurretXAtGround_withOffset: 0, 0
fireTurretXAtGround_withProjectile: 狂猎微噬

takeResources: unsetFlag=3
takeResources_includeUnitsWithinRange: 99999
takeResources_includeUnitsWithinRange_team: own
takeResources_excludeUnitsWithoutTags: 星核
takeResources_discardCollected: true
takeResources_maxUnits: 999

alsoTriggerAction: 狂猎色幕, 狂猎色幕2

[hiddenAction_狂猎色幕]
requireConditional: if self.globalTeamTags(includes='狂猎') and eventData(name='色幕', type='number')+self.resource.预狂猎色幕==1
@define colorScreen: addResources=setFlag:3, alwayStartDirAtZero=true, spawnSource=memory.狂猎色幕
spawnUnits: 色幕(${colorScreen}), 色幕(${colorScreen}, offsetX=700), 色幕(${colorScreen}, offsetX=1400), 色幕(${colorScreen}, offsetX=2100), 色幕(${colorScreen}, offsetX=2800), 色幕(${colorScreen}, offsetX=-700), 色幕(${colorScreen}, offsetX=-1400), 色幕(${colorScreen}, offsetX=-2100), 色幕(${colorScreen}, offsetX=-2800)
setResourcesWithLogic: 预狂猎色幕=0

[hiddenAction_狂猎色幕2]
@copyFromSection: hiddenAction_狂猎色幕
requireConditional: if self.globalTeamTags(includes='狂猎') and eventData(name='色幕', type='number')+self.resource.预狂猎色幕>=2
@define colorScreen: addResources=setFlag:6, alwayStartDirAtZero=true, spawnSource=memory.狂猎色幕


[hiddenAction_狂猎时刻结束]
autoTrigger: if self.resource.狂猎时刻<=0 and self.globalTeamTags(includes='狂猎时刻')
removeGlobalTeamTags: 狂猎时刻
setResourcesWithLogic: 狂猎时刻=0

[hiddenAction_狂猎时刻计时-]
autoTrigger: if self.resource.狂猎时刻>0
addResources: 狂猎时刻=-0.1666667

@copyFromSection: template_资源提取
takeResources: 狂猎加速=-1
takeResources_excludeUnitsWithTheseResources: 狂猎加速=2

[projectile_狂猎微噬]
areaDamage: 0
areaRadius: 9999
life: 0
speed: 0
drawSize: 0
deflectionPower: -1
explodeOnEndOfLife: true
mutatorX_ifUnitWithTags: 资源池
mutatorX_areaDamageMultiplier: 1
mutatorX_addResourcesAreaHit: setFlag=5

mutator1_ifUnitWithoutTags: 资源池
mutator1_areaDamageMultiplier: -0.0001

friendlyFire: only-ignoreEnemy
explodeEffect: NONE

#——真视之眼——

[hiddenAction_科技本质]
autoTrigger: if (numberOfUnitsInTeam(withTag="真视之眼", greaterThan=0) or numberOfUnitsInAllyTeam(withTag="真视之眼", greaterThan=0)) and not self.globalTeamTags(includes='科技本质')
addGlobalTeamTags: 科技本质, 腐蚀之物, 基因工程, 未来科技, 资源研发, 魔力循环

[hiddenAction_队伍经济1]
autoTrigger: if numberOfUnitsInTeam(withTag="真视之眼", greaterThan=0) or numberOfUnitsInAllyTeam(withTag="真视之眼", greaterThan=0)
setResourcesWithLogic: 1＄=nearestUnit(withTag="队伍1").resource.credits
alsoTriggerAction: 队伍经济1+, 队伍经济2, 队伍经济2+, 队伍经济3, 队伍经济3+, 队伍经济4, 队伍经济4+, 队伍经济5, 队伍经济5+, 队伍经济6, 队伍经济6+, 队伍经济7, 队伍经济7+, 队伍经济8, 队伍经济8+, 队伍经济9, 队伍经济9+, 队伍经济10, 队伍经济10+
temporarilyAddTags: 队伍经济显示

[hiddenAction_队伍经济1+]
setResourcesWithLogic: 1＄+=nearestUnit(withTag="队伍1").resource.资源经济

[hiddenAction_队伍经济2]
setResourcesWithLogic: 2＄=nearestUnit(withTag="队伍2").resource.credits

[hiddenAction_队伍经济2+]
setResourcesWithLogic: 2＄+=nearestUnit(withTag="队伍2").resource.资源经济

[hiddenAction_队伍经济3]
setResourcesWithLogic: 3＄=nearestUnit(withTag="队伍3").resource.credits

[hiddenAction_队伍经济3+]
setResourcesWithLogic: 3＄+=nearestUnit(withTag="队伍3").resource.资源经济

[hiddenAction_队伍经济4]
setResourcesWithLogic: 4＄=nearestUnit(withTag="队伍4").resource.credits

[hiddenAction_队伍经济4+]
setResourcesWithLogic: 4＄+=nearestUnit(withTag="队伍4").resource.资源经济

[hiddenAction_队伍经济5]
setResourcesWithLogic: 5＄=nearestUnit(withTag="队伍5").resource.credits

[hiddenAction_队伍经济5+]
setResourcesWithLogic: 5＄+=nearestUnit(withTag="队伍5").resource.资源经济

[hiddenAction_队伍经济6]
setResourcesWithLogic: 6＄=nearestUnit(withTag="队伍6").resource.credits

[hiddenAction_队伍经济6+]
setResourcesWithLogic: 6＄+=nearestUnit(withTag="队伍6").resource.资源经济

[hiddenAction_队伍经济7]
setResourcesWithLogic: 7＄=nearestUnit(withTag="队伍7").resource.credits

[hiddenAction_队伍经济7+]
setResourcesWithLogic: 7＄+=nearestUnit(withTag="队伍7").resource.资源经济

[hiddenAction_队伍经济8]
setResourcesWithLogic: 8＄=nearestUnit(withTag="队伍8").resource.credits

[hiddenAction_队伍经济8+]
setResourcesWithLogic: 8＄+=nearestUnit(withTag="队伍8").resource.资源经济

[hiddenAction_队伍经济9]
setResourcesWithLogic: 9＄=nearestUnit(withTag="队伍9").resource.credits

[hiddenAction_队伍经济9+]
setResourcesWithLogic: 9＄+=nearestUnit(withTag="队伍9").resource.资源经济

[hiddenAction_队伍经济10]
setResourcesWithLogic: 10＄=nearestUnit(withTag="队伍10").resource.credits

[hiddenAction_队伍经济10+]
setResourcesWithLogic: 10＄+=nearestUnit(withTag="队伍10").resource.资源经济

[hiddenAction_队伍经济重置]
autoTrigger: if numberOfUnitsInTeam(withTag="真视之眼", lessThan=1) and numberOfUnitsInAllyTeam(withTag="真视之眼", lessThan=1) and self.tags(includes="队伍经济显示")
setResourcesWithLogic: 1＄=0, 2＄=0, 3＄=0, 4＄=0, 5＄=0, 6＄=0, 7＄=0, 8＄=0, 9＄=0, 10＄=0
temporarilyRemoveTags: 队伍经济显示

#———属性状态效果———

[template_全资源提取]
takeResources_discardCollected: true
takeResources_includeUnitsWithinRange: 1000000
takeResources_includeUnitsWithinRange_team: own
takeResources_maxUnits: 100000

[template_资源提取]
@copyFromSection: template_全资源提取
takeResources_excludeUnitsWithoutTags: units

[template_资源检索]
@copyFromSection: template_资源提取
takeResources_keepResourcesOnTarget: true

[template_状态给予]
@copyFromSection: template_资源检索
autoTrigger: true
takeResources: ${state}=0.1
takeResources_excludeUnitsWithTheseResources: ${state}状态=1
takeResources_triggerActionForEach: ${state}属性给予
temporarilyAddTags: ${state}系统

[template_状态恢复]
@copyFromSection: template_全资源提取
autoTrigger: if self.tags(includes="${state}系统")
takeResources: ${state}状态=1
takeResources_excludeUnitsWithTheseResources: ${state}=0.01
takeResources_triggerActionForEach: ${state}属性恢复

[template_状态时间]
@copyFromSection: template_全资源提取
autoTrigger: if self.tags(includes="${state}系统")
takeResources: ${state}=1
takeResources_triggerActionIfNoneCollected: ${state}结束

[template_属性给予]
sendMessageTo: thisActionTarget
sendMessageWithTags: 数据更新
takeResources: ${state}状态=-1, ${state}=-1
takeResources_discardCollected: true
takeResources_includeReference: thisActionTarget

[template_属性恢复]
sendMessageTo: thisActionTarget
sendMessageWithTags: 数据更新


[template_状态附中]
@copyFromSection: template_资源提取
autoTrigger: true
takeResources: ${state}附中=1
takeResources_excludeUnitsWithTheseResources: ${state}附中=${time}
@define time: 10

[template_状态附停激活]
autoTriggerOnEvent: newMessage(withTag='${state}附停激活')
requireConditional: if not self.tags(includes='${state}附停系统激活')
temporarilyAddTags: ${state}附停系统激活

[template_状态附停计时]
autoTrigger: if self.tags(includes='${state}附停系统激活') and self.resource.${state}附停计时<60
addResources: ${state}附停计时=10

[template_状态附停]
@copyFromSection: template_资源提取
autoTrigger: if self.resource.${state}附停计时>=60
takeResources: ${state}附停=1
setResourcesWithLogic: ${state}附停计时=0
temporarilyRemoveTags: ${state}附停系统激活
alsoTriggerAction: ${state}附停目标更新

[template_状态附停目标更新]
@copyFromSection: template_资源检索
takeResources: hp=0
takeResources_excludeUnitsWithoutTags: (目标)
takeResources_triggerActionForEach: ${state}目标更新


[template_目标更新]
sendMessageTo: thisActionTarget
sendMessageWithTags: ${state}更新


#-----属性状态变化发送-----
[hiddenAction_单位数据更新]
autoTriggerOnEvent: newMessage(withTag='数据更新')
sendMessageTo: eventSource
sendMessageWithTags: 数据更新
#- - - - - - - - - - -
[hiddenAction_单位数据延时更新]
autoTriggerOnEvent: newMessage(withTag='数据延时更新')
requireConditional: if not memory.数据更新单位.contains(eventSource)
setUnitMemory: 数据更新单位[memory.数据更新单位.size]=eventSource

[hiddenAction_单位数据延时更新计时]
autoTrigger: if self.resource.单位数据延时更新计时<2 and memory.数据更新单位[0]!=null
addResources: 单位数据延时更新计时=1
shrinkArrays: 数据更新单位

[hiddenAction_单位数据延时更新激活]
autoTrigger: if self.resource.单位数据延时更新计时>=2 and memory.数据更新单位[0]!=null
alsoTriggerAction: 单位数据延时更新赋予, 单位数据延时更新组重置
alsoTriggerActionRepeat: memory.数据更新单位.size

[hiddenAction_单位数据延时更新赋予]
sendMessageTo: self.readUnitMemory('数据更新单位', type='unit', index=memory.数据更新单位.size-1)
sendMessageWithTags: 数据更新

[hiddenAction_单位数据延时更新组重置]
setUnitMemory: 数据更新单位[memory.数据更新单位.size-1]=null
shrinkArrays: 数据更新单位

[hiddenAction_单位数据延时更新计时重置]
autoTrigger: if self.resource.单位数据延时更新计时>0 and memory.数据更新单位[0]==null
setResourcesWithLogic: 单位数据延时更新计时=0

[resource_单位数据延时更新计时]
displayName: 单位数据更新计时

#——堕天使-堕黯——

[hiddenAction_堕黯减速]
@copyFromSection: template_状态给予
@define state: 堕黯
autoTrigger: if numberOfUnitsInEnemyTeam(withTag="${state}", greaterThan=0)

[hiddenAction_堕黯减速恢复]
@copyFromSection: template_状态恢复
@define state: 堕黯

[hiddenAction_堕黯时间]
@copyFromSection: template_状态时间
@define state: 堕黯

[hiddenAction_堕黯属性给予]
@copyFromSection: template_属性给予
@define state: 堕黯
sendMessageWithData: 移速倍率=-0.5

[hiddenAction_堕黯属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 移速倍率=0.5

[hiddenAction_堕黯结束]
temporarilyRemoveTags: 堕黯系统

#——紫水晶α-紫静——

[hiddenAction_紫静减缓]
@copyFromSection: template_状态给予
@define state: 紫静
autoTrigger: if numberOfUnitsInEnemyTeam(withTag="紫水晶柱α", greaterThan=0)

[hiddenAction_紫静减缓恢复]
@copyFromSection: template_状态恢复
@define state: 紫静

[hiddenAction_紫静时间]
@copyFromSection: template_状态时间
@define state: 紫静

[hiddenAction_紫静属性给予]
@copyFromSection: template_属性给予
@define state: 紫静
sendMessageWithData: 攻速倍率=-0.5

[hiddenAction_紫静属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 攻速倍率=0.5

[hiddenAction_紫静结束]
temporarilyRemoveTags: 紫静系统

#——星舰-影兵——

[hiddenAction_影兵减缓]
@copyFromSection: template_状态给予
@define state: 影兵减缓
autoTrigger: if numberOfUnitsInEnemyTeam(withTag="影兵", greaterThan=0)

[hiddenAction_影兵减缓恢复]
@copyFromSection: template_状态恢复
@define state: 影兵减缓

[hiddenAction_影兵减缓时间]
@copyFromSection: template_状态时间
@define state: 影兵减缓

[hiddenAction_影兵减缓属性给予]
@copyFromSection: template_属性给予
@define state: 影兵减缓
sendMessageWithData: 攻速倍率=-0.25

[hiddenAction_影兵减缓属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 攻速倍率=0.25

[hiddenAction_影兵减缓结束]
temporarilyRemoveTags: 影兵减缓系统

#——蛞蝓-黏液——
[hiddenAction_黏液速度]
@copyFromSection: template_状态给予
@define state: 黏液速度
autoTrigger: if numberOfUnitsInAllyTeam(withTag="蛞蝓黏液", greaterThan=0) or numberOfUnitsInTeam(withTag="蛞蝓黏液", greaterThan=0)

[hiddenAction_黏液速度恢复]
@copyFromSection: template_状态恢复
@define state: 黏液速度

[hiddenAction_黏液速度时间]
@copyFromSection: template_状态时间
@define state: 黏液速度

[hiddenAction_黏液速度属性给予]
@copyFromSection: template_属性给予
@define state: 黏液速度
sendMessageWithData: 移速倍率=0.3

[hiddenAction_黏液速度属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 移速倍率=-0.3

[hiddenAction_黏液速度结束]
temporarilyRemoveTags: 黏液速度系统

#——狂猎-仙肴圣餐——

[hiddenAction_仙肴速度]
@copyFromSection: template_状态给予
@define state: 仙肴速度
autoTrigger: if numberOfUnitsInTeam(withTag="仙肴圣餐", greaterThan=0)

[hiddenAction_仙肴速度恢复]
@copyFromSection: template_状态恢复
@define state: 仙肴速度

[hiddenAction_仙肴速度时间]
@copyFromSection: template_状态时间
@define state: 仙肴速度
autoTrigger: if self.resource.仙肴速度计时<=0 and self.tags(includes="${state}系统")
takeResources_triggerActionIfAnyCollected: 仙肴速度计时+

[hiddenAction_仙肴速度属性给予]
@copyFromSection: template_属性给予
@define state: 仙肴速度
sendMessageWithData: 移速倍率=0.3, 攻速倍率=0.3

[hiddenAction_仙肴速度属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 移速倍率=-0.3, 攻速倍率=-0.3

[hiddenAction_仙肴速度结束]
temporarilyRemoveTags: 仙肴速度系统

[hiddenAction_仙肴速度计时-]
autoTrigger: if self.resource.仙肴速度计时>0
addResources: 仙肴速度计时=-10

[hiddenAction_仙肴速度计时+]
addResources: 仙肴速度计时=20

#——狂猎-狂猎时刻——

[hiddenAction_狂猎加速]
@copyFromSection: template_状态给予
@define state: 狂猎加速
autoTrigger: if self.globalTeamTags(includes='狂猎时刻')

[hiddenAction_狂猎加速恢复]
@copyFromSection: template_状态恢复
@define state: 狂猎加速

[hiddenAction_狂猎加速时间]
@copyFromSection: template_状态时间
@define state: 狂猎加速

[hiddenAction_狂猎加速属性给予]
@copyFromSection: template_属性给予
@define state: 狂猎加速
sendMessageWithData: 移速倍率=0.5

[hiddenAction_狂猎加速属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 移速倍率=-0.5

[hiddenAction_狂猎加速结束]
temporarilyRemoveTags: 狂猎加速系统

#——池虫-池虫强化——

[hiddenAction_池虫强化]
@copyFromSection: template_状态给予
@define state: 池虫强化
autoTrigger: if numberOfUnitsInTeam(withTag='池虫')>0

[hiddenAction_池虫强化恢复]
@copyFromSection: template_状态恢复
@define state: 池虫强化

[hiddenAction_池虫强化时间]
@copyFromSection: template_状态时间
@define state: 池虫强化

[hiddenAction_池虫强化属性给予]
@copyFromSection: template_属性给予
@define state: 池虫强化
sendMessageWithData: 攻速倍率=1.5, 射程加值=70

[hiddenAction_池虫强化属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 攻速倍率=-1.5, 射程加值=-70

[hiddenAction_池虫强化结束]
temporarilyRemoveTags: 池虫强化系统

[resource_池虫强化]
hidden: true

[resource_池虫强化状态]
hidden: true


[hiddenAction_池虫强化2]
@copyFromSection: template_状态给予
@define state: 池虫强化2
autoTrigger: if numberOfUnitsInTeam(withTag='池虫')>0

[hiddenAction_池虫强化2恢复]
@copyFromSection: template_状态恢复
@define state: 池虫强化2

[hiddenAction_池虫强化2时间]
@copyFromSection: template_状态时间
@define state: 池虫强化2

[hiddenAction_池虫强化2属性给予]
@copyFromSection: template_属性给予
@define state: 池虫强化2
sendMessageWithData: 攻速倍率=3, 射程加值=130

[hiddenAction_池虫强化2属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 攻速倍率=-3, 射程加值=-130

[hiddenAction_池虫强化2结束]
temporarilyRemoveTags: 池虫强化2系统

[resource_池虫强化2]
hidden: true

[resource_池虫强化2状态]
hidden: true

#——冰冻-冷离子——

[hiddenAction_冷冻减速]
@copyFromSection: template_状态给予
@define state: 冷冻
autoTrigger: if numberOfUnitsInEnemyTeam(withTag="冷离子", greaterThan=0)

[hiddenAction_冷冻减速恢复]
@copyFromSection: template_状态恢复
@define state: 冷冻

[hiddenAction_冷冻时间]
@copyFromSection: template_状态时间
@define state: 冷冻

[hiddenAction_冷冻属性给予]
@copyFromSection: template_属性给予
@define state: 冷冻
sendMessageWithData: 移速倍率=-0.25

[hiddenAction_冷冻属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 移速倍率=0.25

[hiddenAction_冷冻结束]
temporarilyRemoveTags: 冷冻系统

#——冷冻II-寒封冻天——

[hiddenAction_冷冻II减速]
@copyFromSection: template_状态给予
@define state: 冷冻II
autoTrigger: if numberOfUnitsInEnemyTeam(withTag="冻天", greaterThan=0)

[hiddenAction_冷冻II减速恢复]
@copyFromSection: template_状态恢复
@define state: 冷冻II

[hiddenAction_冷冻II时间]
@copyFromSection: template_状态时间
@define state: 冷冻II

[hiddenAction_冷冻II属性给予]
@copyFromSection: template_属性给予
@define state: 冷冻II
sendMessageWithData: 移速倍率=-0.5

[hiddenAction_冷冻II属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 移速倍率=0.5

[hiddenAction_冷冻II结束]
temporarilyRemoveTags: 冷冻II系统

#——别西卜-瘟疫——

[hiddenAction_瘟疫减速]
@copyFromSection: template_状态给予
@define state: 瘟疫减速
autoTrigger: if numberOfUnitsInEnemyTeam(withTag="别西卜瘟疫", greaterThan=0)

[hiddenAction_瘟疫减速恢复]
@copyFromSection: template_状态恢复
@define state: 瘟疫减速

[hiddenAction_瘟疫减速时间]
@copyFromSection: template_状态时间
@define state: 瘟疫减速

[hiddenAction_瘟疫减速属性给予]
@copyFromSection: template_属性给予
@define state: 瘟疫减速
sendMessageWithData: 移速倍率=-0.5, 攻速倍率=-0.5

[hiddenAction_瘟疫减速属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 移速倍率=0.5, 攻速倍率=0.5

[hiddenAction_瘟疫减速结束]
temporarilyRemoveTags: 瘟疫减速系统

#——贝露佩欧鲁权杖-日耀与月曜——

#---日耀---

[hiddenAction_日耀T1血盾]
@copyFromSection: template_状态给予
@define state: 日耀T1血盾
autoTrigger: if numberOfUnitsInAllyTeam(withTag="日耀T1", greaterThan=0) or numberOfUnitsInTeam(withTag="日耀T1", greaterThan=0)

[hiddenAction_日耀T1血盾恢复]
@copyFromSection: template_状态恢复
@define state: 日耀T1血盾

[hiddenAction_日耀T1血盾时间]
@copyFromSection: template_状态时间
@define state: 日耀T1血盾
autoTrigger: if self.resource.日耀T1血盾计时<=0 and self.tags(includes="${state}系统")
takeResources_triggerActionIfAnyCollected: 日耀T1血盾计时+

[hiddenAction_日耀T1血盾属性给予]
@copyFromSection: template_属性给予
@define state: 日耀T1血盾
requireConditional: if not thisActionTarget.tags(includes="贝露中心单位")
sendMessageWithData: 血量倍率=0.2, 护盾倍率=0.2

[hiddenAction_日耀T1血盾属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 血量倍率=-0.2, 护盾倍率=-0.2

[hiddenAction_日耀T1血盾结束]
temporarilyRemoveTags: 日耀T1血盾系统

[hiddenAction_日耀T1血盾计时-]
autoTrigger: if self.resource.日耀T1血盾计时>0
addResources: 日耀T1血盾计时=-10

[hiddenAction_日耀T1血盾计时+]
addResources: 日耀T1血盾计时=60


[hiddenAction_日耀T2血盾]
@copyFromSection: template_状态给予
@define state: 日耀T2血盾
autoTrigger: if numberOfUnitsInAllyTeam(withTag="日耀T2", greaterThan=0) or numberOfUnitsInTeam(withTag="日耀T2", greaterThan=0)

[hiddenAction_日耀T2血盾恢复]
@copyFromSection: template_状态恢复
@define state: 日耀T2血盾

[hiddenAction_日耀T2血盾时间]
@copyFromSection: template_状态时间
@define state: 日耀T2血盾
autoTrigger: if self.resource.日耀T2血盾计时<=0 and self.tags(includes="${state}系统")
takeResources_triggerActionIfAnyCollected: 日耀T2血盾计时+

[hiddenAction_日耀T2血盾属性给予]
@copyFromSection: template_属性给予
@define state: 日耀T2血盾
requireConditional: if not thisActionTarget.tags(includes="贝露中心单位")
sendMessageWithData: 血量倍率=0.1, 护盾倍率=0.1

[hiddenAction_日耀T2血盾属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 血量倍率=-0.1, 护盾倍率=-0.1

[hiddenAction_日耀T2血盾结束]
temporarilyRemoveTags: 日耀T2血盾系统

[hiddenAction_日耀T2血盾计时-]
autoTrigger: if self.resource.日耀T2血盾计时>0
addResources: 日耀T2血盾计时=-10

[hiddenAction_日耀T2血盾计时+]
addResources: 日耀T2血盾计时=60

#---月曜---

[hiddenAction_月曜T1速度]
@copyFromSection: template_状态给予
@define state: 月曜T1速度
autoTrigger: if numberOfUnitsInAllyTeam(withTag="月曜T1", greaterThan=0) or numberOfUnitsInTeam(withTag="月曜T1", greaterThan=0)

[hiddenAction_月曜T1速度恢复]
@copyFromSection: template_状态恢复
@define state: 月曜T1速度

[hiddenAction_月曜T1速度时间]
@copyFromSection: template_状态时间
@define state: 月曜T1速度
autoTrigger: if self.resource.月曜T1速度计时<=0 and self.tags(includes="${state}系统")
takeResources_triggerActionIfAnyCollected: 月曜T1速度计时+

[hiddenAction_月曜T1速度属性给予]
@copyFromSection: template_属性给予
@define state: 月曜T1速度
requireConditional: if not thisActionTarget.tags(includes="贝露中心单位")
sendMessageWithData: 移速倍率=0.15, 攻速倍率=0.15

[hiddenAction_月曜T1速度属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 移速倍率=-0.15, 攻速倍率=-0.15

[hiddenAction_月曜T1速度结束]
temporarilyRemoveTags: 月曜T1速度系统

[hiddenAction_月曜T1速度计时-]
autoTrigger: if self.resource.月曜T1速度计时>0
addResources: 月曜T1速度计时=-10

[hiddenAction_月曜T1速度计时+]
addResources: 月曜T1速度计时=60


[hiddenAction_月曜T2速度]
@copyFromSection: template_状态给予
@define state: 月曜T2速度
autoTrigger: if numberOfUnitsInAllyTeam(withTag="月曜T2", greaterThan=0) or numberOfUnitsInTeam(withTag="月曜T2", greaterThan=0)

[hiddenAction_月曜T2速度恢复]
@copyFromSection: template_状态恢复
@define state: 月曜T2速度

[hiddenAction_月曜T2速度时间]
@copyFromSection: template_状态时间
@define state: 月曜T2速度
autoTrigger: if self.resource.月曜T2速度计时<=0 and self.tags(includes="${state}系统")
takeResources_triggerActionIfAnyCollected: 月曜T2速度计时+

[hiddenAction_月曜T2速度属性给予]
@copyFromSection: template_属性给予
@define state: 月曜T2速度
requireConditional: if not thisActionTarget.tags(includes="贝露中心单位")
sendMessageWithData: 移速倍率=0.1, 攻速倍率=0.1

[hiddenAction_月曜T2速度属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 移速倍率=-0.1, 攻速倍率=-0.1

[hiddenAction_月曜T2速度结束]
temporarilyRemoveTags: 月曜T2速度系统

[hiddenAction_月曜T2速度计时-]
autoTrigger: if self.resource.月曜T2速度计时>0
addResources: 月曜T2速度计时=-10

[hiddenAction_月曜T2速度计时+]
addResources: 月曜T2速度计时=60

#---日月铭刻---

[hiddenAction_日耀铭刻激活]
autoTriggerOnEvent: newMessage(withTag='日耀铭刻')
requireConditional: if not self.tags(includes="日耀铭刻存在中")
temporarilyAddTags: 日耀铭刻存在中

[hiddenAction_日耀铭刻时间]
@copyFromSection: template_全资源提取
autoTrigger: if self.tags(includes="日耀铭刻存在中") and self.resource.日耀铭刻计时<=0
takeResources: 日耀铭刻=1
takeResources_triggerActionForEach: 日耀铭刻上限, 日耀铭刻状态T1, 日耀铭刻状态T2
takeResources_triggerActionIfAnyCollected: 日耀铭刻计时+
takeResources_triggerActionIfNoneCollected: 日耀铭刻结束

[hiddenAction_日耀铭刻上限]
requireConditional: if thisActionTarget.resource.日耀铭刻>60
takeResources: 日耀铭刻=1
takeResources_discardCollected: true
takeResources_includeReference: thisActionTarget
alsoTriggerAction: 日耀铭刻上限
alsoTriggerActionRepeat: thisActionTarget.resource.日耀铭刻-60

[hiddenAction_日耀铭刻状态T1]
requireConditional: if thisActionTarget.resource.日耀铭刻>0 and thisActionTarget.resource.日耀T1血盾>0 and thisActionTarget.resource.日耀T1血盾<2
takeResources: 日耀T1血盾=-1
takeResources_discardCollected: true
takeResources_includeReference: thisActionTarget

[hiddenAction_日耀铭刻状态T2]
requireConditional: if thisActionTarget.resource.日耀铭刻>0 and thisActionTarget.resource.日耀T2血盾>0 and thisActionTarget.resource.日耀T2血盾<2
takeResources: 日耀T2血盾=-1
takeResources_discardCollected: true
takeResources_includeReference: thisActionTarget

[hiddenAction_日耀铭刻结束]
temporarilyRemoveTags: 日耀铭刻存在中

[hiddenAction_日耀铭刻计时-]
autoTrigger: if self.resource.日耀铭刻计时>0
addResources: 日耀铭刻计时=-10

[hiddenAction_日耀铭刻计时+]
addResources: 日耀铭刻计时=60


[hiddenAction_月曜铭刻激活]
autoTriggerOnEvent: newMessage(withTag='月曜铭刻')
requireConditional: if not self.tags(includes="月曜铭刻存在中")
temporarilyAddTags: 月曜铭刻存在中

[hiddenAction_月曜铭刻时间]
@copyFromSection: template_全资源提取
autoTrigger: if self.tags(includes="月曜铭刻存在中") and self.resource.月曜铭刻计时<=0
takeResources: 月曜铭刻=1
takeResources_triggerActionForEach: 月曜铭刻上限, 月曜铭刻状态T1, 月曜铭刻状态T2
takeResources_triggerActionIfAnyCollected: 月曜铭刻计时+
takeResources_triggerActionIfNoneCollected: 月曜铭刻结束

[hiddenAction_月曜铭刻上限]
requireConditional: if thisActionTarget.resource.月曜铭刻>60
takeResources: 月曜铭刻=1
takeResources_discardCollected: true
takeResources_includeReference: thisActionTarget
alsoTriggerAction: 月曜铭刻上限
alsoTriggerActionRepeat: thisActionTarget.resource.月曜铭刻-60

[hiddenAction_月曜铭刻状态T1]
requireConditional: if thisActionTarget.resource.月曜铭刻>0 and thisActionTarget.resource.月曜T1速度>0 and thisActionTarget.resource.月曜T1速度<2
takeResources: 月曜T1速度=-1
takeResources_discardCollected: true
takeResources_includeReference: thisActionTarget

[hiddenAction_月曜铭刻状态T2]
requireConditional: if thisActionTarget.resource.月曜铭刻>0 and thisActionTarget.resource.月曜T2速度>0 and thisActionTarget.resource.月曜T2速度<2
takeResources: 月曜T2速度=-1
takeResources_discardCollected: true
takeResources_includeReference: thisActionTarget

[hiddenAction_月曜铭刻结束]
temporarilyRemoveTags: 月曜铭刻存在中

[hiddenAction_月曜铭刻计时-]
autoTrigger: if self.resource.月曜铭刻计时>0
addResources: 月曜铭刻计时=-10

[hiddenAction_月曜铭刻计时+]
addResources: 月曜铭刻计时=60

#——四面神-神压——

[hiddenAction_神压减速]
@copyFromSection: template_状态给予
@define state: 神压减速
autoTrigger: if numberOfUnitsInEnemyTeam(withTag="神压", greaterThan=0)

[hiddenAction_神压减速恢复]
@copyFromSection: template_状态恢复
@define state: 神压减速

[hiddenAction_神压减速时间]
@copyFromSection: template_状态时间
@define state: 神压减速

[hiddenAction_神压减速属性给予]
@copyFromSection: template_属性给予
@define state: 神压减速
sendMessageWithData: 移速倍率=-0.75, 攻速倍率=-0.5

[hiddenAction_神压减速属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 移速倍率=0.75, 攻速倍率=0.5

[hiddenAction_神压减速结束]
temporarilyRemoveTags: 神压减速系统

#——天气-大雾——

[hiddenAction_大雾减速]
@copyFromSection: template_状态给予
@define state: 大雾减速
autoTrigger: if numberOfUnitsInEnemyTeam(withTag="大雾", greaterThan=0)

[hiddenAction_大雾减速恢复]
@copyFromSection: template_状态恢复
@define state: 大雾减速

[hiddenAction_大雾减速时间]
@copyFromSection: template_状态时间
@define state: 大雾减速

[hiddenAction_大雾减速属性给予]
@copyFromSection: template_属性给予
@define state: 大雾减速
sendMessageWithData: 攻速倍率=-0.25

[hiddenAction_大雾减速属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 攻速倍率=0.25

[hiddenAction_大雾减速结束]
temporarilyRemoveTags: 大雾减速系统

#——贝露佩欧鲁-无光禁区——

[hiddenAction_光雾速度]
@copyFromSection: template_状态给予
@define state: 光雾速度
autoTrigger: if numberOfUnitsInTeam(withTag="无光禁区", greaterThan=0)

[hiddenAction_光雾速度恢复]
@copyFromSection: template_状态恢复
@define state: 光雾速度

[hiddenAction_光雾速度时间]
@copyFromSection: template_状态时间
@define state: 光雾速度

[hiddenAction_光雾速度属性给予]
@copyFromSection: template_属性给予
@define state: 光雾速度
sendMessageWithData: 移速倍率=0.25, 攻速倍率=0.25

[hiddenAction_光雾速度属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 移速倍率=-0.25, 攻速倍率=-0.25

[hiddenAction_光雾速度结束]
temporarilyRemoveTags: 光雾速度系统

#——贝露佩欧鲁-雾霾——

[hiddenAction_雾霾减速]
@copyFromSection: template_状态给予
@define state: 雾霾减速
autoTrigger: if numberOfUnitsInEnemyTeam(withTag="雾霾", greaterThan=0)

[hiddenAction_雾霾减速恢复]
@copyFromSection: template_状态恢复
@define state: 雾霾减速

[hiddenAction_雾霾减速时间]
@copyFromSection: template_状态时间
@define state: 雾霾减速

[hiddenAction_雾霾减速属性给予]
@copyFromSection: template_属性给予
@define state: 雾霾减速
sendMessageWithData: 移速倍率=-0.5, 攻速倍率=-0.5

[hiddenAction_雾霾减速属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 移速倍率=0.5, 攻速倍率=0.5

[hiddenAction_雾霾减速结束]
temporarilyRemoveTags: 雾霾减速系统

#——山-泥石流——

[hiddenAction_泥石流减速]
@copyFromSection: template_状态给予
@define state: 泥石流
autoTrigger: if numberOfUnitsInEnemyTeam(withTag="泥石流", greaterThan=0)

[hiddenAction_泥石流减速恢复]
@copyFromSection: template_状态恢复
@define state: 泥石流

[hiddenAction_泥石流时间]
@copyFromSection: template_状态时间
@define state: 泥石流

[hiddenAction_泥石流属性给予]
@copyFromSection: template_属性给予
@define state: 泥石流
sendMessageWithData: 移速倍率=-0.9

[hiddenAction_泥石流属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 移速倍率=0.9

[hiddenAction_泥石流结束]
temporarilyRemoveTags: 泥石流系统

#——教堂坦克-时停——

[hiddenAction_受到时间暂停]
@copyFromSection: template_资源提取
autoTrigger: if numberOfUnitsInAllTeams(withTag="时间暂停", greaterThan=0)
takeResources: 时间凝固=-1
takeResources_excludeUnitsWithTheseResources: 时间凝固=2

#- - - 激活 - - -

[hiddenAction_时间凝固]
@copyFromSection: template_状态给予
@define state: 时间凝固
autoTrigger: if numberOfUnitsInAllTeams(withTag="时间暂停", greaterThan=0)

[hiddenAction_时间凝固恢复]
@copyFromSection: template_状态恢复
@define state: 时间凝固

[hiddenAction_时间凝固时间]
@copyFromSection: template_状态时间
@define state: 时间凝固

[hiddenAction_时间凝固属性给予]
@copyFromSection: template_属性给予
@define state: 时间凝固
requireConditional: if not thisActionTarget.tags(includes="暮光秩序")
sendMessageWithTags: 数据更新, 时间暂停
sendMessageWithData: 护盾恢复乘数=-1, 攻速倍率乘数=-1, 转向速度乘数=-1, 生产速度乘数=-1, 移速乘数=-1

[hiddenAction_时间凝固属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 护盾恢复乘数=1, 攻速倍率乘数=1, 转向速度乘数=1, 生产速度乘数=1, 移速乘数=1

[hiddenAction_时间凝固结束]
temporarilyRemoveTags: 时间凝固系统

#——废料-阻滞——

[hiddenAction_阻滞减速]
@copyFromSection: template_状态给予
@define state: 阻滞
#autoTrigger: if numberOfUnitsInNeutralTeam(withTag="废料", greaterThan=0)
autoTrigger: false

[hiddenAction_阻滞减速恢复]
@copyFromSection: template_状态恢复
@define state: 阻滞

[hiddenAction_阻滞时间]
@copyFromSection: template_状态时间
@define state: 阻滞

[hiddenAction_阻滞属性给予]
@copyFromSection: template_属性给予
@define state: 阻滞
sendMessageWithData: 移速倍率=-0.1

[hiddenAction_阻滞属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 移速倍率=0.1

[hiddenAction_阻滞结束]
temporarilyRemoveTags: 阻滞系统

#——新之铁锈·实验型战斗蜘蛛-麻痹——

[hiddenAction_麻痹减速]
@copyFromSection: template_状态给予
@define state: 麻痹减速
autoTrigger: if numberOfUnitsInEnemyTeam(withTag="麻痹", greaterThan=0)

[hiddenAction_麻痹减速恢复]
@copyFromSection: template_状态恢复
@define state: 麻痹减速

[hiddenAction_麻痹减速时间]
@copyFromSection: template_状态时间
@define state: 麻痹减速

[hiddenAction_麻痹减速属性给予]
@copyFromSection: template_属性给予
@define state: 麻痹减速
sendMessageWithData: 移速倍率=-0.75, 攻速倍率=-0.75

[hiddenAction_麻痹减速属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 移速倍率=0.75, 攻速倍率=0.75

[hiddenAction_麻痹减速结束]
temporarilyRemoveTags: 麻痹减速系统

#——地图-风之领域——

[hiddenAction_风之领域]
@copyFromSection: template_状态给予
@define state: 风之领域
autoTrigger: if numberOfUnitsInTeam(withTag='风之领域')>0

[hiddenAction_风之领域恢复]
@copyFromSection: template_状态恢复
@define state: 风之领域

[hiddenAction_风之领域时间]
@copyFromSection: template_状态时间
@define state: 风之领域

[hiddenAction_风之领域属性给予]
@copyFromSection: template_属性给予
@define state: 风之领域
sendMessageWithData: 移速倍率=0.5

[hiddenAction_风之领域属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 移速倍率=-0.5

[hiddenAction_风之领域结束]
temporarilyRemoveTags: 风之领域系统

#——皎红-虚红感染——

[hiddenAction_虚红感染附中]
@copyFromSection: template_状态附中
@define state: 虚红感染
autoTrigger: if numberOfUnitsInTeam(withTag="虚红感染区", greaterThan=0) and self.resource.虚红感染附中计时<=0
takeResources_triggerActionIfAnyCollected: 虚红感染附中计时+

[hiddenAction_虚红感染附停激活]
@copyFromSection: template_状态附停激活
@define state: 虚红感染

[hiddenAction_虚红感染附停计时]
@copyFromSection: template_状态附停计时
@define state: 虚红感染

[hiddenAction_虚红感染附停]
@copyFromSection: template_状态附停
@define state: 虚红感染

[hiddenAction_虚红感染附停目标更新]
@copyFromSection: template_状态附停目标更新
@define state: 虚红感染
takeResources_excludeUnitsWithoutTags: 虚红感染区

[hiddenAction_虚红感染目标更新]
@copyFromSection: template_目标更新
@define state: 虚红感染

[hiddenAction_虚红感染]
@copyFromSection: template_状态给予
@define state: 虚红感染
autoTrigger: if numberOfUnitsInTeam(withTag="虚红感染区", greaterThan=0)

[hiddenAction_虚红感染恢复]
@copyFromSection: template_状态恢复
@define state: 虚红感染

[hiddenAction_虚红感染时间]
@copyFromSection: template_状态时间
@define state: 虚红感染
autoTrigger: if self.resource.虚红感染计时<=0 and self.tags(includes="${state}系统")
takeResources_triggerActionIfAnyCollected: 虚红感染计时+

[hiddenAction_虚红感染属性给予]
@copyFromSection: template_属性给予
@define state: 虚红感染
sendMessageWithData: 伤害倍率=0.25, 血量倍率=0.25

[hiddenAction_虚红感染属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 伤害倍率=-0.25, 血量倍率=-0.25
#-------------
takeResources: 虚红感染负面状态=-1
takeResources_includeReference: thisActionTarget
temporarilyAddTags: 负虚红感染系统
fireTurretXAtGround: 1
fireTurretXAtGround_withProjectile: 负虚红感染特效
fireTurretXAtGround_withTarget: thisActionTarget.getOffsetAbsolute(y=-thisActionTarget.height)

[hiddenAction_虚红感染结束]
temporarilyRemoveTags: 虚红感染系统

[hiddenAction_虚红感染计时-]
autoTrigger: if self.resource.虚红感染计时>0
addResources: 虚红感染计时=-10

[hiddenAction_虚红感染计时+]
addResources: 虚红感染计时=60

[hiddenAction_虚红感染附中计时-]
autoTrigger: if self.resource.虚红感染附中计时>0
addResources: 虚红感染附中计时=-10

[hiddenAction_虚红感染附中计时+]
addResources: 虚红感染附中计时=60

#---虚红感染负面---

[hiddenAction_虚红感染负增]
@copyFromSection: template_资源检索
autoTrigger: if self.tags(includes="负虚红感染系统")
takeResources: 虚红感染负面状态=1
takeResources_excludeUnitsWithTheseResources: 负虚红感染=2
takeResources_triggerActionForEach: 负虚红感染增加

[hiddenAction_负虚红感染增加]
takeResources: 负虚红感染=-1
takeResources_includeReference: thisActionTarget
takeResources_discardCollected: true


[hiddenAction_负虚红感染]
@copyFromSection: template_状态给予
@define state: 负虚红感染
autoTrigger: if self.tags(includes="${state}系统")

[hiddenAction_负虚红感染恢复]
@copyFromSection: template_状态恢复
@define state: 负虚红感染

[hiddenAction_负虚红感染时间]
@copyFromSection: template_状态时间
@define state: 负虚红感染
autoTrigger: if self.resource.负虚红感染计时<=0 and self.tags(includes="${state}系统")
takeResources_triggerActionIfAnyCollected: 负虚红感染计时+

[hiddenAction_负虚红感染属性给予]
@copyFromSection: template_属性给予
@define state: 负虚红感染
sendMessageWithData: 伤害倍率=-0.65, 血量倍率=0.25

[hiddenAction_负虚红感染属性恢复]
@copyFromSection: template_属性恢复
sendMessageWithData: 伤害倍率=0.65, 血量倍率=-0.25

[hiddenAction_负虚红感染结束]
temporarilyRemoveTags: 负虚红感染系统

[hiddenAction_负虚红感染计时-]
autoTrigger: if self.resource.负虚红感染计时>0
addResources: 负虚红感染计时=-10

[hiddenAction_负虚红感染计时+]
addResources: 负虚红感染计时=60


[projectile_负虚红感染特效]
directDamage: 0
invisible: true
life: 10
instant: true
targetGround_includeTargetHeight: true
explodeEffect: 虚红感染标, 虚红感染暗标, 虚红感染光, 虚红感染暗光, 虚红感染散

[effect_虚红感染标]
priority: low
life: 35
fadeInTime: 5
scaleFrom: 0.2
scaleTo: 0.2
alpha: 0.5
image: 虚红icon.png
attachedToUnit: true
alwayStartDirAtZero: true

[effect_虚红感染暗标]
@copyFromSection: effect_虚红感染标
life: 15
fadeInTime: 0
scaleFrom: 0.15
scaleTo: 0.2
alpha: 0.5
color: #000000

[effect_虚红感染光]
priority: low
life: 30
scaleFrom: 0
scaleTo: 2
alpha: 0.5
image: SHARED:light_50.png
color: #FF0000
attachedToUnit: true
dirSpeedRandom: 3
dirOffsetRandom: 180

[effect_虚红感染暗光]
@copyFromSection: effect_虚红感染光
life: 30
scaleFrom: 1.6
scaleTo: 0
alpha: 0.9
color: #000000

[effect_虚红感染散]
priority: low
life: 80
fadeOut: true
fadeInTime: 5
scaleFrom: 0.1
scaleTo: 0.02
alpha: 0.3
image: 红曜散裂.png
color: #000000
attachedToUnit: true

#——特殊状态变化——

#——中毒状态-毒素——

[hiddenAction_毒素存在中]
autoTrigger: if numberOfUnitsInEnemyTeam(withTag="毒素", greaterThan=0) and not self.tags(includes="毒素存在中")
temporarilyAddTags: 毒素存在中

[hiddenAction_毒素扣血]
@copyFromSection: template_资源提取
autoTrigger: if self.tags(includes="毒素存在中")
takeResources: 毒素=9, hp=9
takeResources_excludeUnitsWithoutTags: units

[hiddenAction_毒素扣血1]
@copyFromSection: hiddenAction_毒素扣血
takeResources: 毒素=1.001, hp=1.001

[hiddenAction_毒素缓净]
@copyFromSection: hiddenAction_毒素扣血
takeResources: 毒素=0.25
takeResources_excludeUnitsWithTheseResources: hp=1.01
takeResources_excludeUnitsWithoutAllResources: false

[hiddenAction_毒素检测]
@copyFromSection: template_资源提取
autoTrigger: if self.tags(includes="毒素存在中")
takeResources: 毒素=1.001
takeResources_keepResourcesOnTarget: true
takeResources_excludeUnitsWithoutTags: units
takeResources_triggerActionIfNoneCollected: 毒素状态结束

[hiddenAction_毒素状态结束]
temporarilyRemoveTags: 毒素存在中

#---弱效毒素---

[hiddenAction_弱效毒素存在中]
autoTrigger: if numberOfUnitsInEnemyTeam(withTag="弱效毒素", greaterThan=0) and not self.tags(includes="弱效毒素存在中")
temporarilyAddTags: 弱效毒素存在中

[hiddenAction_弱效毒素扣血]
@copyFromSection: template_资源提取
autoTrigger: if self.tags(includes="弱效毒素存在中")
takeResources: 弱效毒素=3, hp=3
takeResources_excludeUnitsWithoutTags: units
takeResources_excludeUnitsWithTheseResources: 毒素=1.001

[hiddenAction_弱效毒素扣血1]
@copyFromSection: hiddenAction_弱效毒素扣血
takeResources: 弱效毒素=0.301, hp=0.301
takeResources_excludeUnitsWithTheseResources: 毒素=1.001

[hiddenAction_弱效毒素缓净]
@copyFromSection: hiddenAction_弱效毒素扣血
takeResources: 弱效毒素=0.8
takeResources_excludeUnitsWithTheseResources: hp=0.301
takeResources_excludeUnitsWithoutAllResources: false

[hiddenAction_弱效毒素检测]
@copyFromSection: template_资源提取
autoTrigger: if self.tags(includes="弱效毒素存在中")
takeResources: 弱效毒素=0.301
takeResources_keepResourcesOnTarget: true
takeResources_excludeUnitsWithoutTags: units
takeResources_triggerActionIfNoneCollected: 弱效毒素状态结束

[hiddenAction_弱效毒素状态结束]
temporarilyRemoveTags: 弱效毒素存在中



[hiddenAction_毒素净化]
@copyFromSection: template_资源提取
autoTrigger: if self.tags(includes="毒素存在中") and numberOfUnitsInTeam(withTag="不会受伤", greaterThan=0, incompleteBuildings=true)
takeResources: 毒素=99999999, 弱效毒素=99999999
takeResources_excludeUnitsWithoutTags: 不会受伤
takeResources_excludeUnitsWithoutAllResources: false
takeResources_discardCollected: false
takeResources_directTransferStoppingAtZero: true

#——日曜灼烧-曜痕——

[hiddenAction_日曜灼烧中]
autoTrigger: if numberOfUnitsInEnemyTeam(withTag="日曜灼烧", greaterThan=0) and not self.tags(includes="日曜灼烧中")
temporarilyAddTags: 日曜灼烧中

[hiddenAction_曜痕状态]
@copyFromSection: template_资源提取
autoTrigger: if self.tags(includes="日曜灼烧中")
takeResources: 曜痕状态=0.1
takeResources_excludeUnitsWithoutTags: units

[hiddenAction_曜痕复愈]
@copyFromSection: template_资源提取
autoTrigger: if self.tags(includes="日曜灼烧中")
takeResources: 曜痕=0.1
takeResources_excludeUnitsWithoutTags: units
takeResources_excludeUnitsWithoutAllResources: false
takeResources_directTransferStoppingAtZero: true
takeResources_discardCollected: false
takeResources_excludeUnitsWithTheseResources: 曜痕状态=0.1

[hiddenAction_日曜灼烧检测]
@copyFromSection: template_资源提取
autoTrigger: if self.tags(includes="日曜灼烧中")
takeResources: 曜痕=0.01
takeResources_keepResourcesOnTarget: true
takeResources_excludeUnitsWithoutTags: units
takeResources_triggerActionIfNoneCollected: 日曜灼烧结束

[hiddenAction_日曜灼烧结束]
temporarilyRemoveTags: 日曜灼烧中

#——赤血战蝎T2-赤血祭焰——

[hiddenAction_赤血祭焰]
autoTrigger: if numberOfUnitsInEnemyTeam(withTag="焚烬之冷血", greaterThan=0)
takeResources: 赤血祭焰=1, 减血倍率=-0.4
takeResources_discardCollected: true
takeResources_includeUnitsWithinRange: 1000000
takeResources_includeUnitsWithinRange_team: own
takeResources_maxUnits: 100000


#——系统——

[hiddenAction_创建初始]
autoTriggerOnEvent: created
teleportTo: createMarker(x=100, y=100)
setResourcesWithLogic: 玩家总数=numberOfUnitsInAllTeams(withTag='单位系统')

[hiddenAction_超出地图]
autoTrigger: if not self.isInMap and not self.tags(includes='超出地图')
showMessageToPlayer: 检测单位系统位置超出地图
temporarilyAddTags: 超出地图

[hiddenAction_重新生成]
autoTriggerOnEvent: destroyed
requireConditional: if numberOfUnitsInTeam(withTag="units", greaterThan=0, incompleteBuildings=true, factoryQueue=true) or substring(str(createMarker(x=-1000,y=-1000).nearestUnit),0,15) == "editorOrBuilder"
spawnUnits: 单位系统

[hiddenAction_己失败检测计时]
autoTrigger: if numberOfUnitsInTeam(withTag="units", lessThan=1, incompleteBuildings=true, factoryQueue=true) and self.resource.失败计时<=150
addResources: 失败计时=1

[hiddenAction_己失败计时重置]
autoTrigger: if numberOfUnitsInTeam(withTag="units", greaterThan=0, incompleteBuildings=true, factoryQueue=true) and self.resource.失败计时>0
setResourcesWithLogic: 失败计时=0

[hiddenAction_删除自身]
autoTrigger: if numberOfUnitsInTeam(withTag="units", lessThan=1, incompleteBuildings=true, factoryQueue=true) and self.resource.失败计时>=150 and (self.timeAlive(laterThanSeconds=30) or numberOfUnitsInTeam(lessThan=1)) and not self.globalTeamTags(includes='生存模式') and substring(str(createMarker(x=-1000,y=-1000).nearestUnit),0,15) != "editorOrBuilder"
deleteSelf: true

[hiddenAction_删除提示]
autoTriggerOnEvent: destroyed
requireConditional: if numberOfUnitsInTeam(withTag="units", lessThan=1, incompleteBuildings=true, factoryQueue=true)
showMessageToPlayer: 已关闭全局单位系统

[hiddenAction_队伍ID1]
autoTrigger: if self.teamId==0 and not self.tags(includes="${section.temporarilyAddTags}")
temporarilyAddTags: 队伍1

[hiddenAction_队伍ID2]
autoTrigger: if self.teamId==1 and not self.tags(includes="${section.temporarilyAddTags}")
temporarilyAddTags: 队伍2

[hiddenAction_队伍ID3]
autoTrigger: if self.teamId==2 and not self.tags(includes="${section.temporarilyAddTags}")
temporarilyAddTags: 队伍3

[hiddenAction_队伍ID4]
autoTrigger: if self.teamId==3 and not self.tags(includes="${section.temporarilyAddTags}")
temporarilyAddTags: 队伍4

[hiddenAction_队伍ID5]
autoTrigger: if self.teamId==4 and not self.tags(includes="${section.temporarilyAddTags}")
temporarilyAddTags: 队伍5

[hiddenAction_队伍ID6]
autoTrigger: if self.teamId==5 and not self.tags(includes="${section.temporarilyAddTags}")
temporarilyAddTags: 队伍6

[hiddenAction_队伍ID7]
autoTrigger: if self.teamId==6 and not self.tags(includes="${section.temporarilyAddTags}")
temporarilyAddTags: 队伍7

[hiddenAction_队伍ID8]
autoTrigger: if self.teamId==7 and not self.tags(includes="${section.temporarilyAddTags}")
temporarilyAddTags: 队伍8

[hiddenAction_队伍ID9]
autoTrigger: if self.teamId==8 and not self.tags(includes="${section.temporarilyAddTags}")
temporarilyAddTags: 队伍9

[hiddenAction_队伍ID10]
autoTrigger: if self.teamId==9 and not self.tags(includes="${section.temporarilyAddTags}")
temporarilyAddTags: 队伍10

[hiddenAction_队伍ID11]
autoTrigger: if self.teamId==10 and not self.tags(includes="${section.temporarilyAddTags}")
temporarilyAddTags: 队伍11

[hiddenAction_队伍ID12]
autoTrigger: if self.teamId==11 and not self.tags(includes="${section.temporarilyAddTags}")
temporarilyAddTags: 队伍12

[hiddenAction_队伍ID13]
autoTrigger: if self.teamId==12 and not self.tags(includes="${section.temporarilyAddTags}")
temporarilyAddTags: 队伍13

[hiddenAction_队伍ID14]
autoTrigger: if self.teamId==13 and not self.tags(includes="${section.temporarilyAddTags}")
temporarilyAddTags: 队伍14

[hiddenAction_队伍ID15]
autoTrigger: if self.teamId==14 and not self.tags(includes="${section.temporarilyAddTags}")
temporarilyAddTags: 队伍15

[resource_失败计时]
displayName: 失败计时


#——其他——

[global_resource_狂猎时刻]
hidden: false
displayName: [狂猎时刻
displayTextPostfix: s]
displayColor: #B4BE5CFF
priority: 0.5
displayPos: 99
displayRoundedDown: true

[global_resource_狂猎时刻即将开始]
hidden: false
displayName: 狂猎时刻即将开始
displayTextPostfix: s
displayColor: #B4BE5CFF
priority: 0.5
displayPos: 99
displayRoundedDown: true

[resource_预狂猎时刻]
hidden: true

[resource_预狂猎色幕]
hidden: true

[global_resource_淡顶点]
displayName: 顶点{○}
displayColor: #B4CC0000
priority: 0.5

[global_resource_顶点]
displayName: 顶点{◎}
displayColor: #CC0000
priority: 0.5

[resource_资源初刻]
displayName: 资源初刻

[resource_资源终刻]
displayName: 资源终刻

[resource_资源比值]
displayName: 资源比值

[resource_资源经济]
displayName: 资源经济

[resource_资源对比时间]
displayName: 资源对比时间

[resource_顶点对比时间]
displayName: 顶点对比时间

[resource_顶点较低]
displayName: 顶点较低


[resource_帝国CD]
hidden: true

[resource_铁锈CD]
hidden: true

[resource_虫族CD]
hidden: true


[resource_其他支配卫星]
hidden: true



[resource_血量倍率]
displayName: 血量倍率

[resource_护盾倍率]
displayName: 护盾倍率

[resource_移速倍率]
displayName: 移速倍率

[resource_攻速倍率]
displayName: 攻速倍率

[resource_减血倍率]
displayName: 减血倍率

[resource_堕黯]
hidden: true

[resource_堕黯状态]
hidden: true

[resource_紫静]
hidden: true

[resource_紫静状态]
hidden: true

[resource_影兵减缓]
hidden: true

[resource_影兵减缓状态]
hidden: true

[resource_黏液速度]
hidden: true

[resource_黏液速度状态]
hidden: true

[resource_仙肴速度]
hidden: true

[resource_仙肴速度计时]
hidden: true

[resource_仙肴速度状态]
hidden: true

[resource_狂猎加速]
hidden: true

[resource_狂猎加速计时]
hidden: true

[resource_狂猎加速状态]
hidden: true

[resource_冷冻]
hidden: true

[resource_冷冻状态]
hidden: true

[resource_冷冻II]
hidden: true

[resource_冷冻II状态]
hidden: true

[resource_瘟疫减速]
hidden: true

[resource_瘟疫减速状态]
hidden: true

[resource_日耀T1血盾]
hidden: true

[resource_日耀T1血盾计时]
hidden: true

[resource_日耀T1血盾状态]
hidden: true

[resource_日耀T2血盾]
hidden: true

[resource_日耀T2血盾计时]
hidden: true

[resource_日耀T2血盾状态]
hidden: true

[resource_月曜T1速度]
hidden: true

[resource_月曜T1速度计时]
hidden: true

[resource_月曜T1速度状态]
hidden: true

[resource_月曜T2速度]
hidden: true

[resource_月曜T2速度计时]
hidden: true

[resource_月曜T2速度状态]
hidden: true

[resource_神压减速]
hidden: true

[resource_神压减速状态]
hidden: true

[resource_大雾减速]
hidden: true

[resource_大雾减速状态]
hidden: true

[resource_雾霾减速]
hidden: true

[resource_雾霾减速状态]
hidden: true

[resource_光雾速度]
hidden: true

[resource_光雾速度状态]
hidden: true

[resource_泥石流]
hidden: true

[resource_泥石流状态]
hidden: true

[resource_时间凝固]
hidden: true

[resource_时间凝固状态]
hidden: true

[resource_阻滞]
hidden: true

[resource_阻滞状态]
hidden: true

[resource_麻痹减速]
hidden: true

[resource_麻痹减速状态]
hidden: true

[resource_风之领域]
hidden: true

[resource_风之领域计时]
hidden: true

[resource_风之领域状态]
hidden: true

[resource_虚红感染]
hidden: true

[resource_虚红感染计时]
hidden: true

[resource_虚红感染状态]
displayName: 虚红感染状态

[resource_虚红感染负面状态]
hidden: true

[resource_负虚红感染]
hidden: true

[resource_负虚红感染计时]
hidden: true

[resource_负虚红感染状态]
displayName: 虚红感染负面状态

[resource_虚红感染附中]
hidden: true

[resource_虚红感染附中计时]
hidden: true

[resource_虚红感染附停]
hidden: true

[resource_虚红感染附停计时]
hidden: true


[resource_毒素]
displayName: 毒素

[resource_弱效毒素]
displayName: 弱效毒素

[resource_曜痕]
displayName: 曜痕

[resource_曜痕状态]
hidden: true

[resource_日耀铭刻]
displayName: 日耀铭刻

[resource_月曜铭刻]
displayName: 月曜铭刻

[resource_日耀铭刻计时]
hidden: true

[resource_月曜铭刻计时]
hidden: true

[resource_赤血祭焰]
hidden: true


[global_resource_1＄]
displayTextPrefix: ＄
displayColor: #B400FF00
displayPos: -1
displayTextAppendResource: 1＄+
displayRoundedDown: true

[global_resource_1＄+]
displayTextPrefix: (+
displayTextPostfix: )
displayColor: #B400FF00
displayRoundedDown: true
hidden: true

[global_resource_2＄]
displayTextPrefix: ＄
displayColor: #B4CC2114
displayPos: -1
displayTextAppendResource: 2＄+
displayRoundedDown: true

[global_resource_2＄+]
displayTextPrefix: (+
displayTextPostfix: )
displayColor: #B4CC2114
displayRoundedDown: true
hidden: true

[global_resource_3＄]
displayTextPrefix: ＄
displayColor: #B40066FF
displayPos: -1
displayTextAppendResource: 3＄+
displayRoundedDown: true

[global_resource_3＄+]
displayTextPrefix: (+
displayTextPostfix: )
displayColor: #B40066FF
displayRoundedDown: true
hidden: true

[global_resource_4＄]
displayTextPrefix: ＄
displayColor: #B4FBFE4B
displayPos: -1
displayTextAppendResource: 4＄+
displayRoundedDown: true

[global_resource_4＄+]
displayTextPrefix: (+
displayTextPostfix: )
displayColor: #B4FBFE4B
displayRoundedDown: true
hidden: true

[global_resource_5＄]
displayTextPrefix: ＄
displayColor: #B400FFFF
displayPos: -1
displayTextAppendResource: 5＄+
displayRoundedDown: true

[global_resource_5＄+]
displayTextPrefix: (+
displayTextPostfix: )
displayColor: #B400FFFF
displayRoundedDown: true
hidden: true

[global_resource_6＄]
displayTextPrefix: ＄
displayColor: #B4D6FFFE
displayPos: -1
displayTextAppendResource: 6＄+
displayRoundedDown: true

[global_resource_6＄+]
displayTextPrefix: (+
displayTextPostfix: )
displayColor: #B4D6FFFE
displayRoundedDown: true
hidden: true

[global_resource_7＄]
displayTextPrefix: ＄
displayColor: #B4000100
displayPos: -1
displayTextAppendResource: 7＄+
displayRoundedDown: true

[global_resource_7＄+]
displayTextPrefix: (+
displayTextPostfix: )
displayColor: #B4000100
displayRoundedDown: true
hidden: true

[global_resource_8＄]
displayTextPrefix: ＄
displayColor: #B4FF00EA
displayPos: -1
displayTextAppendResource: 8＄+
displayRoundedDown: true

[global_resource_8＄+]
displayTextPrefix: (+
displayTextPostfix: )
displayColor: #B4FF00EA
displayRoundedDown: true
hidden: true

[global_resource_9＄]
displayTextPrefix: ＄
displayColor: #B4FF8826
displayPos: -1
displayTextAppendResource: 9＄+
displayRoundedDown: true

[global_resource_9＄+]
displayTextPrefix: (+
displayTextPostfix: )
displayColor: #B4FF8826
displayRoundedDown: true
hidden: true

[global_resource_10＄]
displayTextPrefix: ＄
displayColor: #B49169BF
displayPos: -1
displayTextAppendResource: 10＄+
displayRoundedDown: true

[global_resource_10＄+]
displayTextPrefix: (+
displayTextPostfix: )
displayColor: #B49169BF
displayRoundedDown: true
hidden: true


[global_resource_支配值]
hidden: true
displayName: 支配值
displayNameShort: 支配值
priority: 0.8

[global_resource_玩家总数]
hidden: true
displayName: 玩家总数
priority: 0.8

[graphics]
isVisible: false
image: SHARED:blank.png
icon_zoomed_out_neverShow: true

[attack]
canAttack: false

[turret_1]
x: 0
y: 0
canShoot: false

[movement]
movementType: AIR
moveSpeed: 5
targetHeight: -15
targetHeightDrift: 0
startingHeightOffset: -15
