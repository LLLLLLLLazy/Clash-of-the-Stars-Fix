[core]



name:盘虫
maxHp:2800
mass:8000
price:2600
radius:18
displayRadius:22
techLevel:2
softCollisionOnAll:10
armour:8
armourMinDamageToKeep:8
selfRegenRate:0.15

buildSpeed:18.5s
isBug:true
isBio:true
tags: units, 虫族, 中型虫, 盘虫, 固定射击
displayDescription:-坚实可靠\n-对地撞击\n “健身不健腿”

energyMax: 1
energyRegen: 0.0015

[action_碰撞飞盘]
displayType: queueUnit
price: energy=1
text: 碰撞飞盘
description: -向指定位置发射飞盘 \n -飞盘落地后会弹向最近的敌方单位 \n -造成40单体伤害并击退
fireTurretXAtGround: skill
fireTurretXAtGround_withProjectile: null
fireTurretXAtGround_showGuideDecals: 技能范围圈
alsoTriggerAction: 飞盘执行
highPriorityQueue: true
iconImage: 盘.png
buildSpeed: 0.1s
pos: 0.1

[hiddenAction_飞盘执行]
fireTurretXAtGround: skill
fireTurretXAtGround_withTarget: getOffsetRelative(y=min(distanceBetween(self, thisActionTarget), 200), dirOffset=directionBetween(self, thisActionTarget)-self.dir)
fireTurretXAtGround_withProjectile: 2

[decal_技能范围圈]
basePosition: self
layer: inactive
image: 范围圈600.png
imageScale: ${200/300}
alpha: 0.4

[action_switch1]
isVisible: if not self.globalTeamTags(includes='盘虫-自动飞盘')
addGlobalTeamTags: 盘虫-自动飞盘
id: ${section.text}
text: 自动飞盘
description: -启用时攻击指令自动发动碰撞飞盘 \n -全局设置
buildSpeed: 0s
pos: 0.2
iconImage: icon_off.png
iconExtraImage: 盘.png
iconExtraColor: #32FFFFFF
allowMultipleInQueue: false
highPriorityQueue: true

[action_switch2]
@copyFromSection: action_switch1
isVisible: if self.globalTeamTags(includes='盘虫-自动飞盘')
addGlobalTeamTags: NONE
removeGlobalTeamTags: 盘虫-自动飞盘
id: ${section.text}2
iconImage: icon_on.png
isGuiBlinking: true

[hiddenAction_自动飞盘]
autoTrigger: if self.globalTeamTags(includes='盘虫-自动飞盘') and self.energy(full=true) and distanceBetween(self, activeWaypointTarget)<=250 and self.hasActiveWaypoint(type='attack') and activeWaypointTarget.isAtGroundHeight
addResources: energy=-1
alsoTriggerOrQueueActionWithTarget: activeWaypointTarget
alsoTriggerAction: 飞盘执行



[action_Upgrade]
convertTo:电盘虫
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
price:腐蚀=175
text:腐蚀 - 缠雷
displayType:upgrade
buildSpeed:18.5s
pos:1
description:-大范围连锁电击\n-拥有电磁护盾\n-对建筑物伤害降低\n-血量下降&移速上升
descriptionAddUnitStats: ${section.convertTo}
iconExtraImage:SHARED:icon_upgrade_top.png
iconExtraColor:#AAFFFFFF
tags=腐蚀
setUnitMemory: 属性[24]=0
isLocked: if self.globalTeamTags(includes='中刻{I}')
isLockedMessage: AI:停用低级腐蚀

[action_Upgrade2]
convertTo:角盘虫
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
price:腐蚀=400
text:腐蚀 - 犀角
displayType:upgrade
buildSpeed:29.8s
pos:1
description:-强力冲锋\n-极高的血量\n-跨越山岭
descriptionAddUnitStats: ${section.convertTo}
iconExtraImage:SHARED:icon_upgrade_top.png
iconExtraColor:#AAFFFFFF
tags=腐蚀
setUnitMemory: 属性[24]=0

[hiddenAction_腐蚀中]
autoTrigger: if self.queueSize(withActionTag="腐蚀")>0 and not self.tags(includes='腐蚀中')
setUnitMemory: 属性[24]=-${movement.moveSpeed}*0.6
alsoTriggerAction: 属性变化
temporarilyAddTags: 腐蚀中

[hiddenAction_腐蚀停止]
autoTrigger: if self.queueSize(withActionTag="腐蚀")<1 and self.tags(includes='腐蚀中')
setUnitMemory: 属性[24]=0
alsoTriggerAction: 属性变化
temporarilyRemoveTags: 腐蚀中

[hiddenAction_自动腐蚀]
autoTrigger: if (self.hasUnitInTeam(withTag="腐蚀-电盘虫") and self.hasUnitInTeam(withTag="腐蚀之意")) and self.hasResources(${action_Upgrade.price}) and self.queueSize(empty=true) and not self.isAttacking
alsoQueueAction: Upgrade
addResourcesWithLogic: ${action_Upgrade.price}*-1

[hiddenAction_自动腐蚀2]
autoTrigger: if (self.hasUnitInTeam(withTag="腐蚀-角盘虫") and self.hasUnitInTeam(withTag="腐蚀之意")) and self.hasResources(${action_Upgrade2.price}) and self.queueSize(empty=true) and not self.isAttacking
alsoQueueAction: Upgrade2
addResourcesWithLogic: ${action_Upgrade2.price}*-1

[graphics]
image:大盘虫耶.png
scaleImagesTo:50
splastEffect:true
image_turret:无h.png
image_shadow: AUTO_ANIMATED
shadowOffsetX:1
shadowOffsetY:1
lock_body_rotation_with_main_turret:true
total_frames:4
animation_moving_start:0
animation_moving_end:3
animation_moving_speed:4

[attack]
canAttack:true
canAttackFlyingUnits:false
canAttackLandUnits:true
canAttackUnderwaterUnits:false
maxAttackRange:15
shootDelay:60

isMelee:true
meleeEngangementDistance: 150

isFixedFiring:true
aimOffsetSpread:0

[turret_1]
recoilOffset:8
recoilOutTime:5
recoilReturnTime:0.6s
x:0
y:0
invisible:false
projectile:1
canAttackMaxAngle: 10
shoot_sound:NONE
shoot_sound_vol:0
shoot_flame:NONE
shoot_light:#FFEECCCC
onShoot_triggerActions: AIattack确认

[projectile_1]
tags= T-projectile
directDamage: 65
areaDamage: 65
areaRadius: 30
areaRadiusFromEdge: true
#areaDamage:120
#areaRadius:55
#areaDamageNoFalloff:true
#areaRadiusFromEdge: true
largeHitEffect:true
life:60
speed:3
frame:1
drawSize:1
instant:true

[turret_skill]
x: 0
y: 0
invisible: true
canShoot: false
limitingRange: 9999

[projectile_null]
tags= T-projectile
areaDamage: 0
areaRadius: 0
invisible: true
life: 0
speed: 0
deflectionPower: -1
explodeEffect: NONE

[projectile_2]
directDamage: 40
areaDamage: 0
areaRadius: 25

largeHitEffect: true

trailEffect: 旋转影
trailEffectRate: 2

effectOnCreate: 碰撞飞盘

life: 200
speed: 7
targetSpeed: 5
targetSpeedAcceleration: 0.4

deflectionPower: 1

drawSize: 0.0

lightColor: #ffffcc
lightSize: 0.5

spawnProjectilesOnExplode: 3

[projectile_3]
@copyFromSection:projectile_2
pushForce: 8
pushVelocity: 2
retargetingInFlight: true
spawnProjectilesOnExplode: NONE

[effect_旋转影]
priority:verylow

image: 盘.png
life: 40
fadeOut: true
attachedToUnit: false
scaleFrom: 0.65
scaleTo: 0.65
alpha: 0.6
dirSpeed: -5
drawUnderUnits:false

[effect_碰撞飞盘]
priority:veryhigh

image: 盘.png
life: 200
fadeOut: false
attachedToUnit: true
scaleFrom: 0.65
scaleTo: 0.65
alpha: 1.0
dirSpeed: -5
drawUnderUnits:false
liveAfterAttachedDies: false

[movement]
movementType: LAND
moveSpeed: 0.9

moveAccelerationSpeed: 0.1
moveDecelerationSpeed: 0.03

maxTurnSpeed: 2.5
turnAcceleration: 0.7

reverseSpeedPercentage: 0

moveSlidingMode :true
moveIgnoringBody:true
moveSlidingDir:  45

[hiddenAction_AIupgrade]
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.queueSize(empty=true) and self.hasResources(腐蚀=200) and not self.globalTeamTags(includes='中刻{I}')
alsoQueueAction: Upgrade
addResources: 腐蚀=-200

[hiddenAction_AIGather]
addWaypoint_type: guard
addWaypoint_prepend: true
addWaypoint_maxTime: 5s
addWaypoint_target_nearestUnit_tagged: 基地
addWaypoint_target_nearestUnit_team: own
autoTrigger: if self.globalTeamTags(includes='AI系统') and not self.hasActiveWaypoint(type='guard') and not self.globalTeamTags(includes='中刻{I}')

[hiddenAction_AImoveattack]
clearAllWaypoints: true
addWaypoint_type: follow
addWaypoint_prepend: true
addWaypoint_maxTime: 20s
addWaypoint_target_nearestUnit_tagged: 基地
addWaypoint_target_nearestUnit_team: enemy
addWaypoint_target_mapMustBeReachable: true
autoTrigger: if self.globalTeamTags(includes='AI系统') and not self.isAttacking() and self.globalTeamTags(includes='中刻{I}') and not self.hasActiveWaypoint(type='follow')

[hiddenAction_AI攻击计时重置]
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.globalTeamTags(includes='开端{I}') and not self.hasActiveWaypoint(type='follow') and self.hasActiveWaypoint(type='attackMove') and self.isAttacking and self.customTimer(laterThanSeconds=10)
resetCustomTimer: true

[hiddenAction_AIinvalidattack]
@copyFromSection: hiddenAction_AImoveattack
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.globalTeamTags(includes='中刻{I}') and not self.hasActiveWaypoint(type='follow') and self.hasActiveWaypoint(type='attackMove') and self.isAttacking and self.customTimer(laterThanSeconds=8)
resetCustomTimer: true
temporarilyAddTags: 无效攻击

[hiddenAction_AIInvalidrecovery]
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.globalTeamTags(includes='中刻{I}') and self.hasActiveWaypoint(type='follow') and self.customTimer(laterThanSeconds=6)
temporarilyRemoveTags: 无效攻击

[hiddenAction_AIattack]
autoTrigger: if self.globalTeamTags(includes='AI系统') and numberOfUnitsInEnemyTeam(withinRange=300, greaterThan=0) and (self.hasActiveWaypoint(type='follow') or self.hasActiveWaypoint(type='attack')) and self.customTimer(laterThanSeconds=3) and not self.tags(includes='无效攻击')
clearAllWaypoints: true
addWaypoint_type: attackMove
addWaypoint_prepend: true
addWaypoint_maxTime: 20s
addWaypoint_target_nearestUnit_tagged: 基地
addWaypoint_target_nearestUnit_team: enemy
addWaypoint_target_mapMustBeReachable: true
resetCustomTimer:true

[hiddenAction_AI指定攻击]
addWaypoint_type: attack
addWaypoint_prepend: true
addWaypoint_maxTime: 20s
addWaypoint_target_mapMustBeReachable: true
addWaypoint_target_nearestUnit_tagged: 中心防御对地, T3机枪, 电机枪塔, 地震塔T2, 赤星塔
addWaypoint_target_nearestUnit_team: enemy
addWaypoint_target_nearestUnit_maxRange: 200
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.globalTeamTags(includes='中刻{I}')

[hiddenAction_AIattack侦测]
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.customTimer(laterThanSeconds=0.5, withinSeconds=1.5) and not self.isAttacking() and not self.tags(includes='无效攻击')
alsoTriggerAction: AImoveattack

[hiddenAction_AIattack确认]
resetCustomTimer: true