
[core]
name: 恶魔战士
displayText: 恶魔战士
displayDescription: -争守地脉资源的地狱恶魔 \n -重斧对建筑伤害加倍 \n -无视地形
price: 7000
maxHp: 3300
mass: 20000

maxShield: 100
shieldRegen: 0

tags: units, 恐虐
createOnAggressiveTeam: true

armour: 6
armourMinDamageToKeep: 6

fogOfWarSightRange: 18

techLevel: 2
buildSpeed: 21s

radius: 23
#displayRadius: 27
softCollisionOnAll: 14

isBio: true

selfRegenRate: 0

transportSlotsNeeded: 2

energyMax: 1
energyRegen: 0.003

autoTriggerCooldownTime: 0.1s

[hiddenAction_summon]
autoTriggerOnEvent: completeAndActive
spawnEffects: CUSTOM:红光, CUSTOM:红光波, CUSTOM:红雾*3


[hiddenAction_游荡]
autoTrigger: if not self.isMoving and (rnd(0, 100)<1 or numberOfUnitsInEnemyTeam(withinRange=400)>0)
addWaypoint_type: attackMove
addWaypoint_position_randomOffsetFromSelf: 100, 100
addWaypoint_target_mapMustBeReachable: true
addWaypoint_maxTime: 5s

[hiddenAction_反击]
autoTriggerOnEvent: tookDamage
requireConditional: if not self.hasActiveWaypoint(type='attack') and not self.hasActiveWaypoint(type='attackMove') and numberOfUnitsInEnemyTeam(withinRange=500)>0 and eventSource.maxHp>5
addWaypoint_type: attack
addWaypoint_target_fromReference: eventSource
addWaypoint_target_mapMustBeReachable: true
addWaypoint_maxTime: 3s

[hiddenAction_回走]
autoTrigger: if distanceBetween(self, customTarget1) > 100 and not self.isAttacking and self.hasTakenDamage>2 or distanceBetween(self, customTarget1) > 500
addWaypoint_type: touchTarget
clearAllWaypoints: true
addWaypoint_prepend: true
addWaypoint_target_fromReference: customTarget1
addWaypoint_target_nearestUnit_team: any
addWaypoint_target_mapMustBeReachable: false
addWaypoint_maxTime: 1s
addResources: shield=100

[hiddenAction_脱战护盾]
autoTrigger: if not self.isAttacking
addResources: shield=100


[graphics]
total_frames: 1
image:       恐虐星际战士身.png
image_wreak: NONE
image_turret: NONE
image_shield: red_shield.png

image_shadow: AUTO
shadowOffsetX:2
shadowOffsetY:2
showShieldBar: false

lock_body_rotation_with_main_turret: true
lock_leg_rotation_with_main_turret: true

[animation_move]
KeyframeTimeScale : 1.1
onActions: move
blendIn : 0s
blendOut : 0s

arm1_0.5s: {x:0, y:0, dir:2.5}
arm1_0.9s: {x:0, y:0, dir:0}
arm1_1.4s: {x:0, y:0, dir:-2.5}
arm1_1.8s: {x:0, y:0, dir:0}

arm2_0.5s: {x:-0, y:0, dir:2.5}
arm2_0.9s: {x:0, y:0, dir:0}
arm2_1.4s: {x:-0, y:0, dir:-2.5}
arm2_1.8s: {x:0, y:0, dir:0}

[animation_1]
arm1_0s: {x:0, y:0, dir:0}
arm1_0.2s: {x:0, y:-3, dir:-25}
arm1_0.35s: {x:0, y:-3, dir:-25}
arm1_0.45s: {x:0, y:6, dir:40}
arm1_0.7s: {x:0, y:0, dir:0}

[animation_2]
arm1_0s: {x:0, y:0, dir:0}
arm1_0.2s: {x:0, y:-3, dir:15}
arm1_0.3s: {x:0, y:-3, dir:15}
arm1_0.5s: {x:0, y:0, dir:0}

arm2_0s: {x:0, y:0, dir:0}
arm2_0.4s: {x:0, y:-1, dir:100}
arm2_0.5s: {x:-5, y:10, dir:-65}
arm2_0.8s: {x:0, y:0, dir:0}

[arm_1]
x: -16
y: 0
image_end: 恐虐星际战士左手.png
drawOverBody: false
moveSpeed: 18

[arm_2]
x: 16
y: 0
image_end: 恐虐星际战士右手斧.png
drawOverBody: false
moveSpeed: 18

[attack]
canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits:   true
canAttackUnderwaterUnits: false

turretSize: 20
turretTurnSpeed: 3.0

maxAttackRange: 250
shootDelay: 60

isMelee: true
attackMovement: bomber

[turret_1]
#主体
x: 0
y: 0
idleDir:0

turnSpeed: 5.1
turnSpeedAcceleration: 0.5

canShoot: false

recoilOffset: 1

[turret_2]
x: 0
y: 0
attachedTo: 1
slave: true

canAttackFlyingUnits: false

limitingRange: 60
canAttackMaxAngle: 10

projectile: 1

onShoot_playAnimation: 2

[turret_3]
x: 0
y: 0
attachedTo: 1
slave: true

delay: 2s
barrelX: -15

shoot_flame: 聚炎波, 聚炎光
shoot_light: #FF0000

canAttackCondition: if distanceBetween(self, attacking) > 60 or attacking.isFlying
canAttackMaxAngle: 30

projectile: 2滞

onShoot_playAnimation: 1

[projectile_1]
tags= T-projectile
life: 50
instant: true
invisible: true
delayedStartTimer: 30
areaDamage: 200
areaRadius: 60
areaExpandTime: 10
areaRadiusFromEdge: true

buildingDamageMultiplier: 2
mutatorX_ifUnitWithTags: 墙
mutatorX_areaDamageMultiplier: 2

explodeEffect: 刀光, 斩雾, 斩冲波, 斩赤爆, 斩红光, displacement
explodeEffectOnShield: 刀光, 斩雾, 红光波, 斩冲波, 斩红光, displacement


[projectile_2滞]
tags= T-projectile
areaDamage: 0
areaRadius: 0
life: 25
speed: 0
invisible: true
deflectionPower: -1
explodeOnEndOfLife: true
spawnProjectilesOnEndOfLife: 2
disableLeadTargeting: true
explodeEffect: 炎光无随, 火散*3
explodeEffectOnShield: 炎光无随, 火散*3

[projectile_2]
tags= T-projectile
areaHitAirAndLandAtSameTime: true
directDamage: 100
areaDamage: 100
areaRadius: 40
areaDamageNoFalloff: true

mutatorX_ifUnitWithTags: 墙
mutatorX_directDamageMultiplier: 3
mutatorX_areaDamageMultiplier: 3

deflectionPower: 4

life: 999
speed: 5
targetSpeed: 10
targetSpeedAcceleration: 0.02

drawSize: 0.95
frame: 9
lightColor: #ff0000
lightSize: 0.8
initialUnguidedSpeedHeight: 1
gravity: 0.12
trailEffect: CUSTOM:炎烟
trailEffectRate: 2
effectOnCreate: CUSTOM:火光, CUSTOM:炎放波, CUSTOM:炎释
explodeEffect: CUSTOM:炎爆, CUSTOM:炎火波, CUSTOM:炎光, CUSTOM:火散*5, CUSTOM:炎风
explodeEffectOnShield: CUSTOM:炎爆, CUSTOM:炎火波, CUSTOM:炎光, CUSTOM:火散*5, CUSTOM:炎风



[effect_刀光]
priority: veryhigh
image: 银刀光.png
life: 40
fadeOut: true
fadeInTime: 3
attachedToUnit: false
scaleFrom: 0.4
scaleTo: 0.6
alpha: 1.0
color: #FF0000
drawUnderUnits: false
dirOffset: -25
xOffsetRelative: 5
yOffsetRelative: -15
ySpeedRelative: 0.4
alsoPlaySound: Break.ogg:0.3

[effect_displacement]
drawType: displacement

priority: veryhigh
image: SHARED:shockwave_normal_128.png
life: 30
fadeOut: true

attachedToUnit: false
color: #FFFFFF
scaleFrom: 0
scaleTo: 1.5
alpha: 0.1
drawUnderUnits:false

dirOffsetRandom: 180
dirSpeed: 1

[effect_斩雾]
priority: veryhigh
image: fog.png
life: 40
fadeOut: true
fadeInTime: 10
attachedToUnit: true
color: #ff0000
scaleFrom: 0.0
scaleTo: 2
alpha: 0.3
drawUnderUnits:false
dirSpeedRandom:0.3
dirOffsetRandom:180

[effect_斩冲波]
priority: high
stripIndex: shockwave_large
life: 30
alpha: 0.8
scaleFrom: 0
scaleTo: 1.2
color: #ff0000

[effect_斩赤爆]
priority: veryhigh
life: 30
attachedToUnit: false
image: 白爆.png
scaleFrom: 1.2
scaleTo: 1.2
alpha: 0.8
color: #FF0000
total_frames: 14
animateFrameStart: 0
animateFrameEnd: 13
animateFrameSpeed: 0.5
fadeOut: false
alsoPlaySound: buiding_explode:0.7

[effect_斩红光]
priority: veryhigh
life: 40
alpha: 1
fadeInTime: 3
scaleFrom: 0.1
scaleTo: 2
image: SHARED:light_50.png
color: #ff0000



[effect_聚炎波]
priority: high
stripIndex: shockwave_large
life: 25
fadeInTime: 25
scaleFrom: 0.6
scaleTo: 0.1
alpha: 1
color: #ff0000

[effect_聚炎光]
priority: high
stripIndex: light_50
life: 25
fadeInTime: 25
scaleFrom: 0.5
scaleTo: 0.5
alpha: 0.8
color: #ff0000

[effect_炎烟]
priority: veryhigh
image: SHARED:light_50.png
life: 20
fadeOut: true
attachedToUnit: false
color: #FF3A28
fadeInTime:2
scaleFrom: 0.5
scaleTo: 0.5
alpha: 0.6
drawUnderUnits: false
atmospheric: true
xSpeedAbsoluteRandom: 0.2
ySpeedAbsoluteRandom: 0.2

[effect_火光]
priority: veryhigh
image: SHARED:light_50.png
life: 100
fadeOut: true
attachedToUnit: true
color: #FF3A28
fadeInTime:2
scaleFrom: 1
scaleTo: 1
alpha: 0.6
drawUnderUnits: false
liveAfterAttachedDies: false

[effect_炎爆]
priority: veryhigh
life: 30
scaleFrom: 1
scaleTo: 5
color: #FF3A28
alpha: 0.8

image: ice1.png
total_frames: 13
animateFrameStart: 0
animateFrameEnd: 13
animateFramePingPong: false
animateFrameSpeed: 0.5
alsoPlaySound: missile_hit

[effect_炎火波]
priority: veryhigh
stripIndex: shockwave_large
life: 25
scaleFrom: 0
scaleTo: 0.8
alpha: 1
color: #ff0000

[effect_炎光]
priority: veryhigh
attachedToUnit: true
life: 30
alpha: 1
scaleFrom: 0.6
scaleTo: 1
image: SHARED:light_50.png
color: #FF3A28
drawUnderUnits: false

[effect_炎光无随]
@copyFromSection: effect_炎光
attachedToUnit: false

[effect_火散]
priority: veryhigh
life: 40
alpha: 0.8
scaleFrom: 1
scaleTo: 1
stripIndex: fire
drawUnderUnits: false
atmospheric: true
attachedToUnit: false
xSpeedRelativeRandom: 1.6
ySpeedRelativeRandom: 1.6

[effect_炎放波]
@copyFromSection: effect_炎火波
life: 25
scaleTo: 1
alpha: 0.8
color: #FF3A28

[effect_炎风]
@copyFromSection: effect_炎放波
image: disturbance.png

[effect_炎释]
@copyFromSection: effect_炎火波
life: 10
scaleFrom: 1
scaleTo: 0
alpha: 0.8
color: #FF3A28



[effect_红光]
priority: veryhigh
attachedToUnit: true
life: 50
alpha: 1
scaleFrom: 2
scaleTo: 0.5
image: SHARED:light_50.png
color: #ff0000
drawUnderUnits: false

[effect_红光波]
priority: high
stripIndex: shockwave
life: 50
alpha: 0.8
scaleFrom: 0
scaleTo: 1.5
color: #ff0000

[effect_红雾]
priority: high
stripIndex: effects
life: 70
fadeOut: true
attachedToUnit: false
color: #ff0000
fadeInTime: 5
scaleFrom: 0.5
scaleTo: 1.5
alpha: 1
drawUnderUnits:false

atmospheric: true
hSpeed: 1
hOffsetRandom: 0.75
dirOffsetRandom: 180
xSpeedAbsoluteRandom: 3
ySpeedAbsoluteRandom: 3


[movement]
movementType: AIR
moveSpeed: 1
moveAccelerationSpeed: 0.06
moveDecelerationSpeed: 0.06

reverseSpeedPercentage: 1.0

maxTurnSpeed: 4.1
turnAcceleration: 0.15

targetHeight: 0
targetHeightDrift: 0

moveSlidingMode :true
moveIgnoringBody:true