
[core]
dont_load: true

name: 贝露天束模块[满月]
displayText: 贝露天束模块
copyFrom: common_slot.ini

displayDescription: -激光射束模块 \n -以日月之射束攻击敌军 \n -日月轮换:在不同主模块领域中会切换日光灼烧塔或月影监察者的射束攻击 \n -在日月领域切换时释放大范围日&月塔喷发效果 \n -每1能源供应提供10攻击范围加成(范围上限:330, 基础:280) \n -附加的天束模块越多造价越高 \n -满月形态攻击回复血量但无特殊效果

price: 3000

energyMax: 6
energyRegen: -1
energyStartingPercentage: 0

tags: units, 贝露模块, 日月天束模块, 日月模块完成, 贝露中心单位

[action_权能升级]
textAddUnitName: ${section.convertTo}
descriptionAddFromUnit: ${section.convertTo}
descriptionAddUnitStats: ${section.convertTo}
isActive: if self.queueSize(empty=true)
buildSpeed: 300s
convertTo: 碎质合成
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
price: 苍蓝能量=35
setUnitMemory: 属性[20]=0, 属性[19]=0

iconExtraImage: icon_upgrade_top.png
iconExtraColor: #AAFFFFFF

[hiddenAction_日月交替]
autoTrigger: if parent.tags(includes="日耀T1") or parent.tags(includes="日耀T2") or parent.tags(includes="日耀T3")
convertTo: 贝露天束模块[日]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
setUnitMemory: 属性[20]=0, 属性[19]=0

[hiddenAction_满月转化]
autoTrigger: if not parent.tags(includes="月曜T3")
convertTo: 贝露天束模块[月]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
setUnitMemory: 属性[20]=0

[hiddenAction_月曜无效]
autoTrigger: true
setResourcesWithLogic: 月曜T1攻速=0.01, 月曜T2攻速=0.01


[action_reclaim]
description: -为另一种模块腾出空槽 \n -返还%{${core.price * 0.5} * parent.numberOfAttachedUnits(withTag="日月模块完成")}资金 \n -返还价值随数量变动
addResources: 0
addResourcesWithLogic: credits=${core.price * 0.5} * parent.numberOfAttachedUnits(withTag="日月模块完成")

[action_destroy]
description: -立即破坏此模块 \n -为另一种模块腾出空槽 \n -仅返还%{${core.price * 0.05} * parent.numberOfAttachedUnits(withTag="日月模块完成")}资金 \n -返还价值随数量变动
addResources: 0
addResourcesWithLogic: credits=${core.price * 0.05} * parent.numberOfAttachedUnits(withTag="日月模块完成")


[hiddenAction_满月回复]
takeResources: hp=-5
takeResources_includeParent: true
takeResources_discardCollected: true

[attack]
canAttack: true
canAttackFlyingUnits: if parent.tags(includes="月曜T1") or parent.tags(includes="月曜T2") or parent.tags(includes="月曜T3")
canAttackLandUnits: if parent.tags(includes="月曜T1") or parent.tags(includes="月曜T2") or parent.tags(includes="月曜T3")
canAttackUnderwaterUnits: false
maxAttackRange: 200
shootDelay: 5
aimOffsetSpread: 0
turretSize: 0

[turret_0]
x: 0
y: 50
canShoot: false
turnSpeed: 10

[turret_1.0]
x: 0
y: 0
attachedTo: 0
slave: true
shoot_flame: CUSTOM:满星低透明, CUSTOM:conceptshield低透明, CUSTOM:projectileLight

projectile: 1.0
onShoot_triggerActions: 满月回复

[hiddenAction_供应加成]
autoTrigger: if self.resource(type="能源供应", greaterThan=0) and memory.属性[20]!=min(self.resource.能源供应*10, 50)
setUnitMemory: 属性[20]=min(self.resource.能源供应*10, 50)
alsoTriggerAction: 属性变化

[hiddenAction_失去供应]
autoTrigger: if self.resource(type="能源供应", lessThan=1) and memory.属性[20]>0
setUnitMemory: 属性[20]=0
alsoTriggerAction: 属性变化


[projectile_1.0]
tags= T-projectile
life: 20
instant: true
instantReuseLast: true
instantReuseLast_alsoChangeTurretAim: true
moveWithParent: true
beamImage:      SHARED:beam3.png
beamImageEnd:   SHARED:beam1_end.png
beamImageStart: SHARED:beam1_start.png
beamImageOffsetRate: -1.5
sweepOffsetFromTargetRadius: 0.2
sweepSpeed: 20
explodeEffect: CUSTOM:满星, CUSTOM:conceptshield, CUSTOM:projectileLight
explodeEffectOnShield: CUSTOM:满星, CUSTOM:conceptshield

directDamage: 8
areaDamage: 8
areaRadius: 35
color: #FFFFCC

[effect_满星]
image: ROOT:/素材/白星.png
life: 20
scaleFrom: 0.5
scaleTo: 0.5
alpha: 0.5
color: #FFFFCC
alsoPlaySound: laser_deflect

[effect_conceptshield]
image: 满月环.png
life: 20
scaleFrom: 0.3
scaleTo: 0.3
alpha: 0.5

[effect_projectileLight]
priority:veryhigh
image: SHARED:light_50.png
life: 40
fadeOut: true
attachedToUnit: true
color: #FFFFCC
fadeInTime:2
scaleFrom: 1
scaleTo: 1
alpha: 0.3
drawUnderUnits:false
liveAfterAttachedDies: false

[effect_满星低透明]
@copyFromSection: effect_满星
alpha: 0.25

[effect_conceptshield低透明]
@copyFromSection: effect_conceptshield
alpha: 0.25

[graphics]
image: 苍影日月塔.png


