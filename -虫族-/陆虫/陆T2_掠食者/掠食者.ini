
[core]
name: 掠食者
displayDescription: -释放魔弹珠 \n -攻击地面与空中 \n -对地开火需要消耗能量 \n “优秀的猎手会将代价降到最低”
class: CustomUnitMetadata
price: 6500
maxHp: 1500
mass: 12000

techLevel: 2
buildSpeed: 33.3s

fogOfWarSightRange:16

#generation_credits: 1
#generation_delay: 40

radius: 17
displayRadius: 17

isBio: true
isBug: true
tags: units, 虫族, 中型虫+, 掠食者, 固定射击

selfRegenRate:0.2

softCollisionOnAll: 12

energyMax: 4
energyRegen: 0.02
energyNeedsToRechargeToFull: true

overrideAndReplace: bugRangedT2

autoTriggerCooldownTime: 0.1s

[action_Upgrade]
convertTo:顶级掠食者
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
price:腐蚀=800
text:腐蚀 - 雷电
displayType:upgrade
buildSpeed:33.3s
pos:1
tags=腐蚀
setUnitMemory: 属性[24]=0
description:-魔弹激光变为破盾闪电\n-形成电磁防护\n-视野提升\n-再生↑up
descriptionAddUnitStats: ${section.convertTo}
iconExtraImage:SHARED:icon_upgrade_top.png
iconExtraColor:#AAFFFFFF
isLocked: if self.globalTeamTags(includes='中刻{I}')
isLockedMessage: AI:停用低级腐蚀

[action_Upgrade2]
convertTo:破滅者
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
price:腐蚀=800
text:腐蚀 - 爆裂
displayType:upgrade
buildSpeed:33.3s
pos:2
tags=腐蚀
setUnitMemory: 属性[24]=0
description:-发动重力打击\n-残留危险爆核\n-不可对空攻击了\n-视野提升\n-对建筑伤害提升&对护盾伤害降低
descriptionAddUnitStats: ${section.convertTo}
iconExtraImage:SHARED:icon_upgrade_top.png
iconExtraColor:#AAFFFFFF
isLocked: if self.globalTeamTags(includes='中刻{I}')
isLockedMessage: AI:停用低级腐蚀

[hiddenAction_腐蚀中]
autoTrigger: if self.queueSize(withActionTag="腐蚀")>0 and not self.tags(includes='腐蚀中')
setUnitMemory: 属性[24]=-${movement.moveSpeed}*0.6
alsoTriggerAction: 属性变化
temporarilyAddTags: 腐蚀中

[hiddenAction_腐蚀停止]
autoTrigger: if self.queueSize(withActionTag="腐蚀")<1 and self.tags(includes='腐蚀中')
setUnitMemory: 属性[24]=0
alsoTriggerAction: 属性变化
temporarilyRemoveTags: 腐蚀中

[hiddenAction_自动腐蚀]
autoTrigger: if (self.hasUnitInTeam(withTag="腐蚀-顶级掠食者") and self.hasUnitInTeam(withTag="腐蚀之意")) and self.hasResources(${action_Upgrade.price}) and self.queueSize(empty=true) and not self.isAttacking
alsoQueueAction: Upgrade
addResourcesWithLogic: ${action_Upgrade.price}*-1

[hiddenAction_自动腐蚀2]
autoTrigger: if (self.hasUnitInTeam(withTag="腐蚀-破滅者") and self.hasUnitInTeam(withTag="腐蚀之意")) and self.hasResources(${action_Upgrade2.price}) and self.queueSize(empty=true) and not self.isAttacking
alsoQueueAction: Upgrade2
addResourcesWithLogic: ${action_Upgrade2.price}*-1



[action_energyRegen]
isActive: false
isGuiBlinking: if self.hp(full=true)
autoTrigger: if self.hp(full=true)
addResourcesWithLogic: energy=0.1 * select(self.hasParent(withTag="池虫"), 2.5, 0)
id: ${section.text}
text: 袭掠
description: -当血量为满时,能量加倍恢复
displayType: infoOnly
buildSpeed: 0
pos: 0.1

[hiddenAction_池虫能量]
autoTrigger: if self.hasParent(withTag="池虫")
addResources: energy=0.18

[graphics]
total_frames: 1

image:        掠食者.png
image_wreak:  NONE
image_turret: NONE

#AUTO
image_shadow: AUTO
shadowOffsetX:2
shadowOffsetY:2

lock_body_rotation_with_main_turret: true

animation_moving_start: 0
animation_moving_end: 0
animation_moving_speed: 3

animation_idle_start: 0
animation_idle_end: 0
animation_idle_speed: 80
animation_idle_scale_start:1
animation_idle_scale_end:1.03
animation_idle_pingPong: true


animation_attack_start: 0
animation_attack_end: 0
animation_attack_speed: 15
animation_attack_scale_start:1
animation_attack_scale_end:0.97
animation_attack_pingPong: true

[attack]
canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits:   true
canAttackUnderwaterUnits: false

isFixedFiring: true

turretSize: 30
turretTurnSpeed: 9

maxAttackRange: 260
shootDelay: 15

[turret_base]
x: 0
y: 0
canShoot: false

recoilOffset: -1
recoilOutTime: 2
recoilReturnTime: 6

[turret_1]
x: 0
y: 0
attachedTo: base
slave: true

canAttackFlyingUnits: false
canAttackLandUnits: true

shoot_sound: plasma_fire
shoot_sound_vol: 0.2
shoot_light: #AAFF00

energyUsage: 1

[turret_2]
x: 0
y: 0
copyFrom: 1

canAttackFlyingUnits: true
canAttackLandUnits: false

energyUsage: 0

[projectile_1]
tags= T-projectile
directDamage: 50
life: 80
speed: 5
targetSpeed: 8

laserEffect: true

wobbleAmplitude: 2.5
wobbleFrequency: 2s

frame: 6

color: #AA73E600
lightColor: #73E600
lightSize: 0.6

deflectionPower: -1

explodeEffect: CUSTOM:explode, CUSTOM:shockwave

[effect_explode]
life: 25
fadeOut: false
attachedToUnit: false
image: explode_big2.png
scaleFrom: 0.9
scaleTo: 0.9
alpha: 1
total_frames: 14
animateFrameStart: 0
animateFrameEnd: 13
animateFrameSpeed: 0.5
alsoPlaySound: missile_hit:0.5

[effect_shockwave]
stripIndex: shockwave_large
life: 25
scaleFrom: 0
scaleTo: 0.75
alpha: 1
color: #B1FF99


[leg_1]
x: -25
y: -5
attach_x: 0
attach_y: 0
moveSpeed: 4.1
resetAngle:20


heightSpeed: 0.8

image_leg:  leg.png
image_foot: NONE

drawLegWhenZoomedOut: true

dust_effect: false

holdDisMin: 18
holdDisMax: 26

[leg_2]
x: 25
y: -5
attach_x: 0
attach_y: 0
copyFrom: 1

[leg_3]
x: -20
y: 10
attach_x: 0
attach_y: 2
copyFrom: 1

[leg_4]
x: 20
y: 10
attach_x: 0
attach_y: 2
copyFrom: 1

[leg_5]
x: -20
y: -20
attach_x: 0
attach_y: -2
copyFrom: 1

[leg_6]
x: 20
y: -20
attach_x: 0
attach_y: -2
copyFrom: 1




[movement]
movementType: OVER_CLIFF

moveSpeed: 1.0
moveAccelerationSpeed: 0.02
moveDecelerationSpeed: 0.06

maxTurnSpeed: 2.5
turnAcceleration: 0.5

targetHeight: 0
targetHeightDrift: 0

moveSlidingMode :true
moveIgnoringBody:true
moveSlidingDir:  181


[hiddenAction_AI走位]
clearActiveWaypoint: true
addWaypoint_type: move
addWaypoint_prepend: true
addWaypoint_maxTime: 3s
addWaypoint_target_fromReference: attachment.getOffsetRelative(y=-80)
alsoTriggerAction: AI随机侧移
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.isAttacking and numberOfUnitsInEnemyTeam(greaterThan=0, withinRange=${attack.maxAttackRange -5}, withTag='units') and attachment.isAttacking and (not self.hasActiveWaypoint(type='move') or distanceBetween(self, activeWaypointTarget) < 20)
[hiddenAction_AIclearWaypoints]
clearAllWaypoints: true
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.isAttacking and not numberOfUnitsInEnemyTeam(greaterThan=0, withinRange=${attack.maxAttackRange +1}, withTag='units') and self.hasActiveWaypoint(type='move')

[attachment_AI向定位]
x: 0
y: 0
onCreateSpawnUnitOf: AI单位向定位
alwaysAllowedToAttackParentsMainTarget: true

[hiddenAction_AI随机侧移]
requireConditional: if not attachment.getOffsetRelative(y=-40).isOverPassableTile(type='${movement.movementType}')
clearActiveWaypoint: true
addWaypoint_type: move
addWaypoint_prepend: true
addWaypoint_maxTime: 2s
addWaypoint_target_fromReference: attachment.getOffsetRelative(y=30, x=rnd(-200, 200))



[template_AI靠近目标]
clearAllWaypoints: true
addWaypoint_type: touchTarget
addWaypoint_prepend: true
addWaypoint_maxTime: 20s
addWaypoint_target_nearestUnit_tagged: 靠近单位
addWaypoint_target_nearestUnit_team: own

[hiddenAction_AI-撤退-优先级1]
@copyFromSection: template_AI靠近目标
addWaypoint_target_nearestUnit_tagged: 基地
autoTrigger: if self.globalTeamTags(includes='AI系统') and not self.hasActiveWaypoint(type='touchTarget') and self.tags(includes='AI撤退修复')
requireConditional: if not self.globalTeamTags(includes='AI有修复点') and not self.globalTeamTags(includes='AI有修复点T2')

[hiddenAction_AI-撤退-优先级2]
@copyFromSection: template_AI靠近目标
addWaypoint_target_nearestUnit_tagged: 修复点
autoTrigger: if self.globalTeamTags(includes='AI系统') and not self.hasActiveWaypoint(type='touchTarget') and self.tags(includes='AI撤退修复') and self.globalTeamTags(includes='AI有修复点')
requireConditional: if not self.globalTeamTags(includes='AI有修复点T2')

[hiddenAction_AI-撤退-优先级3]
@copyFromSection: template_AI靠近目标
addWaypoint_target_nearestUnit_tagged: 修复点T2
autoTrigger: if self.globalTeamTags(includes='AI系统') and not self.hasActiveWaypoint(type='touchTarget') and self.tags(includes='AI撤退修复') and self.globalTeamTags(includes='AI有修复点T2')

[hiddenAction_AIAddTags]
autoTrigger: if self.globalTeamTags(includes='AI系统') and (self.hp(lessThan=${core.maxHp*0.25})) and not self.tags(includes='AI撤退修复')
temporarilyAddTags: AI撤退修复
[hiddenAction_AIRemoveTags]
autoTrigger: if self.globalTeamTags(includes='AI系统') and (self.hp(full=true)) and self.tags(includes='AI撤退修复')
temporarilyRemoveTags: AI撤退修复

[hiddenAction_AI集群进攻]
addWaypoint_type: guard
addWaypoint_prepend: true
addWaypoint_maxTime: 20s
addWaypoint_target_nearestUnit_tagged: 电盘虫
addWaypoint_target_nearestUnit_team: own
autoTrigger: if self.globalTeamTags(includes='AI系统') and not self.hasActiveWaypoint(type='guard') and not self.isAttacking and self.globalTeamTags(includes='中刻{I}')