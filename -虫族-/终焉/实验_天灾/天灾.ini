
[core]
name: 天灾
displayText: 天灾
maxHp: 36000
mass: 270000
price: 225000

radius: 60
displayRadius: 65

armour: 30
armourMinDamageToKeep: 30

isBug: true
isBio: true
softCollisionOnAll: 22

experimental: true

selfRegenRate: 1
transportSlotsNeeded: 20

fogOfWarSightRange: 33

buildSpeed: 500s
displayDescription: -震撼大地的巨兽\n-坚不可摧的外壳\n-范围攻击地面\n-可释放特殊攻击\n-能越过水与山崖\n-减少来自远距离的攻击伤害

energyMax: 10
energyRegen: 0

tags: units, 虫族, 大型虫, 天灾

[hiddenAction_killed]
autoTriggerOnEvent: killedAnyUnit
requireConditional: if not eventSource.self.tags(includes="召唤物")
addResources: energy=1

[hiddenAction_每秒受伤]
autoTrigger: if self.customTimer(laterThanSeconds=1)
setResourcesWithLogic: 受到伤害=self.resource.当前血量-self.hp, 当前血量=self.hp, 受击前血量=self.hp
resetCustomTimer: true
alsoTriggerAction: 受击能量

[hiddenAction_受击能量]
requireConditional: if self.resource.受到伤害>200
addResourcesWithLogic: energy=self.resource.受到伤害/1000

[hiddenAction_2]
autoTrigger: if self.energy(full=true) and self.queueSize(empty=true)
alsoQueueAction: 1
addResources: energy=-10
convertTo: 天灾[战争践踏]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
convertTo_keepCurrentFields: maxHp, maxShield

[action_1]
isLocked: true
isLockedMessage: -能量为满则自动触发
price: energy=10
text: 战争践踏
description: -每次攻击或击杀敌人或受到大量伤害时获得能量 \n -攒满能量后开始蓄力 \n -期间减免伤害并高速自愈 \n -蓄力完成后对周围敌人造成大量伤害 \n -对建筑伤害提升50%
displayType: infoOnly
buildSpeed: 2s
fireTurretXAtGround_withProjectile: 3S
fireTurretXAtGround_withOffset: 0,0
fireTurretXAtGround: 3
convertTo: 天灾
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
convertTo_keepCurrentFields: maxHp, maxShield

spawnEffects: 尘*10, 裂痕, 光痕, 地坑, 地裂光, 震荡波, 颤动, 震动, 水波纹, ripples*3, largeRipples, spray*8

canPlayerCancel: false

[action_天灾坚甲]
isVisible: true
isActive: false
text: 天灾坚甲
description: -受到来自150距离以外的伤害时，每100距离减少20%伤害 \n -来自空中单位的伤害在150距离内也会减伤20% \n -最高减伤90%
pos: 2
displayType: infoOnly
buildSpeed: 0s


[hiddenAction_受损抵御]
autoTriggerOnEvent: tookDamage
requireConditional: if self.resource.受击前血量>self.hp and (distanceBetween(self, eventSource)>150 or eventSource.isFlying)
setResourcesWithLogic: hp=self.hp+( (self.resource.受击前血量-self.hp) * (0.2 + min( ( max( (distanceBetween(self, eventSource) -150), 0 ) * 0.002), 0.7 )) ), 受击前血量=self.hp

[resource_当前血量]
hidden: true

[resource_受到伤害]
displayName: 受到伤害

[resource_受击前血量]
hidden: true

[graphics]
image: 泯灭耶.png
image_turret: 不是空气.png

scaleImagesTo: 90
scaleTurretImagesTo: 60

teamColorsOnTurret: true

image_shadow: AUTO
shadowOffsetX: 5
shadowOffsetY: 5

showEnergyBar: false

[animation_1]
onActions: idle, move, attack
pingPong: true
scale_start: 1
scale_end: 1.02
speed: 70

[attack]
canAttack: true
canAttackFlyingUnits: false
canAttackLandUnits: true
canAttackUnderwaterUnits: false

turretSize: 40
turretTurnSpeed: 3

maxAttackRange: 40
shootDelay: 80

aimOffsetSpread: 0.4

isMelee: true

[turret_1]
#普通攻击
x: 0
y: 40
invisible: false
shoot_sound: large_gun_fire2
shoot_sound_vol: 0.4
projectile: 1
recoilOffset: 10
recoilOutTime: 2
recoilReturnTime: 10
resourceUsage: energy=-2

[projectile_1]
tags= T-projectile
areaDamage: 700
areaRadius: 60
areaDamageNoFalloff: true
largeHitEffect: true
life: 60
speed: 1
frame: 1
drawSize: 1
instant: true
spawnProjectilesOnExplode: 1V

[projectile_1V]
tags= T-projectile
areaDamage: 0
areaRadius: 60
pushVelocity: -3
life: 0
instant: true
invisible: true
explodeEffect: NONE
explodeEffectOnShield: NONE

[turret_3]
#战争践踏
x: 0
y: 0
size: 0
invisible: true
shoot_sound: large_gun_fire2
shoot_sound_vol: 1.0
canAttack: false
projectile: 3
shoot_light: #FFEECCCC
recoilOffset: 10
recoilOutTime: 2
recoilReturnTime: 10
limitingRange: 300

[projectile_3S]
tags= T-projectile
areaDamage: 1000
areaRadius: 45
areaDamageNoFalloff: true
areaHitUnderwaterAlways: true
pushVelocity: -3
life: 0
invisible: true
explodeOnEndOfLife: true
explodeEffect: NONE
explodeEffectOnShield: NONE

deflectionPower: -1
buildingDamageMultiplier: 1.5

spawnProjectilesOnExplode: 3*60, 3V

[projectile_3V]
tags= T-projectile
areaDamage: 10
areaRadius: 300
areaDamageNoFalloff: true
areaHitUnderwaterAlways: true
pushVelocity: -0.5
life: 0
invisible: true
explodeOnEndOfLife: true
explodeEffect: NONE
explodeEffectOnShield: NONE
buildingDamageMultiplier: 1.5

delayedStartTimer: 2
spawnProjectilesOnExplode: 3V(recursionLimit=10)


[projectile_3]
tags= T-projectile
areaDamage: 200
areaRadius: 60
areaExpandTime: 10
areaDamageNoFalloff: true
areaHitUnderwaterAlways: true
pushForce: -100
pushVelocity: -1.2
largeHitEffect: true
life: 15
speedSpread: 1.5
speed: 6
frame: 1
drawSize: 0.1
targetGroundSpread: 360
explodeOnEndOfLife: true

deflectionPower: -1

buildingDamageMultiplier: 1.5

spawnProjectilesOnExplode: 4(offsetRandomDir=15)

[projectile_4]
tags= T-projectile
areaDamage: 100
areaRadius: 40
areaExpandTime: 5
areaDamageNoFalloff: true
areaHitUnderwaterAlways: true
pushForce: -50
pushVelocity: -0.8
largeHitEffect: true
life: 10
speedSpread: 1.2
speed: 4.5
turnSpeed: 0
invisible: true
targetGroundSpread: 360
explodeOnEndOfLife: true

deflectionPower: -1

buildingDamageMultiplier: 1.5


[effect_尘]
stripIndex:dust
life: 100
fadeOut: true
attachedToUnit: false
color: #FFFFFF
fadeInTime: 5
scaleFrom: 3.0
scaleTo: 7.5
alpha: 0.9
drawUnderUnits:false
physics: true
physicsGravity: 0.4
hSpeed: 1.8
hSpeedRandom: 0.8
dirOffsetRandom:180
xOffsetRelativeRandom: 120
yOffsetRelativeRandom: 120
xSpeedRelativeRandom:0.3
ySpeedRelativeRandom:0.3
atmospheric: true
createWhenOverLiquid: false

[effect_裂痕]
priority: critical
alwayStartDirAtZero: true
life: 60
fadeOut: true
attachedToUnit: false
image: Fissure.png
scaleFrom: 2
scaleTo: 2
alpha: 0.6
drawUnderUnits: true
createWhenOverLiquid: false
alsoPlaySound: 地裂.ogg:0.5

[effect_光痕]
priority: critical
alwayStartDirAtZero: true
life: 25
fadeOut: true
attachedToUnit: false
image: VolcanicFissure.png
scaleFrom: 1
scaleTo: 1
alpha: 0.6
fadeInTime: 2
drawUnderUnits: true
createWhenOverLiquid: false

[effect_地坑]
priority: veryhigh
alwayStartDirAtZero: true
life: 180
fadeOut: true
attachedToUnit: false
image: Scorchmark.png
scaleFrom: 2.5
scaleTo: 2.5
alpha: 0.5
drawUnderUnits: true
createWhenOverLiquid: false

[effect_地裂光]
priority: high
image: SHARED:light_50.png
life: 17
fadeOut: true
attachedToUnit: false
color: #FFD329
scaleFrom: 10
scaleTo: 10
alpha: 0.6
drawUnderUnits: false


[effect_ripples]
priority: veryhigh
image: SHARED:ripple.png
life: 40
lifeRandom: 20

fadeOut: true
fadeInTime: 3

attachedToUnit: false
color: #FFFFFF
scaleFrom: 1
scaleTo: 4.8
alpha: 0.6
drawUnderUnits:false
createWhenOverLand: false

dirOffsetRandom: 180
dirSpeed: 0.5
dirSpeedRandom:0.5

delayedStartTimer: 5

[effect_largeRipples]
priority: critical
image: SHARED:ripple.png
life: 120

fadeOut: true
fadeInTime: 3

attachedToUnit: false
color: #FFFFFF
scaleFrom: 2
scaleTo: 6
alpha: 0.6
drawUnderUnits:false
createWhenOverLand: false

dirOffsetRandom: 180
dirSpeed: 0.5
dirSpeedRandom:0.5

delayedStartTimer: 5

[effect_spray]
priority: veryhigh
life:30
lifeRandom: 25
image:spray.png
scaleFrom: 1.0
scaleTo: 3.8
physics: true
physicsGravity: 0.4
alpha: 0.8
hSpeed: 1.8
hSpeedRandom: 0.8
ySpeedRelativeRandom: 0.4
xSpeedRelativeRandom: 0.4
xOffsetRelativeRandom: 120
yOffsetRelativeRandom: 120
createWhenOverLand: false
createWhenOverLiquid: true
imageShadow: SHADOW:spray.png
dirOffsetRandom: 180
attachedToUnit: false
drawUnderUnits: false
trailEffect:CUSTOM:spray2
trailEffectRate:2.0

[effect_spray2]
priority: veryhigh
life: 30
lifeRandom: 25
image:spray.png
scaleFrom: 1.0
scaleTo: 3.8
physics: true
physicsGravity: 0.4
alpha: 0.8
createWhenOverLand: false
createWhenOverLiquid: true
dirOffsetRandom: 180
attachedToUnit: false
drawUnderUnits:false


[effect_震荡波]
priority: critical
drawType: displacement

image: SHARED:shockwave_normal_128.png
life: 60
fadeOut: true
fadeInTime: 2

attachedToUnit: false
color: #FFFFFF
scaleFrom: 0
scaleTo: 6
alpha: 0.15
drawUnderUnits: true

dirOffsetRandom: 180
dirSpeedRandom: 1

[effect_水波纹]
priority: critical
drawType: displacement

image: SHARED:ripple_normal_128.png
life: 120
fadeOut: true
fadeInTime: 25

attachedToUnit: false
color: #FFFFFF
scaleFrom: 0
scaleTo: 5
alpha: 0.5
drawUnderUnits: true

dirOffsetRandom: 180
dirSpeed: 1

createWhenOverLand: false
alsoPlaySound: 震水.ogg

[effect_颤动]
priority: veryhigh
drawType: displacement

image: SHARED:cone_inverted_normal_128.png
life: 10
fadeOut: true

attachedToUnit: false
color: #FFFFFF
scaleFrom: 5
scaleTo: 5
alpha: 0.2
drawUnderUnits:false

dirOffsetRandom: 180
dirSpeedRandom: 1

[effect_震动]
priority: critical
drawType: displacement
image:what.png
life:20
fadeOut:true
attachedToUnit: true
scaleFrom:100
scaleTo:100
alpha:0.05
drawUnderUnits:false
alwayStartDirAtZero: true
total_frames: 2
animateFrameStart: 0
animateFrameEnd:1
animateFrameSpeed: 0.4
animateFrameLooping: true


[movement]
movementType: OVER_CLIFF_WATER
moveSpeed: 0.65
moveAccelerationSpeed: 0.1
moveDecelerationSpeed: 0.08
maxTurnSpeed: 1.1
turnAcceleration: 0.07


[leg_1]
x: 25
y: 50
moveSpeed: 2.5
moveWarmUp: 20
attach_x: 15
attach_y: 40
rotateSpeed: 30
heightSpeed: 1
resetAngle: 0.00000001
image_foot: 大胖的脚耶.png
image_leg: 我要大盘，我要大盘.png
image_end_teamColors: true
dust_effect: true
holdDisMin: 20
holdDisMax: 30
estimatingPositionMultiplier: 0.75
hold_moveOnlyIfFurthest: false
holdDisMin_checkNeighbours: true
favourOppositeSideNeighbours: true
hardLimit: 100
holdDisMin_maxMovingLegs: 7

[leg_2]
x: -25
y: 50
attach_x: -15
attach_y: 40
copyFrom: 1

[leg_3]
x: 25
y: -35
attach_x: 15
attach_y: -25
copyFrom: 1
moveWarmUp: 25

[leg_4]
x: -25
y: -35
attach_x: -15
attach_y: -25
copyFrom: 1
moveWarmUp: 25

[leg_5]
x: 35
y: 10
attach_x: 18
attach_y: 10
copyFrom: 1

[leg_6]
x: -35
y: 10
attach_x: -18
attach_y: 10
copyFrom: 1

[leg_7]
x: 15
y: -30
moveSpeed: 0.001
moveWarmUp: 1
attach_x: 5
attach_y: -30
rotateSpeed: 999
heightSpeed: 1
resetAngle: 0.00000001
image_leg: 大大疫吧.png
dust_effect: true
holdDisMin: 1
holdDisMax: 1
estimatingPositionMultiplier: 0.5

[leg_8]
x: -15
y: -30
attach_x: -5
attach_y: -30
copyFrom: 7

[leg_9]
x: 0
y: -40
attach_x: 0
attach_y: -35
copyFrom: 7
