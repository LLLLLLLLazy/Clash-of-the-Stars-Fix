
[core]
name:炮弹虫
displayText:炮弹虫
class: CustomUnitMetadata
price:350
maxHp:150
mass:1000

radius:10
selfRegenRate:0.06

softCollisionOnAll: 5

buildSpeed:3.3s

isBug:true
isBio:true

displayDescription: -攻击地面单位 \n -冲向目标并自爆 \n -死亡后爆炸

transportSlotsNeeded:1

tags: units, 虫族, 小型虫, 自爆虫, 炮弹虫, 开端辅虫, 固定射击

autoTriggerCooldownTime: 0.01s
autoTriggerCooldownTime_allowDangerousHighCPU: true

[action_Upgrade]
convertTo:布克布克
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
convertTo_keepCurrentFields: maxHp, maxShield
price:腐蚀=100
text:腐蚀 - 膨胀
displayType:upgrade
buildSpeed:15.2s
pos:-1
description:-强劲的爆炸\n-血量上升&移速下降\n-对建筑伤害-25%
descriptionAddUnitStats: ${section.convertTo}
iconExtraImage:SHARED:icon_upgrade_top.png
iconExtraColor:#AAFFFFFF
ai_isHighPriority: true
tags=腐蚀
setUnitMemory: 属性[24]=0

#[action_Upgrade2]
#convertTo:地雷
#price:腐蚀=15
#text:腐蚀 - 地爆
#displayType:upgrade
#buildSpeed:12.8s
#pos:-1
#description:-不会被敌人发现\n-无法移动
#iconExtraImage:SHARED:icon_upgrade_top.png
#iconExtraColor:#AAFFFFFF
#whenBuilding_cannotMove: true
#whenBuilding_rotateTo: 0
#whenBuilding_rotateTo_orBackwards: true


[hiddenAction_死亡爆炸]
autoTriggerOnEvent: destroyed
requireConditional: if not self.hasFlag(id=2)
fireTurretXAtGround: 2

[hiddenAction_空爆]
autoTriggerOnEvent: destroyed
requireConditional: if self.hasFlag(id=2)
fireTurretXAtGround: 3

[hiddenAction_运输结束]
autoTrigger: if self.hasFlag(id=2)
addResources: unsetFlag=2

[hiddenAction_危爆]
autoTrigger: if self.hasFlag(id=0)
setResourcesWithLogic: hp=-99999


[hiddenAction_sinking]
autoTrigger: if self.isOverwater and self.timeAlive(laterThanSeconds=1)
convertTo: 炮弹虫[沉]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
convertTo_keepCurrentFields: maxHp, maxShield

[hiddenAction_腐蚀中]
autoTrigger: if self.queueSize(withActionTag="腐蚀")>0 and not self.tags(includes='腐蚀中')
setUnitMemory: 属性[24]=-${movement.moveSpeed}*0.6
alsoTriggerAction: 属性变化
temporarilyAddTags: 腐蚀中

[hiddenAction_腐蚀停止]
autoTrigger: if self.queueSize(withActionTag="腐蚀")<1 and self.tags(includes='腐蚀中')
setUnitMemory: 属性[24]=0
alsoTriggerAction: 属性变化
temporarilyRemoveTags: 腐蚀中

[hiddenAction_自动腐蚀]
autoTrigger: if (self.hasUnitInTeam(withTag="腐蚀-布克布克") and self.hasUnitInTeam(withTag="腐蚀之意")) and self.hasResources(${action_Upgrade.price}) and self.queueSize(empty=true) and not self.isAttacking
alsoQueueAction: Upgrade
addResourcesWithLogic: ${action_Upgrade.price}*-1

[action_explode]
displayType: action

price: 0
id: ${section.text}
text: 自爆
pos: 1
buildSpeed: 0.8s
addResources: hp:-1000
allowMultipleInQueue: false
autoTrigger: if self.isOverLiquid and not self.isOverwater

[action_弱性融合]
isVisible: if self.hasFlag(id=3)
isActive: false
id: ${section.text}
text: 弱性融合
description: -由融合之卵产生 \n -血量低于25且未在战斗时爆炸
pos: 2
displayType: infoOnly
buildSpeed: 0s
autoTrigger: if self.hasFlag(id=3) and self.hp<25 and (not self.isAttacking or self.hasTakenDamage>10) and self.hasTakenDamage>1
spawnUnits: 炮弹虫(addResources=hp:-99999)
deleteSelf: true


[action_振奋]
isVisible: true
isActive: false
id: ${section.text}
text: 振奋
description: -300范围内有振奋类陆地虫受到伤害时移速+0.4 \n -持续2s
pos: 3
displayType: infoOnly
buildSpeed: 0s
iconImage: 振奋icon.png
isGuiBlinking: if self.hasFlag(id=4)

[hiddenAction_陆地振奋虫受伤]
autoTrigger: if self.hasTakenDamage<=2 and not self.hp(full=true) and not self.tags(includes='陆地振奋虫受伤')
temporarilyAddTags: 陆地振奋虫受伤

[hiddenAction_受伤结束]
autoTrigger: if self.tags(includes='陆地振奋虫受伤') and self.hasTakenDamage>2
temporarilyRemoveTags: 陆地振奋虫受伤

[hiddenAction_战斗加速]
autoTrigger: if numberOfUnitsInTeam(withTag='陆地振奋虫受伤', withinRange=300)>0 and not self.hasFlag(id=4)
setUnitMemory: 属性[24]=memory.属性[24]+0.4
alsoTriggerAction: 属性变化
addResources: setFlag=4

[hiddenAction_加速结束]
autoTrigger: if numberOfUnitsInTeam(withTag='陆地振奋虫受伤', withinRange=300)==0 and self.hasFlag(id=4)
setUnitMemory: 属性[24]=memory.属性[24]-0.4
alsoTriggerAction: 属性变化
addResources: unsetFlag=4



[hiddenAction_无延迟追击B]
@copyFromSection: template_无延迟追击B
[hiddenAction_无延迟追击B2]
@copyFromSection: template_无延迟追击B2


[action_扩散移动点开]
@copyFromSection: template_扩散移动点开

[action_扩散移动点关]
@copyFromSection: template_扩散移动点关

[hiddenAction_设置扩散移动点]
@copyFromSection: template_设置扩散移动点

[hiddenAction_清除当前非巡逻路径]
@copyFromSection: template_清除当前非巡逻路径

[hiddenAction_锁定扩散移动点]
@copyFromSection: template_锁定扩散移动点

[hiddenAction_执行扩散移动点]
@copyFromSection: template_执行扩散移动点

[graphics]
image:炸死你丫.png
image_turret:NONE
splastEffect:true
image_shadow:AUTO_ANIMATED
shadowOffsetX:1
shadowOffsetY:1

total_frames:5
animation_moving_start:0
animation_moving_end:2
animation_moving_speed:3
animation_moving_pingPong:true

animation_idle_start:0
animation_idle_end:0
animation_idle_speed:120
animation_idle_scale_start:1
animation_idle_scale_end:1.03
animation_idle_pingPong:true

animation_attack_start:2
animation_attack_end:4
animation_attack_speed:8

[attack]

isMelee: true
meleeEngangementDistance: 150

dieOnAttack: true

canAttack: true
canAttackFlyingUnits: false
canAttackLandUnits:   if self.queueSize(withActionTag="黯回之生", lessThan=1)
canAttackUnderwaterUnits: false

isFixedFiring: true

turretSize: 0
turretTurnSpeed: 3

maxAttackRange: 9
shootDelay: 0

[turret_1]
x:0
y:0
invisible:true
projectile:1
canAttackCondition: if attacking == activeWaypointTarget or not self.hasActiveWaypoint(type='attack') and not self.hasActiveWaypoint(type='move')

[projectile_1]
tags= T-projectile
areaDamage:0
areaRadius:0
life:50
instant:true
explodeEffect:NONE
explodeEffectOnShield:NONE

[turret_2]
x:0
y:0
warmup:30
invisible:true
projectile:explodeArea
canAttackCondition: if attacking == activeWaypointTarget or not self.hasActiveWaypoint(type='attack') and not self.hasActiveWaypoint(type='move')

[turret_3]
x:0
y:0
copyFrom:2
barrelHeight:35
canShoot:false

[projectile_explodeArea]
tags= T-projectile
#directDamage: 250
areaDamage: 200
areaRadius: 60
areaRadiusFromEdge: true

life: 0
invisible: true
explodeOnEndOfLife: true

#areaHitAirAndLandAtSameTime: true

[movement]
movementType: LAND
moveSpeed: 1.2
moveAccelerationSpeed: 0.1
moveDecelerationSpeed: 0.12
maxTurnSpeed: 5.4
turnAcceleration: 0.7

moveSlidingMode: true
moveIgnoringBody: true

[hiddenAction_AIloadInto]
addWaypoint_type: loadInto
addWaypoint_prepend: true
addWaypoint_maxTime: 20s
addWaypoint_target_nearestUnit_tagged: 空传导
addWaypoint_target_nearestUnit_team: own
addWaypoint_target_mapMustBeReachable: false
autoTrigger: if self.globalTeamTags(includes='AI系统') and not self.isAttacking() and not self.hasActiveWaypoint(type='loadInto')

[hiddenAction_AIloadInto2]
addWaypoint_type: loadInto
addWaypoint_prepend: true
addWaypoint_maxTime: 20s
addWaypoint_target_nearestUnit_tagged: 空危步
addWaypoint_target_nearestUnit_team: own
addWaypoint_target_mapMustBeReachable: false
autoTrigger: if self.globalTeamTags(includes='AI系统') and not self.isAttacking() and not self.hasActiveWaypoint(type='loadInto')

[hiddenAction_AI集群进攻]
addWaypoint_type: guard
addWaypoint_prepend: true
addWaypoint_maxTime: 20s
addWaypoint_target_nearestUnit_tagged: 群虫成体
addWaypoint_target_nearestUnit_team: own
autoTrigger: if self.globalTeamTags(includes='AI系统') and not self.hasActiveWaypoint(type='guard') and not self.hasActiveWaypoint(type='loadInto') and self.globalTeamTags(includes='开端{I}')