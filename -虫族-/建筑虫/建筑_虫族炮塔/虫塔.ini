[core]

copyFrom: turret_common_land.ini
name: 虫塔
displayText: 虫塔

price: 600
maxHp: 600

techLevel: 1
buildSpeed: 0.002

selfRegenRate: 0.06

tags: units, 虫族, 虫建筑, 虫筑系T1, 虫筑系T2, 炮塔

overrideAndReplace: bugTurret
displayDescription: -虫族炮塔\n-对空对地\n-可以自我回收\n-直接回收虫塔及其升级不会退还资源\n-祂想探出头来……

[hiddenAction_water]
autoTrigger: if self.isOverwater
convertTo: 水虫塔
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
attachments_deleteNumUnits: 1

[hiddenAction_lava]
autoTrigger: if self.isOverLiquid and not self.isOverwater
convertTo: 熔岩塔
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}

[graphics]
total_frames: 2
image: bug_turret.png

animation_attack_start: 0
animation_attack_end: 1
animation_attack_speed: 5
animation_attack_scale_start: 1
animation_attack_scale_end: 1.02
animation_attack_pingPong: true

[attack]
canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits: true
canAttackUnderwaterUnits: false

maxAttackRange: 180
shootDelay: 40

[turret_1]
x: 0
y: 8
shoot_light: #FF00CCCC

[projectile_1]
tags= T-projectile
directDamage: 50
life: 70
speed: 7
frame: 6

explodeEffect: CUSTOM:explodeSmall

[effect_explodeSmall]
life: 25
fadeOut: false
attachedToUnit: false
image: explode_big2.png
scaleFrom: 0.5
scaleTo: 0.5
total_frames: 14
animateFrameStart: 0
animateFrameEnd: 13
animateFrameSpeed: 0.6

[action_1]
isVisible: if self.resource(type="生长", lessThan=${action_1.price/10})
convertTo: 虫塔T2
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
displayType: Upgrade
price: 1000
id: 进化T2
text: 进化 - T2
description: -祂在蔓延……\n-对地对空
descriptionAddUnitStats: ${section.convertTo}
pos: 1
buildSpeed: 18.5s
iconExtraImage: SHARED:icon_upgrade_top.png
iconExtraColor: #AAFFFFFF
[action_2]
isVisible: if self.resource(type="生长", lessThan=${action_2.price/10})
convertTo: 地震塔
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
displayType: Upgrade
price: 1400
id: 进化地震
text: 进化 - 地震
description: -引起地脉共鸣\n-范围对地
descriptionAddUnitStats: ${section.convertTo}
pos: 2
buildSpeed: 25s
iconExtraImage: SHARED:icon_upgrade_top.png
iconExtraColor: #AAFFFFFF
[action_3]
isVisible: if self.resource(type="生长", lessThan=${action_3.price/10})
convertTo: 管道虫
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
displayType: Upgrade
price: 2300
id: 进化管道
text: 进化 - 管道
description: -祂疏通了脉络……\n-远距离对地
descriptionAddUnitStats: ${section.convertTo}
pos: 3
buildSpeed: 40s
iconExtraImage: SHARED:icon_upgrade_top.png
iconExtraColor: #AAFFFFFF
[action_4]
isVisible: if self.resource(type="生长", lessThan=${action_3.price/10})
convertTo: 冲射虫塔
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
displayType: Upgrade
price: 2200
id: 进化冲射
text: 进化 - 冲射
description: -祂发泄废料……\n-仅对空
descriptionAddUnitStats: ${section.convertTo}
pos: 4
buildSpeed: 25s
iconExtraImage: SHARED:icon_upgrade_top.png
iconExtraColor: #AAFFFFFF

[action_衍1]
@copyFromSection: action_1, template_衍黎进化
isVisible: if self.resource(type="生长", greaterThan=${action_1.price/10-1})
addResources: 生长=-${action_1.price/10}
id: 生长${action_1.id}
textPostFix: (生长: ${action_1.price/10})
buildSpeed: 1.85s
[action_衍2]
@copyFromSection: action_2, template_衍黎进化
isVisible: if self.resource(type="生长", greaterThan=${action_2.price/10-1})
addResources: 生长=-${action_2.price/10}
id: 生长${action_2.id}
textPostFix: (生长: ${action_2.price/10})
buildSpeed: 2.5s
[action_衍3]
@copyFromSection: action_3, template_衍黎进化
isVisible: if self.resource(type="生长", greaterThan=${action_3.price/10-1})
addResources: 生长=-${action_3.price/10}
id: 生长${action_3.id}
textPostFix: (生长: ${action_3.price/10})
buildSpeed: 4.0s
[action_衍4]
@copyFromSection: action_4, template_衍黎进化
isVisible: if self.resource(type="生长", greaterThan=${action_3.price/10-1})
addResources: 生长=-${action_3.price/10}
id: 生长${action_4.id}
textPostFix: (生长: ${action_3.price/10})
buildSpeed: 2.5s



[hiddenAction_自生长1]
autoTrigger: if (self.globalTeamTags(includes='AI系统') or self.hasUnitInTeam(withTag="生长-虫塔T2")) and self.hasResources(生长=${action_2.price/10}) and self.queueSize(empty=true)
alsoQueueAction: 衍1

[hiddenAction_自生长2]
autoTrigger: if self.hasUnitInTeam(withTag="生长-地震塔") and self.hasResources(生长=${action_1.price/10}) and self.queueSize(empty=true)
alsoQueueAction: 衍2

[hiddenAction_自生长3]
autoTrigger: if self.hasUnitInTeam(withTag="生长-管道虫") and self.hasResources(生长=${action_3.price/10}) and self.queueSize(empty=true)
alsoQueueAction: 衍3

[hiddenAction_自生长4]
autoTrigger: if self.hasUnitInTeam(withTag="生长-冲射虫塔") and self.hasResources(生长=${action_4.price/10}) and self.queueSize(empty=true)
alsoQueueAction: 衍4



[ai]
buildPriority: 0.22
noneInBaseExtraPriority: 0.17

maxEachBase: 3


[attachment_AI打击定位]
x: 0
y: 0
isUnselectable: false
keepAliveWhenParentDies: false
canBeAttackedAndDamaged: true
redirectDamageToParent: true

[hiddenAction_AIUnfinished]
autoTriggerOnEvent: created
attachments_addNewUnits: 未建成全能塔定位

[hiddenAction_AIAccomplish]
autoTriggerOnEvent: completeAndActive
attachments_deleteNumUnits: 1

[hiddenAction_AI{AddTags}]
autoTriggerOnEvent: created
requireConditional: if numberOfUnitsInEnemyTeam(withTag='AI系统', greaterThan=0) and numberOfUnitsInEnemyTeam(withTag='基地', greaterThan=0, withinRange=1000)
attachments_addNewUnits: 炮塔侵定位
[hiddenAction_AI{resetTags}]
autoTrigger: if numberOfUnitsInEnemyTeam(withTag='AI系统', greaterThan=0) and numberOfUnitsInEnemyTeam(lessThan=1, withinRange=1000)
temporarilyRemoveTags: 炮塔侵定位


[hiddenAction_AIreclaim]
autoTrigger: if self.isControlledByAI and self.hp(lessThan=100) and self.queueSize(empty=true)
alsoQueueAction: reclaim

[hiddenAction_AIupgrade]
autoTrigger: if self.isControlledByAI() and self.hasResources(1000) and self.queueSize(empty=true) and numberOfUnitsInEnemyTeam(withTag='炮塔', greaterThan=0, withinRange=470)
alsoQueueAction: 1
addResources: credits=-1000

[hiddenAction_AICenterupgrade]
autoTrigger: if self.isControlledByAI() and self.hasResources(1000) and self.queueSize(empty=true) and self.hasResources(中位=1)
alsoQueueAction: 1
addResources: credits=-1000

[resource_中位]
displayName: AI中位