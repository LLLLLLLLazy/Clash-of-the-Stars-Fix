
[core]
name: 放血魔
displayText: 放血魔
displayDescription: -争守地脉资源的地狱恶魔 \n -攻击施加血魔标记-持续流血且受到的任意伤害增加25% \n -无视地形
price: 7000
maxHp: 2000
mass: 20000

maxShield: 100
shieldRegen: 1

tags: units, 恐虐
createOnAggressiveTeam: true

armour: 3
armourMinDamageToKeep: 3

fogOfWarSightRange: 18

techLevel: 2
buildSpeed: 21s

radius: 23
#displayRadius: 27
softCollisionOnAll: 14

isBio: true

selfRegenRate: 0.4

transportSlotsNeeded: 2

energyMax: 4
energyRegen: 0.01
energyRegenWhenRecharging: 0.09
energyNeedsToRechargeToFull: true

autoTriggerCooldownTime: 0.1s

[hiddenAction_summon]
autoTriggerOnEvent: completeAndActive
spawnEffects: CUSTOM:红光, CUSTOM:红光波, CUSTOM:红雾*3


[hiddenAction_游荡]
autoTrigger: if not self.isMoving and (rnd(0, 100)<1 or numberOfUnitsInEnemyTeam(withinRange=400)>0)
addWaypoint_type: attackMove
addWaypoint_position_randomOffsetFromSelf: 100, 100
addWaypoint_target_mapMustBeReachable: true
addWaypoint_maxTime: 5s

[hiddenAction_反击]
autoTriggerOnEvent: tookDamage
requireConditional: if not self.hasActiveWaypoint(type='attack') and not self.hasActiveWaypoint(type='attackMove') and numberOfUnitsInEnemyTeam(withinRange=500)>0 and eventSource.maxHp>5
addWaypoint_type: attack
addWaypoint_target_fromReference: eventSource
addWaypoint_target_mapMustBeReachable: true
addWaypoint_maxTime: 3s

[hiddenAction_回走]
autoTrigger: if distanceBetween(self, customTarget1) > 100 and not self.isAttacking and self.hasTakenDamage>2 or distanceBetween(self, customTarget1) > 500
addWaypoint_type: touchTarget
clearAllWaypoints: true
addWaypoint_prepend: true
addWaypoint_target_fromReference: customTarget1
addWaypoint_target_nearestUnit_team: any
addWaypoint_target_mapMustBeReachable: false
addWaypoint_maxTime: 1s
addResources: shield=100

[hiddenAction_脱战护盾]
autoTrigger: if not self.isAttacking
addResources: shield=100

[graphics]
total_frames: 1
image:       放血魔身.png
image_wreak: NONE
image_turret: NONE
image_shield: red_shield.png

image_shadow: AUTO
shadowOffsetX:2
shadowOffsetY:2
showShieldBar: false

lock_body_rotation_with_main_turret: true
lock_leg_rotation_with_main_turret: true

[animation_move]
KeyframeTimeScale : 1.1
onActions: move
blendIn : 0s
blendOut : 0s

arm1_0.5s: {x:0, y:0, dir:2.5}
arm1_0.9s: {x:0, y:0, dir:0}
arm1_1.4s: {x:0, y:0, dir:-2.5}
arm1_1.8s: {x:0, y:0, dir:0}

arm2_0.5s: {x:-0, y:0, dir:2.5}
arm2_0.9s: {x:0, y:0, dir:0}
arm2_1.4s: {x:-0, y:0, dir:-2.5}
arm2_1.8s: {x:0, y:0, dir:0}

[animation_1]
arm1_0s: {x:0, y:0, dir:0}
arm1_0.2s: {x:0, y:-3, dir:15}
arm1_0.45s: {x:0, y:-3, dir:15}
arm1_0.67s: {x:0, y:3, dir:0}
arm1_0.85s: {x:0, y:0, dir:0}

arm2_0s: {x:0, y:0, dir:0}
arm2_0.2s: {x:0, y:-3, dir:-15}
arm2_0.45s: {x:0, y:-3, dir:-15}
arm2_0.67s: {x:0, y:3, dir:0}
arm2_0.85s: {x:0, y:0, dir:0}

[animation_2]
arm1_0s: {x:0, y:0, dir:0}
arm1_0.18s: {x:0, y:0, dir:15}
arm1_0.4s: {x:0, y:0, dir:0}

arm2_0s: {x:0, y:0, dir:0}
arm2_0.06s: {x:0, y:3, dir:30}
arm2_0.12s: {x:-5, y:6, dir:-50}
arm2_0.25s: {x:0, y:0, dir:0}

[arm_1]
x: -16
y: 0
image_end: 放血魔左手.png
drawOverBody: false
moveSpeed: 18

[arm_2]
x: 16
y: 0
image_end: 放血魔右手剑.png
drawOverBody: false
moveSpeed: 18

[attack]
canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits:   true
canAttackUnderwaterUnits: false

turretSize: 20
turretTurnSpeed: 3.0

maxAttackRange: 250
shootDelay: 16

isMelee: true
attackMovement: bomber

[turret_1]
#主体
x: 0
y: 0
idleDir:0

turnSpeed: 5.1
turnSpeedAcceleration: 0.5

canShoot: false

recoilOffset: 1

[turret_2]
x: 0
y: 0
attachedTo: 1
slave: true

canAttackFlyingUnits: false

shoot_light: #FF0000

limitingRange: 60
canAttackMaxAngle: 10

energyUsage: 1

projectile: 1

onShoot_playAnimation: 2


[turret_3]
x: 0
y: 0
attachedTo: 1
slave: true

delay: 2.5s
barrelX: -15
resourceUsage: hp=100

shoot_flame: 血雾
shoot_light: #FF0000

canAttackCondition: if distanceBetween(self, attacking) > 60 or attacking.isFlying
canAttackMaxAngle: 30

projectile: 2滞

onShoot_playAnimation: 1

[turret_4]
x: 0
y: 0
attachedTo: 1
slave: true

linkDelayWithTurret: 3
warmup: 10

delay: 2.5s
barrelX: 10


shoot_light: #FF0000

canAttackCondition: if distanceBetween(self, attacking) > 60 or attacking.isFlying
canAttackMaxAngle: 30

projectile: 2滞

[projectile_1]
tags= T-projectile
life: 50
instant: true
invisible: true
areaDamage: 100
areaRadius: 20
areaRadiusFromEdge: true

mutatorX_ifUnitWithTags: 墙
mutatorX_areaDamageMultiplier: 2

spawnUnit: 血魔伤害标记

explodeEffect: 刀光, 斩雾, 斩冲波, 斩赤爆, 斩红光, 血线生成, displacement_ripple
explodeEffectOnShield: 刀光, 斩雾, 红光波, 斩冲波, 斩红光, 血线生成, displacement_ripple


[projectile_2滞]
tags= T-projectile
areaDamage: 0
areaRadius: 0
life: 40
speed: 0
invisible: true
deflectionPower: -1
explodeOnEndOfLife: true
spawnProjectilesOnEndOfLife: 2
disableLeadTargeting: true
effectOnCreate: 血剑凝聚, 血色凝聚, 血色光芒, 血聚波
explodeEffect: 血剑放光
explodeEffectOnShield: ${section.explodeEffect}

[projectile_2]
tags= T-projectile
areaHitAirAndLandAtSameTime: true
directDamage: 150
areaDamage: 50
areaRadius: 40
areaDamageNoFalloff: true
areaRadiusFromEdge: true

spawnUnit: 血魔伤害标记

mutatorX_ifUnitWithTags: 墙
mutatorX_directDamageMultiplier: 3
mutatorX_areaDamageMultiplier: 3

deflectionPower: 3

life: 999
speed: 5
targetSpeed: 10
targetSpeedAcceleration: 0.02
autoTargetingOnDeadTarget: true

invisible: true
lightColor: #ff0000
lightSize: 0.8
trailEffect: CUSTOM:红焰光
trailEffectRate: 2
effectOnCreate: 血剑, 血剑光, 血放雾
explodeEffect: 刀光, 斩雾, 斩冲波, 斩赤爆, 斩红光, 血线生成*2, displacement_ripple
explodeEffectOnShield: 刀光, 斩雾, 红光波, 斩冲波, 斩红光, 血线生成*2, displacement_ripple


[effect_刀光]
priority: veryhigh
image: 银刀光.png
life: 20
fadeOut: true
fadeInTime: 3
attachedToUnit: false
scaleFrom: 0.5
scaleTo: 0.5
alpha: 0.8
color: #FF0000
drawUnderUnits: false
dirOffset: -25
xOffsetRelative: 5
yOffsetRelative: -15
ySpeedRelative: 0.4
alsoPlaySound: WeaponLaserBladeHit.ogg:0.4

[effect_displacement_ripple]
drawType: displacement

priority: veryhigh
image: SHARED:ripple_normal_128.png
life: 30
fadeOut: true

attachedToUnit: false
color: #FFFFFF
scaleFrom: 0
scaleTo: 1
alpha: 0.1
drawUnderUnits:false

dirOffsetRandom: 180
dirSpeed: 1

[effect_斩雾]
priority: veryhigh
image: fog.png
life: 50
lifeRandom: 10
fadeOut: true
fadeInTime: 10
attachedToUnit: true
color: #ff0000
scaleFrom: 0
scaleTo: 1.2
alpha: 0.2
drawUnderUnits:false
dirSpeedRandom:0.3
dirOffsetRandom:180

[effect_斩冲波]
priority: high
stripIndex: shockwave_large
life: 40
lifeRandom: 20
alpha: 0.8
scaleFrom: 0
scaleTo: 1
color: #ff0000

[effect_斩赤爆]
priority: veryhigh
life: 30
attachedToUnit: false
image: 白爆.png
scaleFrom: 0.0
scaleTo: 0.8
alpha: 0.8
color: #FF0000
total_frames: 14
animateFrameStart: 0
animateFrameEnd: 13
animateFrameSpeed: 0.5
fadeOut: false

[effect_斩红光]
priority: veryhigh
life: 30
lifeRandom: 10
alpha: 1
fadeInTime: 3
scaleFrom: 0.1
scaleTo: 2
image: SHARED:light_50.png
color: #ff0000

[effect_血线生成]
priority: low
image: SHARED:blank.png
life: 0
scaleFrom: 0
scaleTo: 0

yOffsetRelativeRandom: 20
xOffsetRelativeRandom: 20
dirOffsetRandom: 180

delayedStartTimerRandom: 12
alsoEmitEffectsOnDeath: 血线, 血线闪, 血线闪光, 红光散*2

[effect_血线]
priority: low
image: 线.png
life: 60
fadeInTime: 10
fadeOut: true
attachedToUnit: false
scaleFrom: 0.6
scaleTo: 0.7
alpha: 2
color: #66FF0000
alsoPlaySound: blood.ogg:0.1

[effect_血线闪]
priority: verylow
image: 线.png
life: 10
fadeOut: true
attachedToUnit: false
scaleFrom: 0.9
scaleTo: 1.1
alpha: 1
color: #AAFF0000

[effect_血线闪光]
priority: low
image: SHARED:light_50.png
life: 25
lifeRandom: 5
fadeOut: true
attachedToUnit: false
color: #FF0000
scaleFrom: 1.4
scaleTo: 1.4
alpha: 0.3
drawUnderUnits:false

[effect_红光散]
priority: low
image: SHARED:light_50.png
life: 50
lifeRandom: 20
fadeOut: true
attachedToUnit: false
color: #FF0000
fadeInTime: 2
scaleFrom: 0.4
scaleTo: 0.4
alpha: 0.8
xSpeedRelativeRandom: 1.2
ySpeedRelativeRandom: 1.2
hSpeed: 0.3



[effect_血剑]
priority: critical
image: 血魔光剑.png
life: 999
scaleFrom: 1
scaleTo: 1
alpha: 20
color: #ff0000
pivotOffset: 45
attachedToUnit: true
liveAfterAttachedDies: false
alsoPlaySound: WeaponLaserBladeHit.ogg:0.4

[effect_血剑凝聚]
priority: veryhigh
image: 血魔光剑.png
life: 40
fadeInTime: 40
scaleFrom: 0.8
scaleTo: 1
alpha: 2
color: #ff0000
pivotOffset: 45
alsoEmitEffectsOnDeath: 血剑凝聚放

[effect_血剑凝聚放]
priority: veryhigh
image: 血魔光剑.png
life: 15
scaleFrom: 1
scaleTo: 1.2
alpha: 0.8
color: #ff0000
ySpeedRelative: 1

[effect_血色凝聚]
priority: veryhigh
image: SHARED:blank.png
life: 40
scaleFrom: 0
scaleTo: 0
trailEffect: 血光凝聚, 血雾聚
trailEffectRate: 5

[effect_血光凝聚]
priority: low
image: 远光.png
life: 20
fadeOut: false
fadeInTime: 5
scaleFrom: 2
scaleTo: 0.1
alpha: 0.8
color: #ff0000
yOffsetRelativeRandom: 5
xOffsetRelativeRandom: 5
dirOffsetRandom: 180

[effect_血色光芒]
priority: high
image: SHARED:light_50.png
life: 40
color: #FF0000
fadeInTime: 40
scaleFrom: 0.5
scaleTo: 1.2
alpha: 0.5

[effect_血剑放光]
priority: high
image: SHARED:light_50.png
life: 25
color: #FF0000
scaleFrom: 0.5
scaleTo: 1.7
alpha: 0.5

[effect_血聚波]
priority: high
stripIndex: shockwave_large
life: 40
fadeOut: false
color: #FF0000
fadeInTime: 25
scaleFrom: 1
scaleTo: 0.3
alpha: 0.4

[effect_血剑光]
priority: high
image: SHARED:light_50.png
life: 100
color: #FF0000
scaleFrom: 1.2
scaleTo: 1.2
alpha: 0.6

[effect_血雾]
priority: veryhigh
image: fog.png
life: 60
fadeOut: true
attachedToUnit: false
color: #ff0000
scaleFrom: 0
scaleTo: 2
alpha: 0.8
drawUnderUnits:false
dirSpeedRandom:0.3
dirOffsetRandom:180
xOffsetRelative: 15
yOffsetRelative: -15

[effect_血雾聚]
priority: veryhigh
image: fog.png
life: 25
fadeInTime: 5
fadeOut: false
attachedToUnit: false
color: #ff0000
scaleFrom: 0.8
scaleTo: 0
alpha: 0.2
drawUnderUnits:false
dirSpeedRandom:0.3
dirOffsetRandom:180
yOffsetRelativeRandom: 5
xOffsetRelativeRandom: 5

[effect_血放雾]
priority: veryhigh
image: fog.png
life: 50
lifeRandom: 10
fadeOut: true
attachedToUnit: false
color: #ff0000
scaleFrom: 0
scaleTo: 1
alpha: 0.3
drawUnderUnits:false
dirSpeedRandom:0.3
dirOffsetRandom:180

[effect_红焰光]
priority: high
image: SHARED:light_50.png
life: 20
fadeOut: true
attachedToUnit: false
color: #FF0000
fadeInTime:2
scaleFrom: 0.5
scaleTo: 0.5
alpha: 0.6
drawUnderUnits: false
atmospheric: true
xSpeedAbsoluteRandom: 0.2
ySpeedAbsoluteRandom: 0.2





[effect_红光]
priority: veryhigh
attachedToUnit: true
life: 50
alpha: 1
scaleFrom: 2
scaleTo: 0.5
image: SHARED:light_50.png
color: #ff0000
drawUnderUnits: false

[effect_红光波]
priority: high
stripIndex: shockwave
life: 50
alpha: 0.8
scaleFrom: 0
scaleTo: 1.5
color: #ff0000

[effect_红雾]
priority: high
stripIndex: effects
life: 70
fadeOut: true
attachedToUnit: false
color: #ff0000
fadeInTime: 5
scaleFrom: 0.5
scaleTo: 1.5
alpha: 1
drawUnderUnits:false

atmospheric: true
hSpeed: 1
hOffsetRandom: 0.75
dirOffsetRandom: 180
xSpeedAbsoluteRandom: 3
ySpeedAbsoluteRandom: 3


[movement]
movementType: AIR
moveSpeed: 1
moveAccelerationSpeed: 0.06
moveDecelerationSpeed: 0.06

reverseSpeedPercentage: 1.0

maxTurnSpeed: 4.1
turnAcceleration: 0.15

targetHeight: 0
targetHeightDrift: 0

moveSlidingMode :true
moveIgnoringBody:true