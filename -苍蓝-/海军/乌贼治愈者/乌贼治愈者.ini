
[core]
name: 乌贼治愈者
displayText: 乌贼治愈者
displayDescription: -可漂浮于天际 \n -释放治疗波范围回复我方单位的血量与护盾(无法治疗盟友) \n “喷涌至天空”
class: CustomUnitMetadata
price: 7000
maxHp: 2000
maxShield: 2000
mass: 10000

tags: units, 乌贼治愈者
showActionsWithMixedSelectionIfOtherUnitsHaveTag: 乌贼治愈者

techLevel: 2
buildSpeed: 0.0004

radius: 20

isBio: false
isBuilder: true
softCollisionOnAll: 10

@memory 坐标: unit

[action_浮潜]
convertTo: 乌贼治愈者[天空]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
isActive: if self.isOverwater
displayType: action
price: 0
id: 浮潜
text: 上浮
description: -上浮至空中
buildSpeed: 0.01
pos: -1
alwaysSinglePress: true
highPriorityQueue: true


[effect_pain]
alpha: 0.3
life: 80
scaleFrom: 0.1
scaleTo: 2.5
#hOffset: -10
image: pain.png
attachedToUnit: true

[action_devotion]
isVisible: true
isActive: false
autoTrigger: if not self.hasFlag(id=2)
text: 治疗波
description: -治愈200范围内己方单位的血量与护盾 \n -20/1s
displayType: infoOnly
pos: 0.1
buildSpeed: 0s
fireTurretXAtGround: magic
fireTurretXAtGround_withOffset:0,0
fireTurretXAtGround_withProjectile:pain
spawnEffects: pain


[action_固定位置]
isVisible: if memory.坐标==null
text: 固定位置
description: -持续接近固定位置 \n -移除保护和巡逻以外的指令
buildSpeed: 0s
pos: 1
iconImage: SHARED:icon_off.png
isGuiBlinking: if memory.坐标!=null
setUnitMemory: 坐标=thisActionTarget
fireTurretXAtGround: skill
fireTurretXAtGround_count: 0
highPriorityQueue: true
allowMultipleInQueue: false
isAlsoViewableByAllies: true

[action_固定位置关]
@copyFromSection: action_固定位置
isVisible: if memory.坐标!=null
setUnitMemory: 坐标=null
iconImage: SHARED:icon_on.png
fireTurretXAtGround: NONE
fireTurretXAtGround_count: IGNORE

[hiddenAction_接近坐标]
autoTriggerOnEvent: newWaypointGivenByPlayer
requireConditional: if memory.坐标!=null and not self.hasActiveWaypoint(type='patrol') and not self.hasActiveWaypoint(type='guard')
autoTrigger: if memory.坐标!=null and (distanceBetween(self, memory.坐标)>5 or distanceBetween(activeWaypointTarget, memory.坐标)>20) and not self.hasActiveWaypoint(type='patrol') and not self.hasActiveWaypoint(type='guard')
addWaypoint_type: move
addWaypoint_prepend: true
addWaypoint_target_fromReference: memory.坐标
clearAllWaypoints: true

[decal_固定线]
isVisible: if memory.坐标!=null
onlyWhenSelectedByAnyPlayer: true
onlyTeam: ally
layer: beforeUI
color: #00FFAC
alpha: 0.8
basePosition: self
drawLineTo: memory.坐标

#[action_flagship]
#isLocked:  if numberOfUnitsInTeam(withTag='旗舰', greaterThan=0, factoryQueue=true)
#isLockedMessage: 已有旗舰
#convertTo: 乌贼治愈者[旗舰]
#text: 设置为旗舰
#description: -给予一定资源补给\n -提升其攻速，范围，视野\n -获得主动技能
#displayType: upgrade
#buildSpeed: 10s
#pos: -1
#whenBuilding_triggerAction: AddTags
#onlyOneUnitAtATime: true
#canPlayerCancel: true

#[hiddenAction_AddTags]
#temporarilyAddTags: 旗舰
#[hiddenAction_resetTags]
#autoTrigger: if self.tags(includes='旗舰') and self.queueSize(empty=true)
#resetToDefaultTags: true

[graphics]
total_frames: 1

image:        乌贼治愈者.png
image_wreak:  乌贼死亡.png
image_turret: NONE
#scaleImagesTo: 20
#scaleTurretImagesTo: 9

image_shadow: AUTO
shadowOffsetX:2
shadowOffsetY:2


[attack]
canAttack: true
canAttackFlyingUnits: false
canAttackLandUnits:   false
canAttackUnderwaterUnits: false

turretSize: 0
turretTurnSpeed: 20

maxAttackRange: 200
shootDelay: 60

[turret_magic]
x: 0
y: 0
canShoot: false
invisible:true

[projectile_pain]
tags= T-projectile
#pain
life: 1
explodeOnEndOfLife:true
speed: 4
drawSize: 0
targetGround:true
deflectionPower: -1
areaDamage: -20
areaRadius: 200
areaDamageNoFalloff: true
areaHitAirAndLandAtSameTime: true
areaHitUnderwaterAlways: true
#areaDamageNoFalloff: true
armourIgnoreAmount: 999
shieldDefectionMultiplier: 0
friendlyFire: only-ignoreEnemy
explodeEffect: NONE

mutator1_ifUnitWithTags: 中立资源
mutator1_areaDamageMultiplier: 0
mutator2_ifUnitWithTags: 贝露浮游炮, 贝露中心单位
mutator2_areaDamageMultiplier: 0.1

[turret_skill]
x: 0
y: 0
invisible: true
canShoot: false
limitingRange: 9999

[leg_1]
x: 8
y: 8
attach_x: 5
attach_y: 5
moveSpeed:0.2
heightSpeed:0.1
resetAngle:5
holdDisMin: 20
holdDisMax: 30
hardLimit: 40

image_leg:  乌贼触手.png
image_foot: NONE

lockMovement: false

[leg_2]
x: -8
y: 8
attach_x: -5
attach_y: 5
copyFrom: 1

[leg_3]
x: 8
y: -8
attach_x: 5
attach_y: -5
copyFrom: 1

[leg_4]
x: -8
y: -8
attach_x: -5
attach_y: -5
copyFrom: 1

[leg_5]
x: 12
y: 0
attach_x: 8
attach_y: 0
copyFrom: 1

[leg_6]
x: -12
y: 0
attach_x: -8
attach_y: 0
copyFrom: 1

[leg_7]
x: 0
y: 12
attach_x: 0
attach_y: 8
copyFrom: 1

[leg_8]
x: 0
y: -12
attach_x: 0
attach_y: -8
copyFrom: 1

[movement]
movementType: WATER
moveSpeed: 0.9
moveAccelerationSpeed: 0.01
moveDecelerationSpeed: 0.05

#moveSlidingMode :false
#moveIgnoringBody:false
#moveSlidingDir:  45

targetHeight: -10
targetHeightDrift: 0.3

heightChangeRate: 0.15

landOnGround: false

maxTurnSpeed: 2
turnAcceleration: 0.1


