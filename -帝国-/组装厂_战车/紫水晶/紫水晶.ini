
[core]
name: 紫水晶
displayText: 紫水晶

displayDescription: -非常全副武装\n-攻击地面单位\n-散布大量爆裂紫水晶\n-每次炮击会引导紫水晶共鸣光束\n-近身尖牙
class: CustomUnitMetadata
price: 14000
maxHp: 5600
mass: 40000
tags: units, 紫水晶
showActionsWithMixedSelectionIfOtherUnitsHaveTag: 紫水晶

armour: 20
armourMinDamageToKeep: 20

fogOfWarSightRange: 18

techLevel: 2
buildSpeed: 0.0003
#availableInDemo: true

selfRegenRate: 0.15

radius: 36
displayRadius: 38

isBio: false

transportSlotsNeeded: 4

#energyMax: 1.1
#energyRegen: -0.01

effectOnDeath: CUSTOM:shockwave_large, large

autoTriggerCooldownTime: 0.2s

[action_burst]
id: 水晶爆破
text: 水晶爆破
description: -引爆附近的紫水晶柱 \n -紫水晶柱爆炸造成20群伤|90单伤
buildSpeed: 0
pos: 1
fireTurretXAtGround: 1
fireTurretXAtGround_withOffset:0,0
fireTurretXAtGround_withProjectile: burst
highPriorityQueue: true
alwaysSinglePress: true
allowMultipleInQueue: false
addActionCooldownTime: 1s

[action_upgrade]
isVisible: if self.kills(greaterThan=0) or self.ammo>0
convertTo: 紫水晶α改[转换中]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
price:  2000
id: ${section.text}
text: 阿尔法改装
description: -向附近八个方向发射水晶柱 \n -水晶柱将减缓敌军的攻速 \n -缺乏伤害能力
descriptionAddUnitStats: ${section.convertTo}
displayType: upgrade
buildSpeed: 27.8s
pos: 2
iconExtraImage: SHARED:icon_upgrade_top.png
iconExtraColor: #AAFFFFFF
whenBuilding_cannotMove: true
whenBuilding_rotateTo: 0
whenBuilding_rotateTo_orBackwards: true
addResources: energy=3
spawnEffects: 扭曲波


[action_painting]
isVisible: if self.globalTeamTags(includes='调律者涂装')
convertTo: 紫水晶[Binah]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
id: 涂装
text: “调律者”
description: -个性涂装 \n(不影响战斗属性)
displayType: upgrade
buildSpeed: 3.3s
pos: 3
spawnEffects: 扭曲波

[hiddenAction_涂装解锁]
autoTrigger: if ( self.kills+self.ammo>2 or self.playerName=="Binah" or self.playerName=="binah" ) and not self.globalTeamTags(includes='调律者涂装')
addGlobalTeamTags: 调律者涂装


[projectile_burst]
tags= T-projectile
life: 0
explodeOnEndOfLife:true
speed: 0
drawSize: 0
targetGround:true
deflectionPower: -1
areaDamage: 0
areaRadius: 500

mutator1_ifUnitWithTags: 紫水晶柱
mutator1_areaDamageMultiplier: 0
mutator1_addResourcesAreaHit: hp=-400

friendlyFire: only-ignoreEnemy
explodeEffect: NONE

[action_尖刺]
isVisible: false
autoTrigger: if numberOfUnitsInEnemyTeam(greaterThan=0, withinRange=100)

buildSpeed: 0s

fireTurretXAtGround: 碾压
fireTurretXAtGround_withOffset:0, 36
text: 
description: 
displayType: infoOnly

[hiddenAction_尖刺闪烁]
autoTrigger: if self.customTimer(laterThanSeconds=1) and numberOfUnitsInEnemyTeam(greaterThan=0, withinRange=100)
spawnEffects: CUSTOM:尖刺闪烁
resetCustomTimer: true

[graphics]
total_frames: 3

image:        新紫水晶.png
image_wreak: 紫水晶残骸.png
image_turret: NONE
teamColorsOnTurret: true

image_shadow: AUTO
shadowOffsetX: 3
shadowOffsetY: 3

showEnergyBar: false


animation_moving_start: 0
animation_moving_end: 2
animation_moving_speed: 1


dustEffect: true
dustEffectReverse: false


[attack]
canAttack: true
canAttackFlyingUnits: false
canAttackLandUnits:   true
canAttackUnderwaterUnits: false

turretSize: 45
turretTurnSpeed: 2

aimOffsetSpread: 0

maxAttackRange: 240
shootDelay: 270

[turret_2]
#炮管
x: 0
y: 35
image: 紫水晶炮管.png
attachedTo: 1
slave: true

barrelY: 15

projectile: 1
shoot_sound: large_gun_fire1
shoot_sound_vol: 0.3
shoot_light: #C2A8D1

warmup: 30
canShoot: true
#resourceUsage: energy=-1

recoilOffset: -4
recoilOutTime: 7
recoilReturnTime: 50

[turret_1]
#炮座
x: 0
y: -7
canShoot: false
image: 紫水晶炮塔.png

recoilOffset: -3
recoilOutTime: 7
recoilReturnTime: 50

[turret_3]
x: 0
y: 0
attachedTo: 1
slave: true
size: 43

projectile: 2

warmup: 30
canShoot: true
#energyUsage: 1

#limitingMinRange: ${turret_4.limitingRange +1}

recoilOffset: -1
recoilOutTime: 2
recoilReturnTime: 10

[turret_4]
x: 0
y: 0
attachedTo: 1
slave: true

projectile: 3

warmup: 30
canShoot: true
#energyUsage: 1

#limitingRange: 220

recoilOffset: -1
recoilOutTime: 2
recoilReturnTime: 10


[turret_碾压]
x: 0
y: 36
canAttackCondition: false
invisible: true

turnSpeed: 2000
turnSpeedAcceleration: 1
projectile: 碾压

size: 0
delay: 15
limitingMinRange: 100


[turret_紫晶共鸣]
#显示额外伤害数据
x: 0
y: 0
invisible: true
canAttackCondition:	false
projectile: 紫晶共鸣面板
warmup: 30

[projectile_紫晶共鸣面板]
directDamage: 70
invisible: true
life: 0


[projectile_碾压]
tags= T-projectile
life: 0
invisible: true
explodeOnEndOfLife: true
targetGround: true
explodeEffect:NONE

areaDamage: 30
areaRadius: 25
areaRadiusFromEdge: true
areaDamageNoFalloff: true

#buildingDamageMultiplier: 1.5

pushForce: 1
pushVelocity: 1

[projectile_1]
tags= T-projectile
directDamage: 100
areaDamage: 200
areaRadius: 0
areaIgnoreUnitsCloserThan: 1
life: 200
speed: 5

drawType: 2
drawSize: 0.8
frame: 2

largeHitEffect: true

color: #68109B
lightColor: #3A2450
lightSize: 0.6

trailEffect: CUSTOM:光线
trailEffectRate: 4

spawnProjectilesOnExplode: 1晶能(recursionLimit=1)
spawnProjectilesOnCreate: 1(xOffsetRelative=4, yOffsetRelative=-4, recursionLimit=1), 1(xOffsetRelative=-4, yOffsetRelative=-4, recursionLimit=1)

#explodeEffect: CUSTOM:hitLightFlash
#explodeEffectOnShield: CUSTOM:hitLightFlash

[projectile_1晶能]
tags= T-projectile
explodeOnEndOfLife:true
life: 0
invisible: true
areaDamage: 0
areaRadius:	150
friendlyFire: true
deflectionPower: -1
explodeEffect: NONE
explodeEffectOnShield: NONE
mutatorX_ifUnitWithTags: 紫水晶柱
mutatorX_areaDamageMultiplier: 0
mutatorX_addResourcesAreaHit: energy=1

[projectile_2]
tags= T-projectile
directDamage: 0
life: 15
speed: 5
invisible: true

explodeOnEndOfLife:true
spawnProjectilesOnExplode: 2-2(recursionLimit=2), 2A(recursionLimit=99, xOffsetRelative=5, offsetDir=90, offsetHeight=5), 2A(recursionLimit=99, xOffsetRelative=-5, offsetDir=-90, offsetHeight=5)

explodeEffect: NONE
explodeEffectOnShield: NONE

[projectile_2-2]
@copyFromSection: projectile_2
spawnProjectilesOnExplode: 2-3(recursionLimit=2), 2A(recursionLimit=99, xOffsetRelative=5, offsetDir=90, offsetHeight=5), 2A(recursionLimit=99, xOffsetRelative=-5, offsetDir=-90, offsetHeight=5)

[projectile_2-3]
@copyFromSection: projectile_2
spawnProjectilesOnExplode: 2-4(recursionLimit=2), 2A(recursionLimit=99, xOffsetRelative=5, offsetDir=90, offsetHeight=5), 2A(recursionLimit=99, xOffsetRelative=-5, offsetDir=-90, offsetHeight=5)

[projectile_2-4]
@copyFromSection: projectile_2
spawnProjectilesOnExplode: 2-4(recursionLimit=2), 2A(recursionLimit=99, xOffsetRelative=5, offsetDir=90, offsetHeight=5), 2A(recursionLimit=99, xOffsetRelative=-5, offsetDir=-90, offsetHeight=5)


[projectile_2A]
tags= T-projectile
directDamage: 0
life: 20
invisible: true
speed: 0
turnSpeed: 0
deflectionPower: -1

effectOnCreate: CUSTOM:水晶显现
spawnProjectilesOnEndOfLife: 2c(recursionLimit=99)

[projectile_2c]
tags= T-projectile
directDamage: 100
life: 50
speed: 7
turnSpeed: 12
turnSpeedWhenNear: 60
image: 紫水晶.png
drawSize: 0.6

largeHitEffect: true

lightColor: #844DAB
lightSize: 0.6

trailEffect: CUSTOM:紫水晶光焰
trailEffectRate: 3

wobbleAmplitude: 4
wobbleFrequency: 5s

targetGround: true
#targetGroundSpread: 60
leadTargetingSpeedCalculation: 1

spawnProjectilesOnEndOfLife: 2c+(recursionLimit=99)

spawnUnit: 紫水晶柱(spawnChance=0.5,alwayStartDirAtZero=true)

[projectile_2c+]
@copyFromSection: projectile_2c
spawnProjectilesOnEndOfLife: NONE
life: 500
turnSpeed: 25


[projectile_3]
tags= T-projectile
life: 3
speed: 5

deflectionPower: -1
explodeOnEndOfLife:true
spawnProjectilesOnExplode: 3(recursionLimit=300), 3A(recursionLimit=999, offsetRandomDir=181, spawnChance=0.0125), 3A2(recursionLimit=999, offsetRandomDir=181, spawnChance=0.01), 2A(recursionLimit=1, xOffsetRelative=5, yOffsetRelative=5, offsetDir=90, offsetHeight=5), 2A(recursionLimit=1, xOffsetRelative=-5, yOffsetRelative=5, offsetDir=-90, offsetHeight=5)

directDamage: 1
mutatorX_ifUnitWithoutTags: ʚ♡⃛ɞ(ू•ᴗ•ू❁)
mutatorX_directDamageMultiplier: 0.3

laserEffect: true

color: #789F40E3

explodeEffect: CUSTOM:水晶簇闪光, CUSTOM:紫水晶粒子
explodeEffectOnShield: CUSTOM:水晶簇闪光, CUSTOM:紫水晶粒子

[projectile_3A]
tags= T-projectile
life: 16
speed: 6
turnSpeed: 0
invisible: true

explodeOnEndOfLife:true
spawnProjectilesOnExplode: 3B(recursionLimit=999, offsetDir=180), 3附A(recursionLimit=999)

directDamage: 0

targetGround: true
targetGroundSpread: 300

effectOnCreate: CUSTOM:紫水晶粒子颗
explodeEffect: CUSTOM:水晶簇闪光
explodeEffectOnShield: CUSTOM:水晶簇闪光

[projectile_3A2]
tags= T-projectile
speed: 8

spawnProjectilesOnExplode: 3B2(recursionLimit=999, offsetDir=180), 3附A2(recursionLimit=999)

@copyFromSection: projectile_3A

[projectile_3B]
tags= T-projectile
life: 20
speed: 0
invisible: true

explodeOnEndOfLife:true
spawnProjectilesOnExplode: 3c(recursionLimit=999), 3附c(recursionLimit=999)

directDamage: 0
deflectionPower: -1

retargetingInFlight: true
retargetingInFlightSearchRange: 300

effectOnCreate: CUSTOM:水晶显现
explodeEffect: CUSTOM:水晶簇闪光
explodeEffectOnShield: CUSTOM:水晶簇闪光

[projectile_3B2]
tags= T-projectile

retargetingInFlight: false
@copyFromSection: projectile_3B

[projectile_3附A]
tags= T-projectile
life: 20
speed: 0

directDamage: 0
deflectionPower: -1

retargetingInFlight: true
retargetingInFlightSearchRange: 300

beamImage:      SHARED:beam3.png
beamImageEnd:   SHARED:beam1_end.png
beamImageStart: SHARED:beam1_start.png
beamImageOffsetRate: 2

color: #609F40E3

explodeEffect: NONE
explodeEffectOnShield: NONE

[projectile_3附A2]
@copyFromSection: projectile_3附A
retargetingInFlight: false

[projectile_3c]
tags= T-projectile
directDamage: 100
life: 300
speed: 7
turnSpeed: 24
image: 紫水晶.png
drawSize: 0.6

largeHitEffect: true

lightColor: #844DAB
lightSize: 0.6

trailEffect: CUSTOM:紫水晶光焰
trailEffectRate: 3

targetGround: true
#targetGroundSpread: 20
leadTargetingSpeedCalculation: 1

spawnUnit: 紫水晶柱(alwayStartDirAtZero=true)

[projectile_3附c]
tags= T-projectile
life: 90
speed: 7
turnSpeed: 24
deflectionPower: 0

@copyFromSection: projectile_3附A

retargetingInFlight: false

color: #AA9F40E3

[effect_光线]
createWhenOffscreen: true
priority: low
image: 白光长线.png
life: 60
fadeOut: true
attachedToUnit: false
color: #3A2450
fadeInTime: 2
scaleFrom: 1.0
scaleTo: 1
alpha: 1.5
drawUnderUnits: true
yOffsetRelative: -16
atmospheric: true

[effect_水晶显现]
createWhenOffscreen: true
priority: veryhigh
image: 紫水晶.png
life: 20
fadeInTime: 20
scaleFrom: 0.4
scaleTo: 0.4
alpha: 0.5
drawUnderUnits: true
alsoEmitEffectsOnDeath: CUSTOM:水晶波

[effect_水晶波]
priority: low
stripIndex: shockwave
life: 20
color: #844DAB
scaleFrom: 0
scaleTo: 0.8
alpha: 0.8

[effect_紫水晶光焰]
priority: high

image: SHARED:light_50.png
life: 18
fadeOut: true
attachedToUnit: false
color: #9F40E3

scaleFrom: 0.7
scaleTo: 0.7
alpha: 0.4

xSpeedRelativeRandom: 1.0
ySpeedRelative: -0.8
ySpeedRelativeRandom: 1.0

drawUnderUnits: false

[effect_水晶簇闪光]
priority: high

image: SHARED:light_50.png
life: 3
color: #A94FEA

scaleFrom: 0.6
scaleTo: 0.6
alpha: 0.5

[effect_紫水晶粒子]
priority: verylow

image: SHARED:light_50.png
life: 16
color: #744496

fadeOut: false
scaleFrom: 0.2
scaleTo: 0.2
alpha: 0.8

xSpeedRelativeRandom: 2.0
ySpeedRelativeRandom: 2.0

[effect_紫水晶粒子颗]
priority: high

image: SHARED:light_50.png
life: 16
color: #744496

fadeOut: false
scaleFrom: 0.6
scaleTo: 0.3
alpha: 0.9

[effect_尖刺闪烁]
priority: low
image: 尖刺.png
life: 16
fadeInTime: 7
fadeOut: true
attachedToUnit: true

scaleFrom: 1
scaleTo: 1.01
alpha: 0.8


[effect_shockwave_large]
stripIndex: shockwave_large
scaleFrom: 0.2
scaleTo: 1.5
life: 30
color: #C2AFCC

[effect_扭曲波]
drawType: displacement
image: SHARED:shockwave_normal_128.png
life: 20
fadeOut: true
fadeInTime: 5
attachedToUnit: false
color: #ffffff
scaleFrom: 0.1
scaleTo: 1.5
alpha: 0.3
drawUnderUnits:false
dirOffsetRandom: 180

[movement]
movementType: LAND
moveSpeed: 0.5
moveAccelerationSpeed: 0.03
moveDecelerationSpeed: 0.03

maxTurnSpeed: 1.2
turnAcceleration: 0.07

reverseSpeedPercentage: 0.8

moveSlidingMode :false
moveIgnoringBody:false





