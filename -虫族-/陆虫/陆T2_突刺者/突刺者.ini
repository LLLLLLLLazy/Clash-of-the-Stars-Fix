
[core]
name: 突刺者

displayDescription: -急速突刺地面单位 \n -需要回复突刺能量 \n -可翻过峭壁
class: CustomUnitMetadata
price: 1500
maxHp: 500
mass: 8000

techLevel: 2
buildSpeed: 0.0015
#availableInDemo: true

radius: 12
displayRadius: 13

isBio: true
isBug: true

tags: units, 虫族, 小型虫, 突刺者, 转向攻击
showActionsWithMixedSelectionIfOtherUnitsHaveTag: 突刺者

numBitsOnDeath: 5

selfRegenRate:0.1

energyMax: 1
energyRegen: 0.0012

softCollisionOnAll: 5

autoTriggerCooldownTime: 0.01s
autoTriggerCooldownTime_allowDangerousHighCPU: true

[action_Upgrade]
convertTo: 毒刺
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
price:腐蚀=100
text:腐蚀 - 淬毒
displayType: Upgrade
buildSpeed: 12.8s
pos: 1
description: -淬毒尖刺 \n -突刺会注入大量毒素
descriptionAddUnitStats: ${section.convertTo}
iconExtraImage:SHARED:icon_upgrade_top.png
iconExtraColor:#AAFFFFFF
tags=腐蚀
setUnitMemory: 属性[24]=0

[hiddenAction_腐蚀中]
autoTrigger: if self.queueSize(withActionTag="腐蚀")>0 and not self.tags(includes='腐蚀中')
setUnitMemory: 属性[24]=-${movement.moveSpeed}*0.6
alsoTriggerAction: 属性变化
temporarilyAddTags: 腐蚀中

[hiddenAction_腐蚀停止]
autoTrigger: if self.queueSize(withActionTag="腐蚀")<1 and self.tags(includes='腐蚀中')
setUnitMemory: 属性[24]=0
alsoTriggerAction: 属性变化
temporarilyRemoveTags: 腐蚀中

[hiddenAction_自动腐蚀]
autoTrigger: if (self.hasUnitInTeam(withTag="腐蚀-毒刺") and self.hasUnitInTeam(withTag="腐蚀之意")) and self.hasResources(${action_Upgrade.price}) and self.queueSize(empty=true) and not self.isAttacking
alsoQueueAction: Upgrade
addResourcesWithLogic: ${action_Upgrade.price}*-1

[hiddenAction_finish]
autoTrigger: if self.isEnergyFull()
convertTo: 突刺者[突刺]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
convertTo_keepCurrentFields: maxHp, maxShield


[action_熔化]
isActive:false
isVisible: if self.isOverLiquid and not self.isOverwater
autoTrigger: if self.isOverLiquid and not self.isOverwater
isGuiBlinking: if self.isOverLiquid and not self.isOverwater
addResources: hp=-0.5
pos: 1
id: ${section.text}
text: 熔化
description: -在岩浆上持续损毁生命值
buildSpeed:0.01s


[hiddenAction_无延迟追击B]
@copyFromSection: template_无延迟追击B
[hiddenAction_无延迟追击B2]
@copyFromSection: template_无延迟追击B2

[graphics]
total_frames: 3

image:        突刺者.png
image_wreak:  NONE
image_turret: NONE
#scaleImagesTo: 20
#scaleTurretImagesTo: 9

#AUTO
image_shadow: AUTO_ANIMATED
shadowOffsetX:1
shadowOffsetY:1


animation_moving_start: 0
animation_moving_end: 2
animation_moving_speed: 4
#animation_moving_pingPong: true

animation_idle_start: 0
animation_idle_end: 0
animation_idle_speed: 120
animation_idle_scale_start:1
animation_idle_scale_end:1.03
animation_idle_pingPong: true

lock_body_rotation_with_main_turret: true

[attack]

isMelee: true

canAttack: true
canAttackFlyingUnits: false
canAttackLandUnits:   true
canAttackUnderwaterUnits: false

#isFixedFiring: true

turretSize: 20
turretTurnSpeed: 5.5

maxAttackRange: 12
shootDelay: 39

[turret_1]
x: 0
y: 0
projectile: 1
altProjectile: 1+
altProjectileCondition: if self.hasActiveWaypoint(type='attack') or self.hasActiveWaypoint(type='attackMove') or self.hasActiveWaypoint(type='guard') or self.hasActiveWaypoint(type='patrol')

shoot_flame: CUSTOM:shadow

canAttackMaxAngle: 10

recoilOffset: 3
recoilOutTime: 6
recoilReturnTime: 18

[projectile_1]
directDamage: 90
life: 50
instant: true
explodeEffect: 突闪, 剑光子*2

[projectile_1+]
@copyFromSection: projectile_1
spawnProjectilesOnCreate: 1V(yOffsetRelative=-22)

[projectile_1V]
areaDamage: 0
areaRadius: 1
areaRadiusFromEdge: true
friendlyFire: only-ignoreEnemy
pushVelocity: 2
life: 0
speed: 0
invisible: true
deflectionPower: -1
explodeOnEndOfLife: true
explodeEffect: NONE
explodeEffectOnShield: NONE


[turret_2]
x: 0
y: 0
onShoot_triggerActions: finish
canAttackCondition: false
attachedTo: 1
slave: true

shoot_flame: CUSTOM:shadow

projectile: 2

[projectile_2]
@copyFromSection: projectile_1
directDamage: 270
largeHitEffect: true
explodeEffect: IGNORE


[turret_3]
@copyFromSection: turret_2
projectile: 3

[projectile_3]
directDamage: 0
life: 0
invisible: true
explodeEffectOnShield: NONE


[turret_1显]
#用于在突刺状态显示普攻伤害
x: 0
y: 0
projectile: 1
canShoot: false
attachedTo: 1
slave: true


[effect_shadow]
image: 突刺者残影.png
life: 20
fadeOut: true
attachedToUnit: true
scaleFrom: 1.0
scaleTo: 1.0
alpha: 1.0
ySpeedRelative: 1.0
yOffsetRelative: -20
teamColorRatio: 1


[effect_突闪]
life: 15
image: effect_flash.png
scaleFrom: 0.2
scaleTo: 0.4
color: #ADCC29

[effect_剑光子]
priority: low
image: 一线光.png
life: 15
lifeRandom: 6
attachedToUnit: false
color: #7ACC29
scaleFrom: 0.3
scaleTo: 0
alpha: 0.5
ySpeedRelative: 4
ySpeedRelativeRandom: 1
pivotOffsetRandom: 35

trailEffect: 剑光随
trailEffectRate: 3

[effect_剑光随]
priority: verylow
image: 一线光.png
life: 30
lifeRandom: 4
attachedToUnit: false
color: #7ACC29
scaleFrom: 0.1
scaleTo: 0
alpha: 0.4
ySpeedRelative: 2
ySpeedRelativeRandom: 0.5
pivotOffsetRandom: 25

[movement]
movementType: OVER_CLIFF
moveSpeed: 1.2
moveAccelerationSpeed: 0.12
moveDecelerationSpeed: 0.07


maxTurnSpeed: 5.5
turnAcceleration: 0.5

targetHeight: 0
targetHeightDrift: 0

moveSlidingMode :true
moveIgnoringBody:true
moveSlidingDir:  181

reverseSpeedPercentage:0