
[core]
name: 爆裂精灵
maxHp: 1
price: 0
mass: 0

#隐藏单位本身
showInEditor: false
isBuilding:	true
radius: 0
fogOfWarSightRange: 0
showOnMinimap: false
ignoreInUnitCapCalculation: true
disableAllUnitCollisions: true
isUnselectable:	true
canNotBeDirectlyAttacked: true

#禁止死亡痕迹
numBitsOnDeath:	0
explodeOnDeath:	false
hideScorchMark: true

[hiddenAction_元素风]
@define element: 风
@define Flag: 1
autoTrigger: if customTarget1.resource.爆裂精灵剩余时间 < 0.5 and self.hasFlag(id=${Flag})
fireTurretXAtGround: magic
fireTurretXAtGround_withProjectile: 环瞬${element}
whenBuilding_playAnimation: blink${element}
spawnEffects: CUSTOM:精灵光-${element}, CUSTOM:精灵波-${element}, CUSTOM:精灵光冲-${element}
deleteSelf: true

[hiddenAction_元素火]
@copyFromSection: hiddenAction_元素风
@define element: 火
@define Flag: 2

[hiddenAction_元素雷]
@copyFromSection: hiddenAction_元素风
@define element: 雷
@define Flag: 3

[hiddenAction_元素水]
@copyFromSection: hiddenAction_元素风
@define element: 水
@define Flag: 4


[hiddenAction_精灵风]
@define element: 风
@define Flag: 1
autoTrigger: if self.hasFlag(id=${Flag}) and not self.tags(includes="精灵${element}")
temporarilyAddTags: 精灵${element}

[hiddenAction_精灵火]
@copyFromSection: hiddenAction_精灵风
@define element: 火
@define Flag: 2

[hiddenAction_精灵雷]
@copyFromSection: hiddenAction_精灵风
@define element: 雷
@define Flag: 3

[hiddenAction_精灵水]
@copyFromSection: hiddenAction_精灵风
@define element: 水
@define Flag: 4


[resource_爆裂精灵剩余时间]
displayName: 爆裂精灵剩余时间
hidden: true

[arm_1]
x: 0
y: 0
image_end: 三角形[风].png
hidden: if not self.hasFlag(id=1)
spinRate: 1

[arm_2]
@copyFromSection: arm_1
image_end: 三角形[火].png
hidden: if not self.hasFlag(id=2)

[arm_3]
@copyFromSection: arm_1
image_end: 三角形[雷].png
hidden: if not self.hasFlag(id=3)

[arm_4]
@copyFromSection: arm_1
image_end: 三角形[水].png
hidden: if not self.hasFlag(id=4)


[effect_精灵光]
priority:high
image: SHARED:light_50.png
life: 14
fadeOut: true
attachedToUnit: false
color: #ff0000
scaleFrom: 0.7
scaleTo: 1.4
alpha: 0.6
drawUnderUnits: false
delayedStartTimer: 20

[effect_精灵波]
priority:veryhigh
stripIndex: shockwave
life: 30
fadeOut: true
attachedToUnit: false
fadeInTime: 2
scaleFrom: 0
scaleTo: 5
alpha: 1
color: #ff0000
drawUnderUnits:false
dirOffsetRandom: 180
dirSpeedRandom: 0.2
atmospheric: true
delayedStartTimer: 20

[effect_精灵光冲]
priority: veryhigh
image: airwave.png
life: 30
fadeOut: true
attachedToUnit: false
fadeInTime: 2
scaleFrom: 1
scaleTo: 3
alpha: 0.5
color: #ff0000
drawUnderUnits:false
dirOffsetRandom: 180
dirSpeedRandom: 0.2
atmospheric: true
xOffsetRelativeRandom: 4
yOffsetRelativeRandom: 4
xSpeedAbsoluteRandom: 0.1
ySpeedAbsoluteRandom: 0.1
delayedStartTimer: 20


[effect_精灵光-风]
@copyFromSection: effect_精灵光, template_elementColor风

[effect_精灵波-风]
@copyFromSection: effect_精灵波, template_elementColor风

[effect_精灵光冲-风]
@copyFromSection: effect_精灵光冲, template_elementColor风


[effect_精灵光-火]
@copyFromSection: effect_精灵光, template_elementColor火

[effect_精灵波-火]
@copyFromSection: effect_精灵波, template_elementColor火

[effect_精灵光冲-火]
@copyFromSection: effect_精灵光冲, template_elementColor火


[effect_精灵光-雷]
@copyFromSection: effect_精灵光, template_elementColor雷

[effect_精灵波-雷]
@copyFromSection: effect_精灵波, template_elementColor雷

[effect_精灵光冲-雷]
@copyFromSection: effect_精灵光冲, template_elementColor雷


[effect_精灵光-水]
@copyFromSection: effect_精灵光, template_elementColor水

[effect_精灵波-水]
@copyFromSection: effect_精灵波, template_elementColor水

[effect_精灵光冲-水]
@copyFromSection: effect_精灵光冲, template_elementColor水


[graphics]
image: null.png
icon_zoomed_out_neverShow: true

[attack]
canAttack: false

[turret_magic]
x: 0
y: 0

[template_elementColor]
@define color:
color: #07eef2

[template_elementColor风]
@define color:风
color: #7AD93E

[template_elementColor火]
@define color:火
color: #FF6E00

[template_elementColor雷]
@define color:雷
color: #63e6e8

[template_elementColor水]
@define color:水
color: #2C9FFF

[effect_light风]
@copyFromSection: effect_light, template_elementColor风

[effect_light火]
@copyFromSection: effect_light, template_elementColor火

[effect_light雷]
@copyFromSection: effect_light, template_elementColor雷

[effect_light水]
@copyFromSection: effect_light, template_elementColor水


[projectile_chakram]
@define color:
teleportSource:true
life: 60
speed: 5
drawSize: 0
hitSound: true
largeHitEffect: true
targetGround:true
instant:true
areaDamage: 100
areaRadius: 70
explodeEffect: CUSTOM:light${color}, CUSTOM:blinkFlash${color}, CUSTOM:blinkGlow${color}, CUSTOM:blinkChargeOut_displacement
effectOnCreate: CUSTOM:blinkFlash${color}, CUSTOM:blinkGlow${color}, CUSTOM:blinkEnter_displacement

delayedStartTimer: 30

[effect_light]
image: light.png
alsoPlaySound: chakram.ogg:0.6

[projectile_环瞬风]
@copyFromSection: projectile_chakram
@define color:风
areaDamage: 100
areaRadius: 150
pushForce: 1000
pushVelocity: 10
areaExpandTime: 30
areaHitAirAndLandAtSameTime: true
instant: false
speed: 99
deflectionPower: -1
explodeEffect: CUSTOM:light${color}, CUSTOM:风素波, CUSTOM:blinkFlash${color}, CUSTOM:blinkGlow${color}, CUSTOM:blinkChargeOut_displacement
spawnProjectilesOnExplode: 风闪, 光3
spawnUnit: 风团(offsetY=5)

[projectile_环瞬火]
@copyFromSection: projectile_chakram
@define color:火
spawnUnit: 火花Z2*2(offsetRandomX=15, offsetRandomY=15)
spawnProjectilesOnExplode:岩浆效果*2, 爆炸效果

[projectile_环瞬雷]
@copyFromSection: projectile_chakram
@define color:雷
spawnUnit: 落雷区*3

[projectile_环瞬水]
@copyFromSection: projectile_chakram, template_elementColor水
@define color:水
shieldDamageMultiplier: 2
explodeEffect: CUSTOM:light${color}, CUSTOM:水遁, CUSTOM:水复, CUSTOM:blinkFlash${color}, CUSTOM:blinkGlow${color}, CUSTOM:blinkChargeOut_displacement
spawnUnit: 潮湿, 潮湿(offsetRandomX=50, offsetRandomY=50)
spawnProjectilesOnExplode: 水盾

[projectile_水盾]
areaDamage: -300
areaRadius: 70
life: 0
speed: 0
friendlyFire: only-ignoreEnemy
explodeOnEndOfLife: true
hullDamageMultiplier: 0
explodeEffect: NONE
explodeEffectOnShield: NONE

[projectile_光3]
directDamage: 0
life: 0
explodeOnEndOfLife: true
explodeEffect: CUSTOM:光
explodeEffectOnShield: CUSTOM:光

[projectile_风闪]
areaDamage: 0
areaRadius: 40
life: 60
speed: 0
invisible: true
explodeOnEndOfLife: true
explodeEffect: CUSTOM:风中波, CUSTOM:中光
explodeEffectOnShield: CUSTOM:风中波, CUSTOM:中光

[effect_光]
createWhenZoomedOut: false
priority:low
image: SHARED:light_50.png
life: 112
fadeOut: true
attachedToUnit: false
color: #ffffff
fadeInTime:2
scaleFrom: 1
scaleTo: 0.5
alpha: 0.8
atmospheric: true

[effect_中光]
priority: low
image: SHARED:light_50.png
life: 60
fadeOut: true
attachedToUnit: false
scaleFrom: 0.3
scaleTo: 0.0
alpha: 0.6

[effect_风中波]
stripIndex: shockwave
life: 30
scaleFrom: 1.0
scaleTo: 0.3
dirSpeed: 5
alpha: 0.9
attachedToUnit: false

[effect_风素波]
stripIndex: shockwave_large
life: 30
scaleFrom: 0
scaleTo: 3.5
color: #7AD93E


[projectile_岩浆效果]
directDamage: 0
life: 10
instant: true
explodeOnEndOfLife:true
explodeEffect: CUSTOM:岩浆*7, CUSTOM:attachedLight
explodeEffectOnShield: CUSTOM:岩浆*7, CUSTOM:attachedLight

[projectile_爆炸效果]
areaDamage: 0
life: 0
invisible: true
explodeOnEndOfLife: true
largeHitEffect: true
explodeEffectOnShield: NONE

[effect_岩浆]
attachedToUnit: false
life: 300
physics: true
xSpeedRelativeRandom: 1.6
ySpeedRelativeRandom: 1.6
hSpeed: 3
scaleFrom: 3
scaleTo: 3
image: SHARED:spark.png
color: #FF6E00

[effect_attachedLight]
priority:veryhigh
image: SHARED:light_50.png
life: 80
fadeOut: true
attachedToUnit: true
color: #fdc14d
fadeInTime:4
scaleFrom: 1.2
scaleTo: 0.4
alpha: 0.5
drawUnderUnits:false
liveAfterAttachedDies: false

[effect_attachedLight1]
@copyFromSection: effect_attachedLight
color: #EB5D0C
scaleFrom: 0.4


[effect_水复]
priority:high
image: hit.png
life: 12
fadeOut: true
attachedToUnit: false
color: #2C9FFF
scaleFrom: 2
scaleTo: 0.1
alpha: 1
drawUnderUnits:false

[effect_水遁]
image: star_shield.png
life: 30
scaleFrom: 2
scaleTo: 2
alpha: 0.6
dirSpeed: 5


[effect_blinkFlash]
@copyFromSection: template_elementColor
priority:high
image: SHARED:light_50.png
life: 78
fadeOut: true
attachedToUnit: false
scaleFrom: 3.8
scaleTo: 1.0
alpha: 0.8
drawUnderUnits:false


[effect_blinkGlow]
@copyFromSection: effect_blinkFlash
life: 148
scaleFrom: 2.8
scaleTo: 5.0
alpha: 0.5



[effect_blinkChargeIn_displacement]

#displacement type ignored if postprocessing is not enabled
drawType: displacement

image: SHARED:cone_inverted_normal_128.png
life: 23
fadeOut: true
fadeInTime: 20

attachedToUnit: true
color: #FFFFFF
scaleFrom: 1.5
scaleTo: 1.0
alpha: 1.0
drawUnderUnits:false

#dirOffsetRandom: 180
#dirSpeed: 1
#delayedStartTimer: 0
alwayStartDirAtZero: true

[effect_blinkChargeOut_displacement]
#displacement type ignored if postprocessing is not enabled
drawType: displacement

image: SHARED:shockwave_normal_128.png
life: 80
fadeOut: true
fadeInTime: 5

attachedToUnit: false
color: #FFFFFF
scaleFrom: 1.0
scaleTo: 4.0
alpha: 0.3
drawUnderUnits:false

alwayStartDirAtZero: true

[effect_blinkEnter_displacement]

#displacement type ignored if postprocessing is not enabled
drawType: displacement

image: SHARED:shockwave_normal_128.png
life: 40
fadeOut: true
fadeInTime: 20

attachedToUnit: false
color: #FFFFFF
scaleFrom: 1.3
scaleTo: 0.5
alpha: 0.7
drawUnderUnits:false

#dirOffsetRandom: 180
#dirSpeed: 1
#delayedStartTimer: 0
alwayStartDirAtZero: true


[effect_blinkSpark]
@copyFromSection: template_elementColor
priority:high
image: SHARED:light_50.png
life: 12

fadeOut: false
attachedToUnit: false
scaleFrom: 0.3
scaleTo: 0.5
alpha: 0.8
drawUnderUnits:false

xOffsetRelativeRandom: 30
yOffsetRelativeRandom: 30

xSpeedAbsoluteRandom: 1.4
ySpeedAbsoluteRandom: 1.4

delayedStartTimerRandom: 5

physics: true
physicsGravity: -0.4

alsoEmitEffectsOnDeath: blinkSparkDisappear${color}

[effect_blinkSparkDisappear]
@copyFromSection: template_elementColor
priority: high
image: SHARED:light_50.png
life: 5

fadeOut: false
attachedToUnit: false
scaleFrom: 0.5
scaleTo: 0
alpha: 0.5
drawUnderUnits:false

hSpeed: 1

[effect_blinkFlash风]
@copyFromSection: effect_blinkFlash, template_elementColor风

[effect_blinkGlow风]
@copyFromSection: effect_blinkGlow, template_elementColor风

[effect_blinkSpark风]
@copyFromSection: effect_blinkSpark, template_elementColor风

[effect_blinkSparkDisappear风]
@copyFromSection: effect_blinkSparkDisappear, template_elementColor风


[effect_blinkFlash火]
@copyFromSection: effect_blinkFlash, template_elementColor火

[effect_blinkGlow火]
@copyFromSection: effect_blinkGlow, template_elementColor火

[effect_blinkSpark火]
@copyFromSection: effect_blinkSpark, template_elementColor火

[effect_blinkSparkDisappear火]
@copyFromSection: effect_blinkSparkDisappear, template_elementColor火


[effect_blinkFlash雷]
@copyFromSection: effect_blinkFlash, template_elementColor雷

[effect_blinkGlow雷]
@copyFromSection: effect_blinkGlow, template_elementColor雷

[effect_blinkSpark雷]
@copyFromSection: effect_blinkSpark, template_elementColor雷

[effect_blinkSparkDisappear雷]
@copyFromSection: effect_blinkSparkDisappear, template_elementColor雷


[effect_blinkFlash水]
@copyFromSection: effect_blinkFlash, template_elementColor水

[effect_blinkGlow水]
@copyFromSection: effect_blinkGlow, template_elementColor水

[effect_blinkSpark水]
@copyFromSection: effect_blinkSpark, template_elementColor水

[effect_blinkSparkDisappear水]
@copyFromSection: effect_blinkSparkDisappear, template_elementColor水

[animation_blink风]
@define element: 风
effect_0.01s: {x:0, y:0, name:CUSTOM|blinkSpark${element}*3}
effect_0.1s: {x:0, y:0, name:CUSTOM|blinkSpark${element}*5}

effect_0.2s: {x:0, y:0, name:CUSTOM|blinkSpark${element}*10}

effect_0.25s: {x:0, y:0, name:CUSTOM|blinkChargeIn_displacement}

effect_0.5s: {x:0, y:0, name:CUSTOM|blinkSpark${element}*16}

[animation_blink火]
@copyFromSection: animation_blink风
@define element: 火

[animation_blink雷]
@copyFromSection: animation_blink风
@define element: 雷

[animation_blink水]
@copyFromSection: animation_blink风
@define element: 水

[movement]
movementType: AIR
targetHeight: 2
targetHeightDrift: 0.6