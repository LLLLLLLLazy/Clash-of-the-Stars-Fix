
[core]
name: 堕天使
displayText: 堕天使
displayDescription: -全副武装 \n-攻击空中单位 \n-冲击破甲霰弹炮 \n-霰弹攻击护盾目标可转变为电流 \n-拉近距离以应对捕猎虫,拉远距离以应对重型拦截机 \n-堕暗狙击-充能远射程打击,在中近距离时无需预热 \n-堕暗狙击命中会使目标移速下降,对护盾伤害稍弱\n-自我修复
class: CustomUnitMetadata
price: 3800
maxHp: 950
mass: 10000
armour: 2
armourMinDamageToKeep: 2

fogOfWarSightRange:20

#maxShield: 200
#startShieldAtZero: true
#shieldRegen: -0.033
#shieldRenderRadius: 22

energyMax: 2
energyRegen: 0.0033
energyNeedsToRechargeToFull: true

tags: units, 空军, 固定射击
techLevel: 2

buildSpeed: 33.3s

radius: 18

selfRegenRate: 0.1

autoTriggerCooldownTime: 0.1s

[action_堕暗]
id: ${section.text}
isActive: false
text: 堕暗狙击
description: -每隔一段时间可进行一次远距离攻击 \n -此攻击会短暂将目标移速-50%
pos: 1
displayType: infoOnly
buildSpeed: 0s
addResources: hp=1

[action_switch1]
id: ${section.text}
isVisible: if not self.hasFlag(id=1)
addResources: setFlag=1
displayType: action
text: 保持狙击
description: -与目标始终保持狙击距离
buildSpeed: 0
iconImage: SHARED:icon_off.png

[action_switch2]
id: ${section.text}2
@copyFromSection: action_switch1
isVisible: if self.hasFlag(id=1)
addResources: unsetFlag=1
iconImage: SHARED:icon_on.png
isGuiBlinking: true


[hiddenAction_堕暗狙击]
autoTrigger: if self.isEnergyFull or self.hasFlag(id=1)
convertTo: 堕天使[暗狙]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}

[action_soul]
isVisible: false
#autoTriggerOnEvent: killedAnyUnit
requireConditional: if self.customTimer(laterThanSeconds=5)
text: 翎羽舛隙
displayType: infoOnly
isActive: false
buildSpeed: 0s
addResources: shield=200
fireTurretXAtGround: magic
fireTurretXAtGround_withOffset: 0,3200
fireTurretXAtGround_withProjectile: 射线
spawnEffects: CUSTOM:blackwave, CUSTOM:blackwave2, CUSTOM:blacklight
resetCustomTimer: true

[graphics]
total_frames: 1

image:        堕天使.png
image_wreak: 堕天使残骸.png
image_turret: NONE

lock_body_rotation_with_main_turret: true
teamColorsOnTurret: true

image_shadow:AUTO
shadowOffsetX:1
shadowOffsetY:1

movementEffect: CUSTOM:projectileTrail
movementEffectRate: 5

image_shield: 黑盾.png
showShieldBar:false

[effect_projectileTrail]
createWhenZoomedOut: false
priority:low
image: SHARED:light_50.png
life: 28
fadeOut: true
attachedToUnit: false
color: #000000
fadeInTime:2
scaleFrom: 1.0
scaleTo: 0.8
alpha: 0.4
drawUnderUnits: true
ySpeedRelative:-0.4
atmospheric: true

[attack]
canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits:   false
canAttackUnderwaterUnits: false

maxAttackRange: 200
shootDelay: 35

turretRotateWithBody: true
isFixedFiring: true

aimOffsetSpread: 0

[turret_1]
invisible: true
x: 0
y: 0
idleDir:0

projectile: 1
size: 10
turnSpeed: 5
turnSpeedAcceleration: 0.5

canShoot: false

[turret_2]
x: 6
y: 13
projectile: 1
size: 1
attachedTo: 1
slave: true

altProjectile: 1-2
altProjectileCondition: if attacking.shield < attacking.hp/2.5

turnSpeed: 0
turnSpeedAcceleration: 1

shoot_sound:large_gun_fire2
shoot_sound_vol:0.3
shoot_flame: shockwave
shoot_light: #000000

[turret_3]
x: -7
y: 13
copyFrom: 2
linkDelayWithTurret: 2


[turret_4]
x: 11.5
y: 16
projectile: 4
attachedTo: 1
slave: true
size: 1
canShoot: false
aimOffsetSpread: 0

limitingMinRange: 270
canAttackCondition: if attacking == activeWaypointTarget or not self.hasActiveWaypoint(type='attack') or distanceBetween(attacking, activeWaypointTarget)>600

turnSpeed: 0
turnSpeedAcceleration: 1

shoot_sound: tank_firing
shoot_sound_vol: 1.5
shoot_flame: shockwave
shoot_light: #000000

warmup: 20
chargeEffectImage: start.png
energyUsage: 1

[turret_5]
x: -11.5
y: 16
copyFrom: 4

[turret_4-近]
x: 11.5
y: 16
copyFrom: 4
limitingRange: 270
limitingMinRange: 0
warmup: 0

[turret_5-近]
x: -11.5
y: 16
copyFrom: 4-近

[projectile_1]
tags= T-projectile
areaDamage: 50
areaRadius: 60
life: 1
speed: 1
frame: 5
drawSize: 1

lightColor: #000000
lightSize: 0.3

autoTargetingOnDeadTarget:true

spawnProjectilesOnEndOfLife: 2*5

[projectile_2]
tags= T-projectile
areaDamage: 0
areaRadius: 25
armourIgnoreAmount: 5
life: 16
speed: 5
frame: 5
drawSize: 1
explodeOnEndOfLife: true

wobbleAmplitude: 2.5
wobbleFrequency: 5s

color: #000000

lightColor: #000000
lightSize: 0.3

pushForce: 2
pushVelocity: 0.6

largeHitEffect:true
explodeEffectOnShield: 电流波, 电光

autoTargetingOnDeadTarget:true

spawnProjectilesOnExplode: 3

[projectile_3]
tags= T-projectile
directDamage: 10

life: 15
instant: true
lightingEffect: true

shieldDefectionMultiplier: 0
buildingDamageMultiplier: 0.5

largeHitEffect:true

effectOnCreate:CUSTOM:lightingburst
explodeEffectOnShield: lightningShock, sparks

[effect_lightingburst]
life:0
alsoPlaySound:lighting_burst:0.1



[projectile_1-2]
@copyFromSection: projectile_1
spawnProjectilesOnEndOfLife: 2-2*5


[projectile_2-2]
@copyFromSection: projectile_2
areaRadius: 45
speed: 6
pushVelocity: 1
explodeOnEndOfLife: false
explodeEffectOnShield: shockwave
spawnProjectilesOnEndOfLife: 2-3
spawnProjectilesOnExplode: 2D(recursionLimit=99)

[projectile_2-3]
@copyFromSection: projectile_2-2
pushVelocity: 0.4
spawnProjectilesOnEndOfLife: 2-4

[projectile_2-4]
@copyFromSection: projectile_2-2
pushVelocity: 0.1
spawnProjectilesOnEndOfLife: 2-5(recursionLimit=5)

[projectile_2-5]
@copyFromSection: projectile_2-2
life: 200
pushVelocity: 0

[projectile_2D]
@copyFromSection: projectile_2
areaDamage: 15
areaRadius: 45
life: 16
speed: 999
pushVelocity: 0
targetGround: true
targetGround_includeTargetHeight: true
explodeEffect: NONE
explodeEffectOnShield: NONE
spawnProjectilesOnExplode: NONE



[projectile_4]
tags= T-projectile
directDamage: 155
life: 200
speed: 10
targetSpeed: 17
frame: 5
drawSize: 0.8

color: #C8000000
lightColor: #000000
lightSize: 0.3

shieldDamageMultiplier: 0.5

trailEffect: CUSTOM:尾光, CUSTOM:暗线
trailEffectRate: 0.5

explodeEffect: CUSTOM:projectilePassThough, CUSTOM:shockwave2, CUSTOM:hitLightFlash
explodeEffectOnShield: CUSTOM:shockwave2, CUSTOM:hitLightFlash

effectOnCreate: CUSTOM:projectileLight
spawnProjectilesOnExplode: 爆炸效果

spawnUnit: 堕黯



[effect_lightningShock]
life: 50

hOffset: 0
dirOffset: 0

fadeInTime: 0
fadeOut: false

attachedToUnit: true

alpha: 0.3
image: SHARED:lightning_shock.png
total_frames: 14
animateFrameStart: 0
animateFrameEnd: 13
animateFramePingPong: false
animateFrameSpeed: 0.6
priority: low

[effect_sparks]
attachedToUnit: false
life: 150
physics: true
xSpeedRelativeRandom: 1.6
ySpeedRelativeRandom: 1.6
hSpeed: 3
image: SHARED:spark.png
priority: verylow

[effect_电流波]
priority: low
stripIndex: shockwave
attachedToUnit: false
life: 25
scaleFrom: 0
scaleTo: 1
alpha: 0.8
color: #BAE7E8

[effect_电光]
priority:verylow
image: SHARED:light_50.png
life: 20
fadeOut: true
attachedToUnit: false
color: #63e6e8
fadeInTime:2
scaleFrom: 0.6
scaleTo: 0.6
alpha: 0.5
drawUnderUnits:false
liveAfterAttachedDies: false



[effect_尾光]
createWhenZoomedOut: false
priority: verylow
image: SHARED:light_50.png
life: 15
fadeOut: true
attachedToUnit: false
scaleFrom: 0.5
scaleTo: 0.4
alpha: 0.2
color:#0F0F0F
drawUnderUnits: true
ySpeedRelative:-0.4
atmospheric: true

[effect_暗线]
color: #000000
createWhenZoomedOut: false
priority: low
image: 白光.png
life: 15
fadeOut: true
attachedToUnit: false
scaleFrom: 0.8
scaleTo: 0.8
alpha: 0.1
drawUnderUnits: true
atmospheric: true

[effect_projectileLight]
priority:veryhigh

image: SHARED:light_50.png
life: 30
fadeOut: true
attachedToUnit: true
color: #000000
fadeInTime:2
scaleFrom: 0.6
scaleTo: 0.6
alpha: 0.5
drawUnderUnits:false
liveAfterAttachedDies: false

[effect_hitLightFlash]
priority:high

image: SHARED:light_50.png
life: 20
fadeOut: true
attachedToUnit: false
color: #000000

scaleFrom: 1.8
scaleTo: 1.8
alpha: 0.3
drawUnderUnits:false

[effect_projectilePassThough]

priority:high
frameIndex: 4
stripIndex: projectiles2
life: 20
fadeOut: true
attachedToUnit: false
color: #000000
scaleFrom: 0.8
scaleTo: 0.5
alpha: 0.9
drawUnderUnits:false
ySpeedRelative:2
atmospheric: true

[effect_shockwave]
stripIndex: shockwave
life: 30
scaleFrom: 0
scaleTo: 1
alpha: 0.6
color: #0F0F0F
dirSpeedRandom: 5

[effect_shockwave2]
@copyFromSection: effect_shockwave
life: 25
scaleFrom: 0
scaleTo: 2

[projectile_爆炸效果]
tags= T-projectile
directDamage:0
largeHitEffect: true
life:10
invisible:true
instant:true
explodeEffectOnShield:NONE

[turret_magic]
invisible: true
x: 0
y: 0
canShoot: false

[projectile_射线]
tags= T-projectile
spawnProjectilesOnCreate: 射线*1(recursionLimit=10), 堕
directDamage:80
life:90
speed:8
speedSpread:2
targetGround:true
targetGroundSpread:1600
areaHitAirAndLandAtSameTime:true
explodeOnEndOfLife:true
explodeEffect: CUSTOM:shockwave
trailEffect: CUSTOM:射线
trailEffectRate: 2
image: 紫光.png
color: #000000
retargetingInFlight: true
retargetingInFlightSearchDelay: 0
retargetingInFlightSearchRange: 20

shieldDefectionMultiplier: -1

[projectile_堕]
tags= T-projectile
areaDamage:200
areaRadius:75
life:0
explodeOnEndOfLife:true
areaHitAirAndLandAtSameTime:true
deflectionPower: -1
explodeEffect:NONE
explodeEffectOnShield:NONE

[effect_射线]
color: #000000
createWhenZoomedOut: false
priority:low
image: 白光.png
life: 80
fadeOut: true
attachedToUnit: false
fadeInTime:2
scaleFrom: 1.2
scaleTo: 1.0
alpha: 1
drawUnderUnits: true
ySpeedRelative:-0.4
atmospheric: true

[effect_blackwave]
stripIndex: shockwave
life: 60
scaleFrom: 0
scaleTo: 3.3
alpha: 2.0
color: #000000
attachedToUnit:true
[effect_blackwave2]
stripIndex: shockwave2
life: 60
scaleFrom: 0
scaleTo: 3.3
alpha: 2.0
color: #000000
attachedToUnit:true

[effect_blacklight]
image:SHARED:light_50.png
life:65
fadeOut:true
attachedToUnit:true
color:#000000
scaleFrom:3.3
scaleTo:1.6
alpha:3

[movement]
movementType: AIR
moveSpeed: 2.3
moveAccelerationSpeed: 0.1
moveDecelerationSpeed: 0.1

maxTurnSpeed: 5.0
turnAcceleration: 0.3

reverseSpeedPercentage: 0.8

targetHeight: 20
targetHeightDrift: 1

moveSlidingMode :true
moveIgnoringBody:true
moveSlidingDir:  181

slowDeathFall: true
