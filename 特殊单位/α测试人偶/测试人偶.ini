
[core]
name: 测试人偶
displayText: 测试人偶
displayDescription: -沙盒特供 \n -测试单位伤害 \n -注意: 能量为0时无敌并且不能转换建筑模式 \n -不会受到漂浮灵的伤害或治疗

class: CustomUnitMetadata
price: 0
maxHp: 1000000
#armour: 0
mass: 1000000
tags: 测试人偶, units

#selfRegenRate: 0

maxShield: 1000000
shieldRegen: 0
startShieldAtZero: true

energyMax: 60
energyRegen: -0.01666666
energyStartingPercentage: 0

fogOfWarSightRange: 15

#experimental: false

techLevel: 1
buildSpeed: 20s

radius: 10
displayRadius: 15
uiTargetRadius: 15
softCollisionOnAll: 0

isBio: false
#isBuilding: true

transportSlotsNeeded: 1

#unitsSpawnedOnDeath: 死亡生成单位

#nukeOnDeath: false

builtFrom_1_name: NONE
builtFrom_1_pos:  1
builtFrom_2_name: NONE
builtFrom_2_pos:  100

autoTriggerCooldownTime: 0.1s

showActionsWithMixedSelectionIfOtherUnitsHaveTag: 测试人偶

[action_打开设置列表]
autoTriggerOnEvent: created
isVisible: if not self.hasFlag(id=1)
isGuiBlinking: true
addResources: setFlag=1
pos: 0
id: 打开设置列表
text: 设置列表
description: 打开设置列表
displayType: infoOnly
buildSpeed: 0s
alwaysSinglePress: true

[action_关闭设置列表]
isVisible: if self.hasFlag(id=1)
addResources: unsetFlag=1
pos: 0
id: 关闭设置列表
text: 设置列表
description: 关闭设置列表
displayType: infoOnly
buildSpeed: 0s
alwaysSinglePress: true

[action_LAND,BUILDING]
isVisible: if self.hasFlag(id=1)
convertTo: 测试人偶[陆地,建筑]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
displayType: action
id: 陆地建筑
text: 建筑化
description: -转换为陆地建筑
buildSpeed: 0.1s
pos: 0.1

[action_AIR,BUILDING]
isVisible: false
convertTo: 测试人偶[飞行,建筑]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
displayType: action
id: 空中建筑
text: 建筑化
description: -转换为空中建筑
buildSpeed: 0.1s
pos: 0.1

[action_WATER,BUILDING]
isVisible: false
convertTo: 测试人偶[下潜,建筑]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
displayType: action
id: 下潜建筑
text: 建筑化
description: -转换为下潜建筑
buildSpeed: 0.1s
pos: 0.1


[action_LAND]
isVisible: if self.hasFlag(id=1)
isActive: false
convertTo: 测试人偶
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
displayType: action
isGuiBlinking: true
id: 陆地
text: 陆地
description: -转换为陆
buildSpeed: 0.1s
pos: 1

[action_AIR]
isVisible: if self.hasFlag(id=1)
convertTo: 测试人偶[飞行]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
displayType: action
id: 空中
text: 空中
description: -转换为空
buildSpeed: 0.1s
pos: 2

[action_WATER]
isVisible: if self.hasFlag(id=1)
convertTo: 测试人偶[下潜]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
displayType: action
id: 下潜
text: 下潜
description: -转换为潜
buildSpeed: 0.1s
pos: 3


[action_HP]
isVisible: if self.hasFlag(id=1)
iconImage: +.png
displayType: action
addResources: hp=1000000
id: 血量恢复
text: 血量恢复
description: -回复1000000血量
buildSpeed: 0s
pos: 4
spawnEffects: CUSTOM: HP+
setResourcesWithLogic: 计时血量=self.hp, 最终血量=self.hp

[action_add-shield]
isVisible: if self.hasFlag(id=1) and not self.hasFlag(id=2)
iconImage: shield_mid.png
displayType: action
addResources: shield=1000000, setFlag=2
id: ${section.text}
text: 护盾展开
description: -添加1000000护盾
buildSpeed: 0s
pos: 4.1
setResourcesWithLogic: 计时护盾=self.shield, 最终护盾=self.shield

[action_remove-shield]
isVisible: if self.hasFlag(id=1) and self.hasFlag(id=2)
iconImage: C.png
displayType: action
addResources: shield=-1000000, unsetFlag=2
id: ${section.text}
text: 护盾关闭
description: -消除1000000护盾
buildSpeed: 0s
pos: 4.1
setResourcesWithLogic: 计时护盾=self.shield, 最终护盾=self.shield

[action_计时]
isVisible: if self.hasFlag(id=1)
iconImage: 铂金表.png
displayType: action
addResources: 计时量=10
id: 计时
text: 计时
description: -添加10能量 \n -能量每秒减少1
buildSpeed: 0s
pos: 4.2
spawnEffects: CUSTOM: 计时
alsoTriggerAction: 计时增加
isLocked: if self.energy > 50 or self.resource.计时量 > 50 and not self.hasFlag(id=4)
isLockedMessage: 最多计时60s

[action_秒伤]
isVisible: if self.hasFlag(id=1)
iconImage: 金表.png
displayType: infoOnly
id: 每秒伤害
text: 每秒伤害: %{((self.resource.计时血量 - self.resource.最终血量) + self.resource.计时护盾 - self.resource.最终护盾) / self.resource.显示计数}
description: -计时期间每秒受到的平均伤害
buildSpeed: 0s
pos: 4.3

[action_秒伤2]
isVisible: if self.hasFlag(id=1) and self.resource.计时护盾>0
displayType: infoOnly
id: 每秒伤害2
text: (%{(self.resource.计时血量 - self.resource.最终血量) / self.resource.显示计数}，%{(self.resource.计时护盾 - self.resource.最终护盾) / self.resource.显示计数})
description: -计时期间血量与护盾分别受到的每秒伤害
buildSpeed: 0s
pos: 4.4

[action_受伤计时开]
id: 受伤计时开
text: 受伤时开始计时
description: -是
displayType: infoOnly
pos: 4.5
buildSpeed: 0s
isGuiBlinking: true
iconImage: SHARED:icon_on.png
isVisible: if not self.hasFlag(id=3) and self.resource.计时量>0
addResources: setFlag=3

[action_受伤计时关]
@copyFromSection: action_受伤计时开
id: 受伤计时关
description: -否
isGuiBlinking: false
iconImage: SHARED:icon_off.png
addResources: unsetFlag=3
isVisible: if self.hasFlag(id=3) and self.resource.计时量>0

[hiddenAction_test]
autoTrigger: if self.energy(empty=true) and (self.hasFlag(id=4) or self.resource.计时量<=0)
convertTo: 测试人偶[陆地,无敌]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
isVisible: false
setResourcesWithLogic: 最终血量=self.hp, 最终护盾=self.shield, 计数=self.resource.计时量, 显示计数=self.resource.计时量

[hiddenAction_受击显示]
autoTriggerOnEvent: tookDamage
setResourcesWithLogic: 最终血量=self.hp, 最终护盾=self.shield, 显示计数=max(self.resource.计数, 1)
alsoTriggerAction: 计时开始

[hiddenAction_计时增加]
requireConditional: if self.hasFlag(id=4)
addResources: energy=10

[hiddenAction_计时开始]
autoTrigger: if self.hasFlag(id=3) and not self.hasFlag(id=4)
requireConditional: if not self.hasFlag(id=4)
setResourcesWithLogic: energy=self.resource.计时量
addResources: setFlag=4

[hiddenAction_计数]
autoTrigger: if not self.energy(empty=true)
setResourcesWithLogic: 计数=max(self.resource.计时量 - self.energy, 1)

[effect_HP+]
life: 60
image: +.png
scaleFrom: 0
scaleTo: 2
alpha: 1
fadeOut: true

[effect_计时]
life: 60
image: 铂金表.png
scaleFrom: 0
scaleTo: 2
alpha: 1
fadeOut: true

[resource_计时量]
displayName: 计时量

[resource_计数]
displayName: 计数

[resource_显示计数]
displayName: 显示计数

[resource_计时血量]
displayName: 计时血量

[resource_最终血量]
displayName: 最终血量

[resource_计时护盾]
displayName: 计时护盾

[resource_最终护盾]
displayName: 最终护盾

[graphics]
total_frames: 1

image: body.png
image_wreak: NONE
image_turret: NONE
#image_shield: NONE

image_shadow: AUTO
shadowOffsetX: 0
shadowOffsetY: 5

[attack]
canAttack: false
canAttackFlyingUnits: false
canAttackLandUnits:   false
canAttackUnderwaterUnits: false

turretSize: 0
turretTurnSpeed: 0

maxAttackRange: 0
shootDelay: 0

[leg_1]
x: -8
y: 0
attach_x: -3
attach_y: 0
moveSpeed: 2.8
moveWarmUp: 0.1s
rotateSpeed: 7

heightSpeed: 0.65
resetAngle: 25

image_leg:  leg.png
image_foot: foot.png
#draw_foot_on_top: true
dust_effect: false

holdDisMin: 5
holdDisMax: 20

[leg_2]
x: 8
y: 0
attach_x: 3
attach_y: 0
copyFrom: 1

[movement]
movementType: OVER_CLIFF_WATER
moveSpeed: 0
moveAccelerationSpeed: 1
moveDecelerationSpeed: 1

reverseSpeedPercentage: 1

maxTurnSpeed: 0
turnAcceleration: 0

targetHeight: 0
targetHeightDrift: 0

moveSlidingDir: 0

moveSlidingMode: false
moveIgnoringBody: false