
[core]
name: 传奇炮塔师
displayDescription: -拥有高度智能的改装机械师 \n -它记载了所有炮塔的档案,包括一些被废弃的 \n (密令单位)
class: CustomUnitMetadata

price: 10000
maxHp: 2500
mass: 20000
tags: units, 传奇炮塔师

techLevel: 1

buildSpeed: 0.0002
availableInDemo: false

selfRegenRate: 0.08

radius: 19
displayRadius: 22

fogOfWarSightRange: 28

isBio: false
isBuilder: true

isPickableStartingUnit:	true

canRepairBuildings: true
canRepairUnits : true

canReclaimResources: true

transportSlotsNeeded: 2

generation_credits: 20
generation_delay: 40
borrowResourcesWhileAlive: 经济=-${core.generation_credits}

nanoRange: 160
nanoBuildSpeed: 4

autoTriggerCooldownTime: 0.1s

[global_resource_经济]
hidden: true

[hiddenAction_破碎之星]
autoTriggerOnEvent: destroyed
requireConditional: if self.hasResources(起始基地=1)
spawnUnits: 碎星核, 基地亡语

[resource_起始基地]
displayName: 起始基地

[hiddenAction_completeAndActive]
autoTrigger: if not self.globalTeamTags(includes='出场')
addGlobalTeamTags: 出场
offsetSelfAbsolute: 0, 0, 1500
spawnEffects: CUSTOM:shield*1

[hiddenAction_exhaustGas]
autoTrigger: true
spawnEffects: CUSTOM:wasteGas*1

[action_Upgrade]
convertTo: 传奇炮塔师T2
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
price: 30000
text: 升级
id: ${section.text}
displayType:upgrade
buildSpeed: 33.3s
pos: 100
description: -全面加强
descriptionAddUnitStats: ${section.convertTo}
iconExtraImage:SHARED:icon_upgrade_top.png
iconExtraColor:#AAFFFFFF
whenBuilding_cannotMove: true
whenBuilding_rotateTo: 0
whenBuilding_rotateTo_orBackwards: true
spawnUnits: 炮塔师无人机

[canBuild_1]
name: reclaim, repair
pos:  -1

[action_构建遗迹导弹堡垒]
isVisible: if not self.hasFlag(id=0)
pos: 0.15
displayType: action
buildSpeed: 0s
id: 构建遗迹导弹堡垒
@define units: 遗迹导弹堡垒
guiBuildUnit: ${units}
unitShownInUI: ${units}
textAddUnitName: ${units}
descriptionAddFromUnit: ${units}
descriptionAddUnitStats: ${units}
fireTurretXAtGround: 1
fireTurretXAtGround_withProjectile: 遗迹导弹构建位
fireTurretXAtGround_withTarget: thisActionTarget
addWaypoint_type: build
addWaypoint_unitType: 遗迹导弹堡垒
addWaypoint_prepend: true
addWaypoint_target_mapMustBeReachable: true
addWaypoint_position_fromAction: true
addActionCooldownTime: 0.1s
clearAllWaypoints: true
alwaysSinglePress: true
highPriorityQueue: true

[hiddenAction_遗迹导弹构建完成]
autoTriggerOnEvent: newMessage(withTag="构建完成")
addResources: setFlag=0

[action_打开杂项建筑列表]
isVisible: if not self.hasFlag(id=1)
addResources: setFlag=1
pos: 0
text: 杂项建筑
id: ${section.description}
description: 打开杂项建筑列表
displayType: infoOnly
buildSpeed: 0s
alwaysSinglePress: true
highPriorityQueue: true

[action_关闭杂项建筑列表]
isVisible: if self.hasFlag(id=1)
isGuiBlinking: true
addResources: unsetFlag=1
pos: 0
text: 杂项建筑
id: ${section.description}
description: 关闭杂项建筑列表
displayType: infoOnly
buildSpeed: 0s
alwaysSinglePress: true
highPriorityQueue: true

[canBuild_2]
#杂项建筑
isVisible: if self.hasFlag(id=1)
name: 墙, 资源抽取器T1, 地幔涌动, repairBay, laserDefence, outpostT1, 资源制造仪T1
pos:  0.01

[action_打开T1炮塔列表]
isVisible: if not self.hasFlag(id=2)
addResources: setFlag=2
pos: 0.1
text: T1炮塔
id: ${section.description}
description: 打开T1炮塔列表
displayType: infoOnly
buildSpeed: 0s
alwaysSinglePress: true
highPriorityQueue: true

[action_关闭T1炮塔列表]
isVisible: if self.hasFlag(id=2)
isGuiBlinking: true
addResources: unsetFlag=2
pos: 0.1
text: T1炮塔
id: ${section.description}
description: 关闭T1炮塔列表
displayType: infoOnly
buildSpeed: 0s
alwaysSinglePress: true
highPriorityQueue: true

[canBuild_3]
#T1炮塔
isVisible: if self.hasFlag(id=2)
name: 哨炮, turret, antiAirTurret
pos:  0.11

[action_解锁T2炮塔列表]
isVisible: if not self.globalTeamTags(includes='T2炮塔')
addGlobalTeamTags: T2炮塔
pos: 0.2
price: 2000
text: 解锁 - T2炮塔
id: ${section.description}
description: 解锁T2炮塔列表
displayType: upgrade
buildSpeed: 27.8s
allowMultipleInQueue: false
spawnUnits: 炮塔师无人机

[action_打开T2炮塔列表]
isVisible: if not self.hasFlag(id=3) and self.globalTeamTags(includes='T2炮塔')
addResources: setFlag=3
pos: 0.2
text: T2炮塔
id: ${section.description}
description: 打开T2炮塔列表
displayType: infoOnly
buildSpeed: 0s
alwaysSinglePress: true
highPriorityQueue: true

[action_关闭T2炮塔列表]
isVisible: if self.hasFlag(id=3) and self.globalTeamTags(includes='T2炮塔')
isGuiBlinking: true
addResources: unsetFlag=3
pos: 0.2
text: T2炮塔
id: ${section.description}
description: 关闭T2炮塔列表
displayType: infoOnly
buildSpeed: 0s
alwaysSinglePress: true
highPriorityQueue: true

[canBuild_4]
#T2炮塔
isVisible: if self.hasFlag(id=3)
name: c_turret_t2_gun, c_turret_t2_flame, c_turret_t1_lightning, c_turret_β_lightning, c_turret_t1_artillery, c_antiAirTurretT2, antiAirTurretFlak
pos:  0.21

[action_解锁T3炮塔列表]
isVisible: if not self.globalTeamTags(includes='T3炮塔')
addGlobalTeamTags: T3炮塔
pos: 0.3
price: 5500
text: 解锁 - T3炮塔
id: ${section.description}
description: 解锁T3炮塔列表
displayType: upgrade
buildSpeed: 66.7s
allowMultipleInQueue: false
spawnUnits: 炮塔师无人机

[action_打开T3炮塔列表]
isVisible: if not self.hasFlag(id=4) and self.globalTeamTags(includes='T3炮塔')
addResources: setFlag=4
pos: 0.3
text: T3炮塔
id: ${section.description}
description: 打开T3炮塔列表
displayType: infoOnly
buildSpeed: 0s
alwaysSinglePress: true
highPriorityQueue: true

[action_关闭T3炮塔列表]
isVisible: if self.hasFlag(id=4) and self.globalTeamTags(includes='T3炮塔')
isGuiBlinking: true
addResources: unsetFlag=4
pos: 0.3
text: T3炮塔
id: ${section.description}
description: 关闭T3炮塔列表
displayType: infoOnly
buildSpeed: 0s
alwaysSinglePress: true
highPriorityQueue: true

[canBuild_5]
#T3炮塔
isVisible: if self.hasFlag(id=4)
name: c_turret_t3_gun, 机枪塔 初代, 火焰喷射器T2, c_turret_t2_lightning, c_turret_t2_artillery, 超新星狙击炮, c_antiAirTurretT3, antiAirTurretFlakT2
pos:  0.31

[action_解锁T4炮塔列表]
isVisible: if not self.globalTeamTags(includes='T4炮塔')
addGlobalTeamTags: T4炮塔
pos: 0.4
price: 7500
text: 解锁 - T4炮塔
id: ${section.description}
description: 解锁T4炮塔列表
displayType: upgrade
buildSpeed: 66.7s
allowMultipleInQueue: false
spawnUnits: 炮塔师无人机

[action_打开T4炮塔列表]
isVisible: if not self.hasFlag(id=5) and self.globalTeamTags(includes='T4炮塔')
addResources: setFlag=5
pos: 0.4
text: T4炮塔
id: ${section.description}
description: 打开T4炮塔列表
displayType: infoOnly
buildSpeed: 0s
alwaysSinglePress: true
highPriorityQueue: true

[action_关闭T4炮塔列表]
isVisible: if self.hasFlag(id=5) and self.globalTeamTags(includes='T4炮塔')
isGuiBlinking: true
addResources: unsetFlag=5
pos: 0.4
text: T4炮塔
id: ${section.description}
description: 关闭T4炮塔列表
displayType: infoOnly
buildSpeed: 0s
alwaysSinglePress: true
highPriorityQueue: true

[canBuild_6]
#T4炮塔
isVisible: if self.hasFlag(id=5)
name: c_turret_t4_gun, c_turret_t3_artillery, c_antiAirTurretT4, c_antiAirTurretX, 遗迹导弹堡垒
pos:  0.41

[action_解锁中心防御列表]
isVisible: if not self.globalTeamTags(includes='中心防御')
addGlobalTeamTags: 中心防御
pos: 0.5
price: 10000
text: 解锁 - 中心防御
id: ${section.description}
description: 解锁中心防御列表
displayType: upgrade
buildSpeed: 83.3s
allowMultipleInQueue: false
spawnUnits: 炮塔师无人机

[action_打开中心防御列表]
isVisible: if not self.hasFlag(id=6) and self.globalTeamTags(includes='中心防御')
addResources: setFlag=6
pos: 0.5
text: 中心防御
id: ${section.description}
description: 打开中心防御列表
displayType: infoOnly
buildSpeed: 0s
alwaysSinglePress: true
highPriorityQueue: true

[action_关闭中心防御列表]
isVisible: if self.hasFlag(id=6) and self.globalTeamTags(includes='中心防御')
isGuiBlinking: true
addResources: unsetFlag=6
pos: 0.5
text: 中心防御
id: ${section.description}
description: 关闭中心防御列表
displayType: infoOnly
buildSpeed: 0s
alwaysSinglePress: true
highPriorityQueue: true

[canBuild_7]
#中心防御
isVisible: if self.hasFlag(id=6)
name: 中心机炮壁垒, 中心火炮堡垒, 中心蜂巢壁垒, 中心禁空壁垒
pos:  0.51

[action_解锁核武器列表]
isVisible: if not self.globalTeamTags(includes='核武器')
addGlobalTeamTags: 核武器
pos: 0.6
price: 5000
text: 解锁 - 核武器
id: ${section.description}
description: 解锁核武器列表
displayType: upgrade
buildSpeed: 55.6s
allowMultipleInQueue: false
spawnUnits: 炮塔师无人机

[action_打开核武器列表]
isVisible: if not self.hasFlag(id=7) and self.globalTeamTags(includes='核武器')
addResources: setFlag=7
pos: 0.6
text: 核武器
id: ${section.description}
description: 打开核武器列表
displayType: infoOnly
buildSpeed: 0s
alwaysSinglePress: true
highPriorityQueue: true

[action_关闭核武器列表]
isVisible: if self.hasFlag(id=7) and self.globalTeamTags(includes='核武器')
isGuiBlinking: true
addResources: unsetFlag=7
pos: 0.6
text: 核武器
id: ${section.description}
description: 关闭核武器列表
displayType: infoOnly
buildSpeed: 0s
alwaysSinglePress: true
highPriorityQueue: true

[canBuild_8]
#核武器
isVisible: if self.hasFlag(id=7)
name: 核弹发射井, antiNukeLauncherC
pos:  0.61

[action_解锁魔素建筑列表]
isVisible: if not self.globalTeamTags(includes='魔素建筑')
addGlobalTeamTags: 魔素建筑
pos: 0.7
price: 22500
text: 解锁 - 魔素建筑
id: ${section.description}
description: 解锁魔素建筑列表
displayType: upgrade
buildSpeed: 300s
allowMultipleInQueue: false
spawnUnits: 炮塔师无人机

[action_打开魔素建筑列表]
isVisible: if not self.hasFlag(id=8) and self.globalTeamTags(includes='魔素建筑')
addResources: setFlag=8
pos: 0.7
text: 魔素建筑
id: ${section.description}
description: 打开魔素建筑列表
displayType: infoOnly
buildSpeed: 0s
alwaysSinglePress: true
highPriorityQueue: true

[action_关闭魔素建筑列表]
isVisible: if self.hasFlag(id=8) and self.globalTeamTags(includes='魔素建筑')
isGuiBlinking: true
addResources: unsetFlag=8
pos: 0.7
text: 魔素建筑
id: ${section.description}
description: 关闭魔素建筑列表
displayType: infoOnly
buildSpeed: 0s
alwaysSinglePress: true
highPriorityQueue: true

[canBuild_9]
#魔素建筑
isVisible: if self.hasFlag(id=8)
name: 核弹发射井 初代
pos:  0.71

[canBuild_20]
#供应站
isVisible: if self.hasFlag(id=1)
isLocked: if numberOfUnitsInTeam(withTag='供应站', greaterThan=0, incompleteBuildings=true)
isLockedMessage:只能建造一个供应站
name: 供应站
pos:  0.02

[canBuild_21]
isVisible: if self.hasFlag(id=1)
name: 研发中心
pos:  0.03
isLocked: if numberOfUnitsInTeam(withTag='研究所', greaterThan=0, incompleteBuildings=true)
isLockedMessage: 只能建造一个研究所

[canBuild_恐虐传送门]
isVisible: if self.hasResources(混沌元素=1)
name: 亚空间水晶
pos: 99

[graphics]

total_frames: 1
image:        base.png
image_wreak:  base_dead.png
image_turret: NONE
#scaleImagesTo: 20
#scaleTurretImagesTo: 9

#AUTO
image_shadow: AUTO
shadowOffsetX:2
shadowOffsetY:2

showTransportBar: false


[attack]

canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits:   true
canAttackUnderwaterUnits: false

isFixedFiring: true

turretSize: 8
turretTurnSpeed: 3


maxAttackRange: 160
shootDelay: 50


turretRotateWithBody: false


[turret_1]
#nano turret (nano must be slot 1)
x: 0
y: 0
invisible: true
warmup:30

canShoot: false
canAttackFlyingUnits: false
canAttackLandUnits:   false
canAttackUnderwaterUnits: false

turnSpeedAcceleration: 0.08

limitingRange: 160


[turret_2]
x: 0
y: 0
invisible: true

shoot_sound:plasma_fire
shoot_sound_vol:0.07
shoot_flame:CUSTOM:soot*2

[projectile_1]
directDamage: 60
life: 70
speed: 7
frame: 11
color: #676767

largeHitEffect: true

lightColor: #676767
lightSize: 0.4

[projectile_遗迹导弹构建位]
life: 5
instant: true
invisible: true
deflectionPower: -1
directDamage: 0

explodeEffect: 方框展开

[effect_方框展开]
priority: high
attachedToUnit: false
drawUnderUnits: true
image: 方形.png
life: 20
fadeInTime: 10
scaleFrom: 0
scaleTo: 1
alpha: 0.6
fadeOut: false
alwayStartDirAtZero: true
alsoEmitEffectsOnDeath: 方框滞留

[effect_方框滞留]
priority: high
attachedToUnit: false
drawUnderUnits: true
image: 方形.png
life: 20
scaleFrom: 1
scaleTo: 1
alpha: 0.6
fadeOut: true

[movement]
movementType: OVER_CLIFF_WATER
moveSpeed: 0.85
moveAccelerationSpeed: 0.03
moveDecelerationSpeed: 0.07

maxTurnSpeed: 1.5
turnAcceleration: 1

moveSlidingMode :true
moveIgnoringBody:true
moveSlidingDir:  180


slowDeathFall: true

reverseSpeedPercentage:0.2



[ai]
useAsBuilder: true


[leg_1]
x: -15
y: 15
attach_x: -4
attach_y: 4
moveSpeed: 2.9

rotateSpeed: 9

heightSpeed: 0.8


resetAngle:25

image_leg:  leg.png
image_foot: foot.png

#draw_foot_on_top: true
dust_effect: true

holdDisMin: 17
holdDisMax: 50

hardLimit: 65

endDirOffset:135

favourOppositeSideNeighbours: true

holdDisMin_maxMovingLegs: 2


moveWarmUp:0.5

estimatingPositionMultiplier:0.8

[leg_2]
x: 15
y: 15
attach_x: 4
attach_y: 4
copyFrom: 1

endDirOffset:225




[leg_3]
x: -15
y: -15
attach_x: -4
attach_y: -4
copyFrom: 1
endDirOffset:45

[leg_4]
x: 15
y: -15
attach_x: 4
attach_y: -4
copyFrom: 1
endDirOffset:-45

[effect_soot]
stripIndex: effects
frameIndex: 0

life: 40
fadeOut: true
attachedToUnit: false
color: #676767
fadeInTime:3
hSpeed: 0.1
scaleFrom: 0.4
scaleTo: 1.1
alpha: 0.6
drawUnderUnits:false
#yOffsetRelative:-7
xOffsetRelativeRandom:1
xSpeedRelativeRandom:0.1
ySpeedRelative:0.8
ySpeedRelativeRandom:0.1

dirOffsetRandom: 180

shadow: true
atmospheric: true

[effect_wasteGas]
stripIndex: effects
frameIndex: 0
priority:low
spawnChance:0.1

life: 200
fadeOut: true
attachedToUnit: false
color: #676767
fadeInTime:5
hSpeed: 0.5
scaleFrom: 0.5
scaleTo: 3.0
alpha: 0.8
drawUnderUnits:false
yOffsetRelative:-3
xSpeedAbsolute:0.2

shadow: true
atmospheric: true

[effect_shield]
image: white_shield.png
life: 500
fadeOut: true
attachedToUnit: true
scaleFrom: 1.0
scaleTo: 0.8
alpha: 1.0
drawUnderUnits:false

showInFog: false


[global_resource_混沌元素]
hidden: false
displayName: 混沌元素
displayColor: #FF1A00
priority: 1