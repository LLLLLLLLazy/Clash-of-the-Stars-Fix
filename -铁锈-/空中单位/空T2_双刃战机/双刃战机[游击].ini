
[core]
name: 双刃战机[游击]
displayText: 双刃战机
displayDescription: -全副武装 \n -攻击地面与空中 \n -开火后需要装填 \n -位于空军基地旁会加速装填 \n -自我修复 \n -较远视野 \n -能够在两种形态之间改变

class: CustomUnitMetadata
price: 8500
maxHp: 2200
mass: 30000
tags: units

techLevel: 2
buildSpeed: 0.0003
availableInDemo: true

radius: 22
#displayRadius: 11
#softCollisionOnAll: 3

selfRegenRate: 0.06

energyMax: 25
energyRegen: 0.0175
energyNeedsToRechargeToFull: true

fogOfWarSightRange: 18

transportSlotsNeeded: 2

builtFrom_1_name: airFactory
builtFrom_1_pos:  9

autoTriggerCooldownTime: 0.1s

[action_trigger]
convertTo: 双刃战机[攻坚]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
displayType: action
text: 切换 - 攻坚
description:-切换至攻坚形态 \n -能量回复加快 \n -舍弃机动性,火力全开!  \n -此行为不可取消
descriptionAddUnitStats: ${section.convertTo}
buildSpeed: 0.0023
pos: 1

whenBuilding_cannotMove: true
whenBuilding_rotateTo: 0
whenBuilding_rotateTo_orBackwards: true

iconExtraImage: 切换.png
iconExtraColor:#FF0000FF

canPlayerCancel: false
highPriorityQueue: true
spawnEffects: CUSTOM:light

[action_switch1]
isVisible: if not self.hasFlag(id=1)
addResources: setFlag=1, unsetFlag=2
displayType: action
text: 自动攻击模式
pos: 2
description: -关闭时只会在获得攻击指令后开火
buildSpeed: 0s
iconImage: SHARED:icon_on.png
#alwaysSinglePress: true
highPriorityQueue: true
ai_isDisabled: true

[action_switch2]
@copyFromSection: action_switch1
isVisible: if self.hasFlag(id=1)
addResources: unsetFlag=1
iconImage: SHARED:icon_off.png


[action_弹药补给]
isVisible: true
isActive: false
text: 弹药补给
description: -游击时在空军基地T2可加快弹药装填
pos: 3
displayType: infoOnly
buildSpeed: 0s
iconExtraImage: 装填.png
isGuiBlinking: if numberOfUnitsInTeam(withTag="空军基地T2", greaterThan=0, withinRange=190) and (not self.isAttacking or self.isEnergyRecharging)
autoTrigger: if numberOfUnitsInTeam(withTag="空军基地T2", greaterThan=0, withinRange=190) and (not self.isAttacking or self.isEnergyRecharging)
addResources: energy=0.315


[hiddenAction_攻击指令]
autoTrigger: if self.hasFlag(id=1) and not self.hasFlag(id=2) and attacking == activeWaypointTarget and activeWaypointTarget != nullUnit
addResources: setFlag=2

[hiddenAction_停止攻击]
autoTrigger: if self.hasFlag(id=1) and self.hasFlag(id=2) and (attacking != activeWaypointTarget or activeWaypointTarget == nullUnit) and attacking == nullUnit
addResources: unsetFlag=2

[effect_light]
priority:high

image: SHARED:light_50.png
life: 30
fadeOut: true
attachedToUnit: false
color: #ffffff

scaleFrom: 2.0
scaleTo: 2.0
alpha: 1.0
drawUnderUnits:false

[graphics]
total_frames: 1

image:        形态一.png
image_wreak:  形态一残骸.png
image_turret: NONE
#scaleImagesTo: 20
#scaleTurretImagesTo: 9

image_shadow: AUTO
shadowOffsetX:1
shadowOffsetY:1

movementEffect: CUSTOM:fire,CUSTOM:fire2
movementEffectRate: 4

[effect_fire]
createWhenZoomedOut: false
priority:low

image: fire.png
life: 30
fadeOut: true
attachedToUnit: false
fadeInTime:1
scaleFrom: 1.0
scaleTo: 0.2
alpha: 0.8
drawUnderUnits:true
ySpeedRelative:-0.3
atmospheric: true

total_frames:4
animateFrameStart: 0
animateFrameEnd: 0

xOffsetRelative:-7
yOffsetRelative:-25

[effect_fire2]
createWhenZoomedOut: false
priority:low

image: fire.png
life: 30
fadeOut: true
attachedToUnit: false
fadeInTime:1
scaleFrom: 1.0
scaleTo: 0.2
alpha: 0.8
drawUnderUnits:true
ySpeedRelative:-0.3
atmospheric: true

total_frames:4
animateFrameStart: 0
animateFrameEnd: 0

xOffsetRelative:6
yOffsetRelative:-25

[attack]
canAttack: true
canAttackFlyingUnits: if self.flying
canAttackLandUnits:   if self.flying
canAttackUnderwaterUnits: false

turretSize: 1
turretTurnSpeed: 40

maxAttackRange: 190
shootDelay: 10

[turret_1]
invisible: true
x: -15
y: 8

shoot_sound: firing4
shoot_sound_vol: 0.1
#shoot_flame: small
#shoot_light: #FFccCCEE

projectile: 1

energyUsage: 1

canAttackCondition: if not self.hasFlag(id=1) or self.hasFlag(id=1) and self.hasFlag(id=2)

[turret_2]
x: 15
y: 8
copyFrom: 1
linkDelayWithTurret: 1
warmup: 4

[projectile_1]
tags= T-projectile
directDamage: 32
life: 90
speed: 5

color: #FF3BFF00
drawSize: 1.8

lightColor: #FF3BFF00 
lightSize: 0.6

[movement]
movementType: AIR
moveSpeed: 2.9
moveAccelerationSpeed: 0.01
moveDecelerationSpeed: 0.02

targetHeight: 22

landOnGround: onlyIdle

maxTurnSpeed: 1.7
turnAcceleration: 0.08

reverseSpeedPercentage: 0

moveSlidingMode :false
moveIgnoringBody:false
moveSlidingDir:  181

slowDeathFall: false