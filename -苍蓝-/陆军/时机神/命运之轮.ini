
[core]
name: 命运之轮
displayText: 命运之轮
displayDescription: -毁灭与再生
price: 0
maxHp: 2000
mass: 5000

tags=命运之轮

techLevel: 1
buildSpeed: 0.001

showInEditor: false

radius: 12
displayRadius: 18

transportSlotsNeeded: 99

canNotBeGivenOrdersByPlayer:true

fireTurretXAtSelfOnDeath: 分裂

autoTriggerCooldownTime: 0.1s

[hiddenAction_$运输]
@copyFrom_skipThisSection:true

[hiddenAction_创建时]
autoTriggerOnEvent: completeAndActive
addWaypoint_type: move
addWaypoint_maxTime: 1.5s
addWaypoint_position_relativeOffsetFromSelf: 0, 150

[hiddenAction_move]
autoTrigger: if not self.hasActiveWaypoint(type='touchTarget') and not self.hasActiveWaypoint(type='move')
addWaypoint_type: touchTarget
addWaypoint_prepend: true
addWaypoint_maxTime: 3s
addWaypoint_target_nearestUnit_tagged: 时机神
addWaypoint_target_nearestUnit_team: own
addWaypoint_target_nearestUnit_maxRange: 9999

[hiddenAction_过远距离传送]
autoTrigger: if numberOfUnitsInTeam(withTag="时机神", lessThan=1, withinRange=400) and self.hasTakenDamage>3
teleportTo: globalSearchForFirstUnit(withTag='时机神', relation='own')
spawnEffects: 命幻之曲2

[hiddenAction_recovery]
autoTriggerOnEvent: killedAnyUnit
requireConditional: if not eventSource.self.tags(includes="召唤物")
addResourcesWithLogic: credits=attacking.priceCredits*0.8

[hiddenAction_消逝]
autoTrigger: if numberOfUnitsInTeam(withTag="时机神", lessThan=1)
setResourcesWithLogic: hp=-99999

[hiddenAction_回收分裂]
autoTrigger: if customTarget1.hasActiveWaypoint(type='reclaim') and customTarget1.activeWaypointTarget==self and self.hp<600
fireTurretXAtGround: 分裂2
fireTurretXAtGround_withOffset: 0, 0
deleteSelf: true

[attachment_1]
x:0
y:0
isUnselectable: false
canBeAttackedAndDamaged: false
keepAliveWhenParentDies: false
setDrawLayerOnTop: false
addTransportedUnits: 1
#lockRotation: true
deattachIfWantingToMove: false
onCreateSpawnUnitOf: 修复

[arm_1]
x:0
y:0
image_end: 盘.png

drawOverBody: true

spinRate:2

[graphics]
total_frames: 1

image:        盘.png
image_wreak:  NONE
image_turret: NONE
#scaleImagesTo: 20
#scaleTurretImagesTo: 9

imageScale: 0.5

#AUTO
image_shadow: AUTO
shadowOffsetX:0
shadowOffsetY:0

movementEffect: CUSTOM:残影
movementEffectRate: 3

[effect_残影]
createWhenZoomedOut: false
priority: low
image: 盘.png
life: 36
fadeOut: true
attachedToUnit: false
fadeInTime: 2
scaleFrom: 0.5
scaleTo: 0.4
alpha: 0.5
drawUnderUnits: true
ySpeedRelative: -0.4
atmospheric: true

[attack]
canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits:   true
canAttackUnderwaterUnits: false

turretSize: 0
turretTurnSpeed: 9999

maxAttackRange: 220
shootDelay: 2

[turret_1]
x: 0
y: 0

[turret_2]
x: 0
y: 0

[turret_3]
x: 0
y: 0

[turret_4]
x: 0
y: 0

[turret_5]
x: 0
y: 0

[turret_分裂]
x: 0
y: 0
canShoot: false
projectile: 分裂位

[turret_分裂2]
@copyFromSection: turret_分裂
projectile: 分裂位2


[projectile_1]
life: 10

instant:true
instantReuseLast: true
instantReuseLast_alsoChangeTurretAim: true
moveWithParent: true

beamImage:      回收.png

explodeEffect: NONE
explodeEffectOnShield: NONE

sweepOffsetFromTargetRadius:0.6
sweepSpeed:15

directDamage: 1

shieldDefectionMultiplier: 0
shieldDamageMultiplier: 0

armourIgnoreAmount: 9999

#真实伤害
#mutatorX_ifUnitWithoutTags: NONE任意
#mutatorX_directDamageMultiplier: 0
#mutatorX_addResourcesDirectHit: hp=-1


[projectile_分裂位]
life: 0
directDamage: 0
explodeOnEndOfLife: true
deflectionPower: -1

explodeEffect: CUSTOM:转命光橙, CUSTOM:转命光紫, CUSTOM:命幻之曲
explodeEffectOnShield: CUSTOM:转命光橙, CUSTOM:转命光紫, CUSTOM:命幻之曲

spawnProjectilesOnExplode: 小命运之轮(offsetDir=45, xOffsetRelative=-5, yOffsetRelative=-5), 小命运之轮(offsetDir=135, xOffsetRelative=-5, yOffsetRelative=5), 小命运之轮(offsetDir=225, xOffsetRelative=5, yOffsetRelative=5), 小命运之轮(offsetDir=315, xOffsetRelative=5, yOffsetRelative=-5)

[projectile_分裂位2]
@copyFromSection: projectile_分裂位
spawnProjectilesOnExplode: 小命运之轮(offsetDir=45, xOffsetRelative=-5, yOffsetRelative=-5, spawnChance=0.5, maxSpawnLimit=2), 小命运之轮(offsetDir=135, xOffsetRelative=-5, yOffsetRelative=5, maxSpawnLimit=2), 小命运之轮(offsetDir=225, xOffsetRelative=5, yOffsetRelative=5, spawnChance=0.5, maxSpawnLimit=2), 小命运之轮(offsetDir=315, xOffsetRelative=5, yOffsetRelative=-5, maxSpawnLimit=2)

[projectile_小命运之轮]
life: 0
directDamage: 0
spawnUnit: 小命运之轮
explodeOnEndOfLife: true
deflectionPower: -1

[effect_转命光橙]
stripIndex: light_50
life: 100
scaleFrom: 2.5
scaleTo: 2.5
alpha: 1
fadeInTime: 20
color: #D99B00

xOffsetRelativeRandom: 10
yOffsetRelativeRandom: 10
xSpeedRelativeRandom: 0.2
ySpeedRelativeRandom: 0.2

[effect_转命光紫]
@copyFromSection: effect_转命光橙
color: #A95CFA

[effect_命幻之曲]
drawType: displacement

image: SHARED:shockwave_normal_128.png
life: 60
fadeOut: true
fadeInTime: 2
scaleFrom: 0.6
scaleTo: 0
alpha: 0.6
drawUnderUnits: false

dirOffsetRandom: 180
dirSpeedRandom: 1
dirSpeed: 2

[effect_命幻之曲2]
@copyFromSection: effect_命幻之曲
attachedToUnit: false
life: 30

[movement]
movementType: AIR
moveSpeed: 1.5
moveAccelerationSpeed: 0.005
moveDecelerationSpeed: 0

maxTurnSpeed: 3
turnAcceleration: 0.1

targetHeight: 10

moveSlidingMode :false
moveIgnoringBody:false

reverseSpeedPercentage:0

