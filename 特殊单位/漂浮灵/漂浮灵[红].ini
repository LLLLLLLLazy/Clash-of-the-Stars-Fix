
[core]
name: 漂浮灵[红]
displayText:漂浮灵
price: 0
maxHp: 75
mass: 80
#armour: 10
#armourMinDamageToKeep: 10
tags: 漂浮灵, 可承伤单位

selfRegenRate: 0.02

createOnAggressiveTeam:	true
isUnrepairableUnit:	true

displayDescription: -它不想放过坏人

techLevel: 1
buildSpeed: 0.0016
selfBuildRate: 0.0016

radius: 7
displayRadius: 7
isBio: true

showOnMinimap: false

hideScorchMark: true
explodeOnDeathGroundCollision: false

canNotBeGivenOrdersByPlayer: true

fireTurretXAtSelfOnDeath: 1

[hiddenAction_受伤]
autoTrigger: if not self.hp(full=true) and self.hasTakenDamage(withinSeconds=0.9)
playSoundAtUnit: 受伤害.wav:0.5

[hiddenAction_受损]
autoTrigger: if not self.hp(full=true) and self.hasTakenDamage(withinSeconds=1.1)
convertTo: 漂浮灵[红慢]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}

[hiddenAction_死亡]
autoTriggerOnEvent: destroyed
playSoundAtUnit: 被击杀.wav

[hiddenAction_游荡]
autoTrigger: if not self.isMoving
addWaypoint_type: move
addWaypoint_position_randomOffsetFromSelf: 300, 300
addWaypoint_target_mapMustBeReachable: true
addWaypoint_maxTime: 5s
#playSoundAtUnit: 空闲.wav
spawnEffects: CUSTOM:叮铃叮铃音效
fireTurretXAtGround: 1
fireTurretXAtGround_withOffset: 0,10
fireTurretXAtGround_withProjectile: 光空

[hiddenAction_回走检测]
autoTrigger: true
addWaypoint_type: touchTarget
addWaypoint_prepend: true
addWaypoint_target_nearestUnit_tagged: 漂浮灵出生
addWaypoint_target_nearestUnit_team: neutral
addWaypoint_target_nearestUnit_maxRange: 300
addWaypoint_triggerActionIfFailed: 回走
addWaypoint_maxTime: 0s

[hiddenAction_回走]
addWaypoint_type: touchTarget
clearAllWaypoints: true
addWaypoint_prepend: true
addWaypoint_target_nearestUnit_tagged: 漂浮灵出生
addWaypoint_target_nearestUnit_team: neutral
addWaypoint_target_nearestUnit_maxRange: 500
addWaypoint_maxTime: 5s
spawnEffects: CUSTOM:叮铃叮铃音效
fireTurretXAtGround: 1
fireTurretXAtGround_withOffset: 0,10
fireTurretXAtGround_withProjectile: 光空

[hiddenAction_边界消失]
autoTrigger: if not self.isOverPassableTile(type="AIR")
deleteSelf: true

[projectile_光空]
areaDamage:	0
invisible: true
life: 0
explodeEffect: NONE

#[projectile_叮铃叮铃随机弹]
#spawnProjectilesOnCreate: 叮铃叮铃音之出(spawnChance=0.0)
#areaDamage:	0
#life: 0

#[projectile_叮铃叮铃音之出]
#effectOnCreate: CUSTOM:叮铃叮铃音效
#areaDamage:	0
#life: 0

[effect_叮铃叮铃音效]
life: 0
spawnChance: 0.15
alsoPlaySound: 空闲.wav:0.3

[hiddenAction_赤魔]
autoTrigger: if numberOfUnitsInAllTeams(withTag="混沌元素", greaterThan=0)
convertTo: 漂浮灵[赤红]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}


[hiddenAction_毒素血量减血]
autoTrigger: if self.resource.毒素>0 and self.teamId==-2
addResourcesWithLogic: hp=-min(min(self.resource.毒素, 60), self.hp-0.1), 毒素=-min(min(self.resource.毒素, 60), max(self.hp-0.1, 15))

[hiddenAction_弱效毒素减血]
autoTrigger: if self.resource.弱效毒素>0 and self.resource.毒素<=0 and self.teamId==-2
addResourcesWithLogic: hp=-min(min(self.resource.毒素, 20), self.hp-0.1), 毒素=-min(min(self.resource.毒素, 20), max(self.hp-0.1, 5))

[resource_毒素]
displayName: 毒素

[resource_弱效毒素]
displayName: 弱效毒素

[graphics]
total_frames: 4
imageScale:	0.5
image:        红红妖精.png
image_wreak: 妖精尘.png
image_turret: NONE

#AUTO
image_shadow: AUTO_ANIMATED
shadowOffsetX: 0
shadowOffsetY: 0


animation_idle_start: 0
animation_idle_end: 3
animation_idle_speed: 3
animation_moving_start: 0
animation_moving_end: 3
animation_moving_speed: 3

[attack]
canAttack: false

[turret_1]
x: 0
y: 0
projectile: 1
shoot_light:#ff0000
limitingRange: ${projectile_1.areaRadius}
showRangeUIGuide: true

[projectile_1]
areaDamage:	500
areaRadius:	120
life: 0
areaExpandTime: 30
areaHitAirAndLandAtSameTime: true
explodeOnEndOfLife: true
lightColor: #ff0000

pushVelocity: 10

deflectionPower: -1

buildingDamageMultiplier: 0
mutator2_ifUnitWithTags: 测试人偶
mutator2_areaDamageMultiplier: 0

explodeEffect: CUSTOM:hitLightFlash, CUSTOM:波, CUSTOM:光冲
explodeEffectOnShield: CUSTOM:hitLightFlash, CUSTOM:波, CUSTOM:光冲

[effect_hitLightFlash]
priority:high
image: SHARED:light_50.png
life: 14
fadeOut: true
attachedToUnit: false
color: #ff0000
scaleFrom: 0.7
scaleTo: 1.4
alpha: 0.6
drawUnderUnits: false

[effect_波]
priority:veryhigh
stripIndex: shockwave
life: 30
fadeOut: true
attachedToUnit: false
fadeInTime: 2
scaleFrom: 0
scaleTo: 5
alpha: 1
color: #ff0000
drawUnderUnits:false
dirOffsetRandom: 180
dirSpeedRandom: 0.2
atmospheric: true

[effect_光冲]
priority: veryhigh
image: rotorwash.png
life: 30
fadeOut: true
attachedToUnit: false
fadeInTime: 2
scaleFrom: 1
scaleTo: 3
alpha: 0.5
color: #ff0000
drawUnderUnits:false
dirOffsetRandom: 180
dirSpeedRandom: 0.2
atmospheric: true
xOffsetRelativeRandom: 4
yOffsetRelativeRandom: 4
xSpeedAbsoluteRandom: 0.1
ySpeedAbsoluteRandom: 0.1

[movement]
movementType: OVER_CLIFF_WATER
moveSpeed: 0.4
moveAccelerationSpeed: 0.01
moveDecelerationSpeed: 0.01

targetHeight: 2.0
targetHeightDrift: 2.0

maxTurnSpeed: 3.0
turnAcceleration: 0.08

moveSlidingMode: true
moveIgnoringBody: true

moveSlidingDir:  40

[ai]
notPassivelyTargetedByOtherUnits: true