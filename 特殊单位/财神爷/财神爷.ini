
[core]
#dont_load: true

name: 财神爷
displayText: 财神爷
price: 0
maxHp: 888
mass: 10000
tags: 财神爷

selfRegenRate: 888

createNeutral: true
stayNeutral: true

displayDescription: 

techLevel: 1
buildSpeed: 0.0016
selfBuildRate: 0.0016

radius: 10
displayRadius: 10
isBio: true

disableAllUnitCollisions: true
canNotBeDirectlyAttacked: true
ignoreInUnitCapCalculation: true
isUnselectable: true

numBitsOnDeath:	0
explodeOnDeath:	false
hideScorchMark: true

autoTriggerCooldownTime: 0.2s

@memory 坐标X:float
@memory 坐标Y:float

[hiddenAction_初始坐标]
autoTriggerOnEvent: completeAndActive
setUnitMemory: 坐标X=self.x, 坐标Y=self.Y


[hiddenAction_金粒子]
autoTrigger: true
spawnEffects: 金粒子, 金粒子2


[hiddenAction_游荡]
autoTrigger: if not self.isMoving
addWaypoint_type: move
addWaypoint_position_randomOffsetFromSelf: 300, 300
addWaypoint_target_mapMustBeReachable: true

[hiddenAction_回走]
autoTrigger: if distanceBetween(self, createMarker(x=memory.坐标X, y=memory.坐标Y))>600
addWaypoint_type: move
addWaypoint_prepend: true
addWaypoint_target_fromReference: createMarker(x=memory.坐标X, y=memory.坐标Y)
addWaypoint_maxTime: 20s
clearAllWaypoints: true


[hiddenAction_发红包]
autoTrigger: if self.customTimer>=30
resetCustomTimer: true
addResources: 红包=8
alsoQueueAction: 发放红包

[hiddenAction_发放红包]
alsoQueueAction: 发放红包
alsoTriggerOrQueueActionConditional: if self.resource.红包>0
addResources: 红包=-1
buildSpeed: 0.25
fireTurretXAtGround: 1
fireTurretXAtGround_withProjectile: 1
fireTurretXAtGround_withTarget: getOffsetRelative(y=rnd(-200, 200), x=rnd(-200, 200))

[resource_红包]
hidden: true

[effect_金粒子]
priority: verylow
image: 白粒.png
life: 350
lifeRandom: 50
fadeInTime: 20
attachedToUnit: false
scaleFrom: 1.4
scaleTo: 0.7
alpha: 0.8
color: #F7DC6F
drawUnderUnits: true
dirSpeedRandom: 4
yOffsetRelative: 3
xOffsetRelativeRandom: 12
yOffsetRelativeRandom: 12
xSpeedRelativeRandom: 0.05
ySpeedRelativeRandom: 0.05
delayedStartTimerRandom: 5
spawnChance: 0.8

[effect_金粒子2]
@copyFromSection: effect_金粒子
scaleFrom: 1
scaleTo: 0.5
color: #D9D919
attachedToUnit: true
yOffsetRelative: 0
xOffsetRelativeRandom: 5
yOffsetRelativeRandom: 5
xSpeedRelativeRandom: 0.15
ySpeedRelativeRandom: 0.15


[graphics]
imageScale:	0.4
image: 空.png
image_wreak: NONE
image_turret: NONE
drawLayer: air

icon_zoomed_out_neverShow: true

[decal_body]
layer: afterBody
image: 财神爷.png
imageScale: 0.4
alwaysStartDirAtZero: true

[decal_轮廓影]
layer: beforeBody
image: 财神爷黄影.png
imageScale: 0.42 + cos( ((self.timeAlive % 4) / 4) * 360) * 0.015
alpha: 0.3 + cos( ((self.timeAlive % 3) / 3) * 360) * 0.1
alwaysStartDirAtZero: true

[decal_微光]
layer: onTop
order: 0
image: 金光.png
imageScale: 1.4
alpha: 0.3 + ${timerCos_3s}
@define timerCos_3s: cos( ((self.timeAlive % 3) / 3) * 360) * 0.06

[decal_圆影]
layer: shadow
imageScale: 0.4
image: 圆影.png
alpha: 0.3
alwaysStartDirAtZero: true
alwaysStartHeightAtZero: true

[decal_阴影]
layer: shadow
imageScale: 0.4
image: SHADOW:财神爷.png
alpha: 0.15
alwaysStartDirAtZero: true
alwaysStartHeightAtZero: true


[attack]
canAttack: false

[projectile_1]
directDamage: 0

trailEffect: CUSTOM:残光
trailEffectRate: 1

life: 250
speed: 1
speedSpread: 3
targetSpeed: 15

initialUnguidedSpeedY: -5
deflectionPower: -1

invisible: true
lightColor: #D9D919
lightSize: 0.8

effectOnCreate: 红包
spawnUnit: 红包

explodeEffect: CUSTOM:气*2, CUSTOM:闪光, CUSTOM:波, CUSTOM:hitLightFlash
explodeEffectOnShield: ${section.explodeEffect}
explodeOnEndOfLife: true

[effect_红包]
priority: critical
createWhenOffscreen: true
image: 红包.png
life: 250
fadeOut: false
attachedToUnit: true
drawUnderUnits: false
alwayStartDirAtZero: true
liveAfterAttachedDies: false

[effect_残光]
priority: verylow
image: SHARED:light_50.png
life: 10
fadeOut: true
fadeInTime: 2
attachedToUnit: false
color: #ff0000

scaleFrom: 0.6
scaleTo: 0.2
alpha: 0.3
drawUnderUnits:false


[effect_闪光]
image: SHARED:light_50.png
life: 35
fadeOut: true
attachedToUnit: false
color: #D9D919

scaleFrom: 1.0
scaleTo: 0.6
alpha: 0.3
drawUnderUnits:false

[effect_气]
priority: low
life: 40
lifeRandom: 10
fadeOut: true
fadeInTime: 10
attachedToUnit: false
image: 白雾.png
color: #D9D919
scaleFrom: 0.2
scaleTo: 0.5
alpha: 0.4
dirOffsetRandom: 180
drawUnderUnits: true

[effect_hitLightFlash]
priority:high
image: SHARED:light_50.png
life: 14
fadeOut: true
attachedToUnit: false
color: #D9D919
scaleFrom: 0.7
scaleTo: 1.4
alpha: 0.6
drawUnderUnits: false

[effect_波]
priority: low
stripIndex: shockwave
life: 30
fadeOut: true
attachedToUnit: false
fadeInTime: 2
scaleFrom: 0
scaleTo: 1
alpha: 0.8
color: #D9D919
drawUnderUnits: true
dirOffsetRandom: 180
dirSpeedRandom: 0.2


[movement]
movementType: AIR
moveSpeed: 0.2
moveAccelerationSpeed: 0.01
moveDecelerationSpeed: 0.01

targetHeight: 50
targetHeightDrift: 2.0
heightChangeRate: 0.02

maxTurnSpeed: 1
turnAcceleration: 0.08

moveSlidingMode: true
moveIgnoringBody: true

moveSlidingDir:  40


[ai]
notPassivelyTargetedByOtherUnits: true


[hiddenAction_虚空]
@copyFrom_skipThisSection:true
