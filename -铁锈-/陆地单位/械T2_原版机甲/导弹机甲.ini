
[core]
name: 导弹机甲
displayDescription: -攻击地面与空中 \n -超远距离追踪
class: CustomUnitMetadata

copyFrom: mech_large_common.ini

price: 6500
maxHp: 900
mass: 20000
tags: units, 重型机甲, 转向攻击

techLevel: 2
buildSpeed: 0.0006
#availableInDemo: true

fogOfWarSightRange: 20

radius: 23
#displayRadius: 11
isBio: false
softCollisionOnAll: 0

builtFrom_1_name: mechFactoryT2
builtFrom_1_pos: 8.1


transportSlotsNeeded: 2



[graphics]
total_frames: 1

image:        导弹机甲.png
image_wreak:  NONE
image_turret: 铁锈导弹.png

image_shadow: AUTO
shadowOffsetX:2
shadowOffsetY:2

teamColorsOnTurret: true


#animation_moving_start: 0
#animation_moving_end: 7
#animation_moving_speed: 6


#lock_shadow_rotation_with_main_turret: true
lock_body_rotation_with_main_turret: true

[attack]
canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits:   true
canAttackUnderwaterUnits: false

turretSize: 20
turretTurnSpeed: 3

maxAttackRange: 370
shootDelay: 300

turretRotateWithBody: false

[turret_1]
x: 0
y: 0
idleDir:0
invisible: true

turnSpeed: 2.9
turnSpeedAcceleration: 0.2

canShoot: false
canAttackCondition: if attacking == activeWaypointTarget or not self.hasActiveWaypoint(type='attack') or distanceBetween(attacking, activeWaypointTarget)>460


recoilOffset: -3
recoilOutTime: 6
recoilReturnTime: 30


[turret_2]
#
x: 0
y: 19
attachedTo: 1
slave: true

projectile: 1

turnSpeed: 4.0
turnSpeedAcceleration: 1.0

shoot_sound:missile_fire
shoot_sound_vol:0.4
shoot_flame:CUSTOM:greatsmoke*3
shoot_light:#FFEECCCC

canShoot: true
canAttackCondition: if attacking == activeWaypointTarget or not self.hasActiveWaypoint(type='attack') or distanceBetween(attacking, activeWaypointTarget)>460

recoilOffset: -30
recoilOutTime: 0
recoilReturnTime: 350

size: 35

[turret_3]
#覆盖
canShoot: false
x: 0
y: 0
image: 导弹机甲.png
attachedTo: 1
slave: true

[projectile_1]
tags= T-projectile
life: 300
speed: 0.3
targetSpeed: 6
trailEffect: CUSTOM:smog
trailEffectRate: 2
largeHitEffect: true
#ballistic: true
#ballistic_delaymove_height:0
#ballistic_height: 4
image: 铁锈导弹.png
areaDamage: 350
areaRadius: 50

deflectionPower: 2

autoTargetingOnDeadTarget: true
autoTargetingOnDeadTargetRange: 250

spawnProjectilesOnExplode: 1附

[projectile_1附]
tags= T-projectile
life: 0
speed: 0
explodeOnEndOfLife: true
invisible: true
targetGround: true
directDamage: 0
explodeEffect: CUSTOM:explodeCore

[effect_explodeCore]
priority: veryhigh
life: 36
attachedToUnit: true
stripIndex: explode_big2
scaleFrom: 1.6
scaleTo: 1.6
alpha: 1
total_frames: 14
animateFrameStart: 0
animateFrameEnd: 13
animateFrameSpeed: 0.4
fadeOut: false

[effect_greatsmoke]
stripIndex: effects
frameIndex: 0

life: 70
fadeOut: true
attachedToUnit: false
#color: #AEFF00
fadeInTime:2
hSpeed: 0.3
scaleFrom: 0.6
scaleTo: 1.9
alpha: 0.6
drawUnderUnits:false
yOffsetRelative:-12
xOffsetRelativeRandom:1
xSpeedRelativeRandom:0.2
ySpeedRelative:-0.4
ySpeedRelativeRandom:0.2

shadow: true
atmospheric: true

[effect_smog]
stripIndex: effects
frameIndex: 0
priority:low

life: 40
fadeOut: true
attachedToUnit: false
#color: #AEFF00
fadeInTime:2
hSpeed: 0.3
scaleFrom: 0.4
scaleTo: 1.6
alpha: 0.4
drawUnderUnits:false
yOffsetRelative:-10
xOffsetRelativeRandom:1
xSpeedRelativeRandom:0.1
ySpeedRelative:0.3
ySpeedRelativeRandom:0.1

shadow: true
atmospheric: true

[leg_1]
x: -17
y: 0

[leg_2]
x: 17
y: 0

[movement]

moveSpeed: 0.6
moveAccelerationSpeed: 0.07
moveDecelerationSpeed: 0.17

maxTurnSpeed: 5.0
turnAcceleration: 0.5

moveSlidingMode :false
moveIgnoringBody:false


reverseSpeedPercentage:1


[hiddenAction_AI走位]
addWaypoint_type: move
addWaypoint_prepend: true
addWaypoint_maxTime: 3s
addWaypoint_target_mapMustBeReachable: true
addWaypoint_target_fromReference: attachment.getOffsetRelative(y=-80)
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.isAttacking and numberOfUnitsInEnemyTeam(greaterThan=0, withinRange=${attack.maxAttackRange -5}, withTag='units') and attachment.isAttacking and (not self.hasActiveWaypoint(type='move') or distanceBetween(self, activeWaypointTarget) < 20)
[hiddenAction_AIclearWaypoints]
clearAllWaypoints: true
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.isAttacking and not numberOfUnitsInEnemyTeam(greaterThan=0, withinRange=${attack.maxAttackRange +1}, withTag='units') and self.hasActiveWaypoint(type='move')

[attachment_AI向定位]
x: 0
y: 0
onCreateSpawnUnitOf: AI单位向定位
alwaysAllowedToAttackParentsMainTarget: true