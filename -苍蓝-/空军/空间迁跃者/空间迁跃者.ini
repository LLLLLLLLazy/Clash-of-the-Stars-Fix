[core]
name: 空间迁跃者
displayDescription: -突袭地面与空中 \n -轻武装但带有护盾 \n -攻击速度越来越……慢？ \n -能够使用激光防御 \n -不会被雷达检测(小地图上隐藏) \n -能够传送一定距离 \n -在贝露佩欧鲁权杖可消耗权杖护盾补充迁越能量 \n -可通过路径传送至一定范围内的空间迁跃者位置 \n “穿梭空间之中，破坏无声蔓延”
class: CustomUnitMetadata
price: 2000
maxHp: 40
maxShield: 250
shieldRegen: 0.13
mass: 5000
tags: units, 能量冷却3, 固定射击, 空间迁跃者

energyMax: 0.9
energyRegen: 0.0007

techLevel: 2

buildSpeed: 0.0009

radius: 14
isBio: false

softCollisionOnAll: 24

showOnMinimapToEnemies: false

autoTriggerCooldownTime: 6

[hiddenAction_魔力循环]
autoTrigger:if self.globalTeamTags(includes='魔力循环')
convertTo: 空间迁跃者2
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}

[hiddenAction_空迁能量]
takeResources: shield=5
takeResources_includeUnitsWithinRange: 360
takeResources_includeUnitsWithinRange_team: own
takeResources_excludeUnitsWithoutTags: 贝露佩欧鲁权杖
#takeResources_keepResourcesOnTarget: true
takeResources_maxUnits: 1
addResources: ammo=1
autoTrigger: if nearestUnit(withinRange=360, withTag='贝露佩欧鲁权杖', relation='own').self.shield >10 and self.ammo(lessThan=2)

[action_wuhu]
isVisible: if self.ammo(lessThan=2) and not self.globalTeamTags(includes="空间维度")
displayType: queueUnit
#price: 100
addActionCooldownTime: 8s
text: 迁跃
description: -中距离传送
spawnEffects: CUSTOM:hit, hit2
fireTurretXAtGround: skill
fireTurretXAtGround_withProjectile: null
fireTurretXAtGround_showGuideDecals: 技能范围圈
alsoTriggerAction: wuhu执行
buildSpeed: 0.2s
pos: 1
whenBuilding_cannotMove:true
playSoundAtUnit: chakram.ogg:0.05

[action_wuhu2]
@copyFromSection: action_wuhu
isVisible: if not self.ammo(lessThan=2) and not self.globalTeamTags(includes="空间维度")
text: 能量迁跃
addResources: ammo=-2
addActionCooldownTime: IGNORE

[hiddenAction_wuhu执行]
fireTurretXAtGround: magic
fireTurretXAtGround_withTarget: getOffsetRelative(y=min(distanceBetween(self, thisActionTarget), ${turret_magic.limitingRange}), dirOffset=directionBetween(self, thisActionTarget)-self.dir)
fireTurretXAtGround_withProjectile: chakram

[hiddenAction_空间迁跃相互]
autoTriggerOnEvent: newWaypointGivenByPlayer
requireConditional: if getOffsetRelative(y=min(distanceBetween(self, activeWaypointTarget), 250), dirOffset=directionBetween(self, activeWaypointTarget)-self.dir).numberOfUnitsInTeam(withTag='空间迁跃者', withinRange=30)>0 and self.customTimer>0.05
resetCustomTimer: true
fireTurretXAtGround: magic
fireTurretXAtGround_withTarget: getOffsetRelative(y=min(distanceBetween(self, activeWaypointTarget), 250), dirOffset=directionBetween(self, activeWaypointTarget)-self.dir)
fireTurretXAtGround_withProjectile: chakram2
playSoundAtUnit: chakram.ogg:0.03
spawnEffects: hit2

[decal_空迁范围圈]
onlyWhenSelectedByOwnPlayer: true
isVisible: if numberOfUnitsInTeam(withTag='空间迁跃者', withinRange=280)>1
basePosition: self
layer: beforeUI
image: 范围圈1000蓝.png
imageScale: ${250/500}
alpha: 0.5 / max( (numberOfUnitsInTeam(withTag='空间迁跃者', withinRange=250) /2), 1 )
color: #63e6e8
alwaysStartHeightAtZero: true


[decal_技能范围圈]
basePosition: self
layer: inactive
image: 范围圈1000.png
imageScale: ${500/500}
alpha: 0.4
alwaysStartHeightAtZero: true


#[action_苍蓝升级]
#isVisible: if not self.globalTeamTags(includes="空间维度")
#id: ${section.text}
#tags: 苍蓝升级
#text: [-空间维度-]
#description: -迁移世界坐标
#pos: 15
#displayType: action
#addGlobalTeamTags: 空间维度
#price: 苍蓝能量=9
#buildSpeed: 100s
#allowMultipleInQueue: false
#canPlayerCancel: false
#spawnEffects: custom:星
#iconImage: crt_linedcolor.png
#iconExtraImage: 空间迁跃者.png
#isAlsoViewableByAllies: true

[hiddenAction_维空迁跃]
autoTrigger: if distanceBetween(self, activeWaypointTarget) > 700 and self.customTimer(laterThanSeconds=8) and self.ammo < 1 and self.queueSize(withActionTag='Transition', lessThan=1) and self.globalTeamTags(includes="空间维度")
alsoQueueAction: 维空wuhu
[action_维空wuhu]
isVisible: if self.ammo(lessThan=1) and self.globalTeamTags(includes="空间维度")
isActive: false
displayType: infoOnly
tags=Transition
addActionCooldownTime: 8s
text: 迁跃
description: -远距离传送
fireTurretXAtGround: magic
fireTurretXAtGround_withProjectile:chakram
fireTurretXAtGround_withTarget: activeWaypointTarget.getAsMarker
resetCustomTimer: true
buildSpeed: 0.2s
pos: 1
whenBuilding_cannotMove:true
playSoundAtUnit: chakram.ogg:0.05
alsoTriggerAction: 维空wuhu
spawnEffects: hit2

[hiddenAction_维空迁跃2]
autoTrigger: if distanceBetween(self, activeWaypointTarget) > 80 and self.ammo > 0 and self.queueSize(withActionTag='Transition', lessThan=1) and self.globalTeamTags(includes="空间维度")
alsoQueueAction: 维空wuhu2

[action_维空wuhu2]
requireConditional: if self.ammo > 0
isVisible: if self.ammo > 0 and self.globalTeamTags(includes="空间维度")
isActive: false
displayType: infoOnly
tags=Transition
price: ammo=1
addResources: ammo=-1
text: 能量迁跃
description: -在前哨站空间立场中可以能量态自由穿梭
fireTurretXAtGround: magic
fireTurretXAtGround_withProjectile:chakram
fireTurretXAtGround_withTarget: activeWaypointTarget.getAsMarker
addActionCooldownApplyToActions: wuhu
addActionCooldownTime: 8s
resetCustomTimer: true
buildSpeed: 0.2s
pos: 1
playSoundAtUnit: chakram.ogg:0.03
spawnEffects: hit2

[decal_苍]
isVisible: if self.queueSize(withActionTag="苍蓝升级")>0
layer: beforeBody
imageScale: 3
image: hit.png
color: #4C8EFF
basePositionFromLegEnd: arm_8

[decal_内苍]
@copyFromSection: decal_苍
imageScale: 2
color: #33E5E8
basePositionFromLegEnd: arm_9

[arm_8]
x: 0
y: 0
spinRate: 3

[arm_9]
x: 0
y: 0
spinRate: -3

[effect_星]
image: light.png
liveAfterAttachedDies: false
attachedToUnit: true
drawUnderUnits: false
life: 100
scaleFrom: 0.6
scaleTo: 0.6
alpha: 0.9

[action_扩散移动点开]
@copyFromSection: template_扩散移动点开

[action_扩散移动点关]
@copyFromSection: template_扩散移动点关

[hiddenAction_设置扩散移动点]
@copyFromSection: template_设置扩散移动点

[hiddenAction_清除当前非巡逻路径]
@copyFromSection: template_清除当前非巡逻路径

[hiddenAction_锁定扩散移动点]
@copyFromSection: template_锁定扩散移动点

[hiddenAction_执行扩散移动点]
@copyFromSection: template_执行扩散移动点

[graphics]
total_frames: 1
image:        空间迁跃者.png
image_wreak:  空间迁跃者残骸.png
image_turret: NONE

lock_body_rotation_with_main_turret: true
teamColorsOnTurret: true

image_shadow: 空间迁跃者.png
shadowOffsetX:1
shadowOffsetY:1

movementEffect: CUSTOM:Shadow
movementEffectRate: 6

[effect_Shadow]
createWhenZoomedOut: false
priority:low
image: 空间迁跃者.png
life: 40
fadeOut: true
attachedToUnit: false
fadeInTime:2
scaleFrom: 1.0
scaleTo: 0.8
alpha: 0.6
drawUnderUnits: true
ySpeedRelative:-0.4
atmospheric: true

[attack]
canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits:   true
canAttackUnderwaterUnits: false

maxAttackRange: 150
shootDelay: 10

turretRotateWithBody: true
isFixedFiring: true
aimOffsetSpread: 0

[turret_1]
invisible: true
x: 0
y: 0
idleDir:0

projectile: 1
size: 10
turnSpeed: 5.1
#turnSpeedAcceleration: 0.5

canShoot: false

[turret_2]
x: 0
y: 10
projectile: 1
size: 1
attachedTo: 1
slave: true

turnSpeed: 0
turnSpeedAcceleration: 1

shoot_sound:plasma_fire
shoot_sound_vol:0.06
shoot_flame: NONE
shoot_light: #eefbff

warmup: 300
warmupCallDownRate: 2
warmupNoReset: true
warmupShootDelayTransfer: -30

[turret_3]
x: 0
y: -10
canShoot: false
invisible: true
laserDefenceEnergyUse: 1

[projectile_1]
tags= T-projectile
directDamage: 17
life: 100
speed: 7
frame:11
drawSize: 1

lightColor: #eefbff
lightSize: 0.4

[turret_magic]
x: 0
y: 0
canShoot: false
invisible: true
limitingRange: 500

[projectile_chakram]
tags= T-projectile
teleportSource:true
life: 50
#targetGround:true
instant:true
laserEffect: true
color: #B463e6e8
areaDamage: 0
areaRadius: 0
explodeEffect: CUSTOM:hit

[projectile_chakram2]
@copyFromSection: projectile_chakram
life: 20
color: #6463e6e8
explodeEffect: CUSTOM:hit3

[effect_hit]
image: hit.png
attachedToUnit: false

[effect_hit2]
image: hit.png
life: 20

[effect_hit3]
image: hit.png
attachedToUnit: false
life: 10

[turret_skill]
x: 0
y: 0
invisible: true
canShoot: false
limitingRange: 9999

[projectile_null]
tags= T-projectile
areaDamage: 0
areaRadius: 0
invisible: true
life: 0
speed: 0
deflectionPower: -1
explodeEffect: NONE


[movement]
movementType: AIR
moveSpeed: 2.1
moveAccelerationSpeed: 0.06
moveDecelerationSpeed: 0.09

maxTurnSpeed: 5.0
turnAcceleration: 0.3

reverseSpeedPercentage: 0.75

targetHeight: 25
targetHeightDrift: 1

moveSlidingMode :true
moveIgnoringBody:true
moveSlidingDir:  181
slowDeathFall: true


[hiddenAction_AImove]
addWaypoint_type: touchTarget
addWaypoint_prepend: true
addWaypoint_maxTime: 5s
addWaypoint_target_nearestUnit_tagged: 空迁定位
addWaypoint_target_nearestUnit_team: own
addWaypoint_target_nearestUnit_maxRange: 22
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.isAttacking() and numberOfUnitsInEnemyTeam(greaterThan=0, withinRange=150) and not self.hasActiveWaypoint(type='touchTarget') and not self.hasFlag(id=1) and not self.globalTeamTags(includes='魔力循环')
[hiddenAction_AIclearWaypoints]
clearAllWaypoints: true
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.isAttacking() and not numberOfUnitsInEnemyTeam(greaterThan=0, withinRange=151) and not self.hasFlag(id=1) and not self.globalTeamTags(includes='魔力循环')

[attachment_1]
x:0
y:-21
isUnselectable: false
canBeAttackedAndDamaged: false
keepAliveWhenParentDies: false
setDrawLayerOnTop: false
addTransportedUnits: 1
lockRotation: true
deattachIfWantingToMove: false
onCreateSpawnUnitOf: 空迁定位
