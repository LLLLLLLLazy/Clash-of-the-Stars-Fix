
[core]
name: 寻攻路筛选
tags: 寻攻路筛选
maxHp:1
price: 0
mass: 0

#隐藏单位本身
showInEditor: false
radius: 0
fogOfWarSightRange: 0
showOnMinimap: false
ignoreInUnitCapCalculation: true
disableAllUnitCollisions: true
#isUnselectable: true
canNotBeDirectlyAttacked: true

#禁止死亡痕迹
numBitsOnDeath:	0
explodeOnDeath:	false
hideScorchMark: true

# 保留寻路探针实时性，同时避免 0.01s 轮询带来的高CPU占用
autoTriggerCooldownTime: 0.1s

[hiddenAction_AIPath]
clearAllWaypoints: true
addWaypoint_type: move
addWaypoint_prepend: true
addWaypoint_maxTime: 100s
addWaypoint_target_nearestUnit_tagged: 攻路点
addWaypoint_target_nearestUnit_team: any
addWaypoint_target_mapMustBeReachable: false
addWaypoint_triggerActionIfFailed: AIFail
autoTrigger: if self.isControlledByAI and not self.hasActiveWaypoint(type='move') and not self.hasFlag(id=0) and not self.hasFlag(id=1)

[hiddenAction_AIDetection]
autoTrigger: if self.isControlledByAI and self.hasActiveWaypoint(type='move') and not self.hasFlag(id=0) and not self.hasFlag(id=1) and numberOfUnitsInEnemyTeam(withTag='地震塔T2', greaterThan=0, withinRange=400)
clearAllWaypoints: true
addResources: setFlag=0
spawnUnits: 寻攻路否

[hiddenAction_AIReturn]
clearAllWaypoints: true
addWaypoint_type: move
addWaypoint_prepend: true
addWaypoint_maxTime: 100s
addWaypoint_target_nearestUnit_tagged: 基地
addWaypoint_target_nearestUnit_team: own
addWaypoint_target_mapMustBeReachable: true
autoTrigger: if self.isControlledByAI and not self.hasActiveWaypoint(type='move') and self.hasFlag(id=0)
[hiddenAction_AIReset]
autoTrigger: if self.isControlledByAI and self.hasFlag(id=0) and numberOfUnitsInTeam(withTag='基地', greaterThan=0, withinRange=200)
addResources: unsetFlag=0
alsoTriggerAction: AIBuildBlockedRecover

[hiddenAction_AIPreliminaryElection]
autoTrigger: if self.isControlledByAI and not self.hasFlag(id=0) and not self.hasFlag(id=1) and not numberOfUnitsInEnemyTeam(withTag='地震塔T2', greaterThan=0, withinRange=400)
takeResources: setFlag=2
takeResources_discardCollected: true
takeResources_includeUnitsWithinRange: 50
takeResources_includeUnitsWithinRange_team: any
takeResources_excludeUnitsWithoutTags: 攻路点
takeResources_triggerActionIfAnyCollected: Flag1
takeResources_maxUnits: 1
[hiddenAction_Flag1]
addResources: setFlag=1

[hiddenAction_AIPath2]
@copyFromSection: hiddenAction_AIPath
addWaypoint_target_nearestUnit_tagged: 基地
addWaypoint_target_nearestUnit_team: enemy
addWaypoint_triggerActionIfFailed: AIDetection2
autoTrigger: if self.isControlledByAI and not self.hasActiveWaypoint(type='move') and not self.hasFlag(id=0) and self.hasFlag(id=1)

[hiddenAction_AIDetection2]
@copyFromSection: hiddenAction_AIDetection
autoTrigger: if self.isControlledByAI and self.hasActiveWaypoint(type='move') and self.hasFlag(id=1) and numberOfUnitsInEnemyTeam(withTag='地震塔T2', greaterThan=0, withinRange=400)
addResources: setFlag=0, unsetFlag=1
spawnUnits: 寻攻路否(addResources=setFlag:1)

[hiddenAction_AIDetermine]
autoTrigger: if self.isControlledByAI and not self.hasFlag(id=0) and not numberOfUnitsInEnemyTeam(withTag='地震塔T2', greaterThan=0, withinRange=400) and numberOfUnitsInEnemyTeam(withTag='基地', greaterThan=0, withinRange=50)
takeResources: setFlag=3
takeResources_discardCollected: true
takeResources_includeUnitsWithinRange: 9999
takeResources_includeUnitsWithinRange_team: any
takeResources_excludeUnitsWithoutTags: 攻路预选
takeResources_maxUnits: 1
addGlobalTeamTags: 攻路2确定
deleteSelf: true


[hiddenAction_AIBuildBlocked]
autoTrigger: if self.isControlledByAI and self.hasActiveWaypoint(type='move') and not self.hasFlag(id=1) and not self.isMoving
addResources: AI阻挡=1

[hiddenAction_AIBuildBlockedRecover]
requireConditional: if self.hasResources(AI阻挡=1)
addResources: AI阻挡=-1

[hiddenAction_AIBlockInformation]
autoTrigger: if self.isControlledByAI and self.hasActiveWaypoint(type='move') and not self.hasFlag(id=1) and not self.isMoving and self.hasResources(AI阻挡=4)
alsoTriggerAction: AIDetection
resourceAmount: AI阻挡
resourceAmount_setValue: 0

[resource_AI阻挡]
displayName: AI阻挡


[hiddenAction_AIFail]
takeResources: hp=0
takeResources_discardCollected: true
takeResources_includeUnitsWithinRange: 9999
takeResources_includeUnitsWithinRange_team: any
takeResources_excludeUnitsWithoutTags: 攻路点
takeResources_triggerActionIfNoneCollected: AI寻路失败
takeResources_maxUnits: 1

[hiddenAction_AI寻路失败]
deleteSelf: true

[graphics]
image:        icon_红标.png
icon_zoomed_out_neverShow: true
isVisibleToEnemies: false

[attack]
canAttack: false

[movement]
movementType: LAND
moveSpeed: 18
moveIgnoringBody: true

