
[core]
showInEditor:false
name: 盾卫[防御]
displayText: 盾卫
displayDescription: -可转换攻防姿态 \n -战士们坚实的壁垒 \n -没有远程攻击能力 \n -受到来自正面的伤害减少50%
class: CustomUnitMetadata
price: 4000, 基因种子=5
maxHp: 2500
mass: 30000

tags: units, 星际步兵, 盾卫, 坚韧意志

armour: 30
armourMinDamageToKeep: 0

maxShield: 100
shieldRegen: 2

fogOfWarSightRange: 16

techLevel: 2
buildSpeed: 25.6s

radius: 23
displayRadius: 27
shieldRenderRadius:	46

isBio: true

#softCollisionOnAll: 3

selfRegenRate:0.16

transportSlotsNeeded:2

energyMax: 60
energyRegen: 0.01

showActionsWithMixedSelectionIfOtherUnitsHaveTag: 盾卫

[action_1]
text: 攻击姿态
description: -收回激光拦截盾
convertTo: 盾卫[攻击]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
buildSpeed: 0.5s
alwaysSinglePress: true

setUnitMemory: 属性[21]=0
alsoTriggerAction: 属性变化

[action_锁定朝向]
text: [ 锁定朝向 ]
description: -防御姿态开启后将位于当前朝向角度不再转向 \n 当前朝向角度:(%{attachment(withTag='单位向定位').dir})
iconImage: SHARED:icon_off.png

isVisible: if not self.hasFlag(id=1)
addResources: setFlag=1
displayType: action

setUnitMemory: 属性[21]=-${movement.maxTurnSpeed}
alsoTriggerAction: 属性变化

pos: 3
buildSpeed: 0s
canPlayerCancel: false
allowMultipleInQueue: false

extraLagHidingInUI: true

[action_锁定朝向开]
@copyFromSection: action_锁定朝向
text: [ 锁定朝向 ]
iconImage: SHARED:icon_on.png

isVisible: if self.hasFlag(id=1)
addResources: unsetFlag=1

setUnitMemory: 属性[21]=0


[hiddenAction_血量记录]
autoTrigger: if self.resource.受击前血量!=self.hp
setResourcesWithLogic: 受击前血量=self.hp

[hiddenAction_血量减伤]
autoTriggerOnEvent: tookDamage
requireConditional: if self.resource.受击前血量>self.hp and directionBetween(attachment(withTag='单位向定位'), eventSource)-attachment(withTag='单位向定位').dir >-45 and directionBetween(attachment(withTag='单位向定位'), eventSource)-attachment(withTag='单位向定位').dir <45
setResourcesWithLogic: hp=self.hp+(self.resource.受击前血量-self.hp) * 0.5, 受击前血量=self.hp

[hiddenAction_受伤记录]
autoTriggerOnEvent: tookDamage
setResourcesWithLogic: 受击前血量=self.hp

[resource_受击前血量]
hidden: true

[attachment_单位向定位]
x: 0
y: 0
onCreateSpawnUnitOf: 单位向定位
alwaysAllowedToAttackParentsMainTarget: true
resetRotationWhenNotAttacking: true

[graphics]
total_frames: 1
image:       百夫长盾卫.png
image_wreak: NONE
image_turret: NONE
image_shield: 激光盾.png

teamColorsOnTurret: true

#scaleImagesTo: 20
#scaleTurretImagesTo: 9

image_shadow: AUTO
shadowOffsetX:2
shadowOffsetY:2

lock_body_rotation_with_main_turret: true

[attack]
canAttack: true
canAttackFlyingUnits: false
canAttackLandUnits:   false
canAttackUnderwaterUnits: false

turretSize: 1
turretTurnSpeed: 4

maxAttackRange: 0
shootDelay: 40

showRangeUIGuide: false

[turret_1]
#主体
x: 0
y: 0
idleDir:0

turnSpeed: 4.1
turnSpeedAcceleration: 0.3

canShoot: false

recoilOffset: 1

[turret_2]
#右臂
image: 盾卫右手.png
attachedTo: 1
x: 19
y: 3
idleDir:-40
canShoot: false
canAttackFlyingUnits: false
canAttackLandUnits: false

projectile: 1

size: 10

recoilOffset: 4

turnSpeed: 6.0
turnSpeedAcceleration: 0.06

[turret_3]
#左臂
copyFrom: 2
x: -19
y: 3
idleDir:40
image: 盾卫左手.png
warmup: 20
linkDelayWithTurret:2

[turret_4]
#肩甲
x: 0
y: 0
attachedTo: 1
slave: true
idleDir:0

turnSpeed: 0

canShoot: false
image: 百夫长盾卫.png

[turret_laserDefence]
x: 0
y: 30
attachedTo: 1
slave: true
canShoot: false

barrelX: -3
barrelOffsetX_onOddShots: 6

laserDefenceEnergyUse: 1
limitingRange: 20
showRangeUIGuide: false

[turret_laserDefence2]
@copyFromSection: turret_laserDefence
x: -8

[turret_laserDefence3]
@copyFromSection: turret_laserDefence
x: -16

[turret_laserDefence4]
@copyFromSection: turret_laserDefence
x: -24

[turret_laserDefence5]
@copyFromSection: turret_laserDefence
x: -32

[turret_laserDefence6]
@copyFromSection: turret_laserDefence
x: -40

[turret_laserDefence7]
@copyFromSection: turret_laserDefence
x: -48

[turret_laserDefence8]
@copyFromSection: turret_laserDefence
x: -56

[turret_laserDefence9]
@copyFromSection: turret_laserDefence
x: -64

[turret_laserDefence10]
@copyFromSection: turret_laserDefence
x: 8

[turret_laserDefence11]
@copyFromSection: turret_laserDefence
x: 16

[turret_laserDefence12]
@copyFromSection: turret_laserDefence
x: 24

[turret_laserDefence13]
@copyFromSection: turret_laserDefence
x: 32

[turret_laserDefence14]
@copyFromSection: turret_laserDefence
x: 40

[turret_laserDefence18]
@copyFromSection: turret_laserDefence
x: 48

[turret_laserDefence16]
@copyFromSection: turret_laserDefence
x: 56

[turret_laserDefence17]
@copyFromSection: turret_laserDefence
x: 64

[projectile_1]
tags= T-projectile
life: 50
instant: true

directDamage: 50

[movement]
movementType: OVER_CLIFF
moveSpeed: 0.9
moveAccelerationSpeed: 0.03
moveDecelerationSpeed: 0.03

reverseSpeedPercentage: 0.0

maxTurnSpeed: 4.1
turnAcceleration: 0.15

moveSlidingMode :true
moveIgnoringBody:true