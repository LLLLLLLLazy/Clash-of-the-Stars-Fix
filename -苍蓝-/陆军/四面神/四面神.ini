
[core]
name: 四面神
displayDescription: -朝向四方的四面各具有不同的魔术 \n -前方可发射硫磺火弹 \n -右侧可发射冲击光束 \n -左侧可喷射烈焰 \n -后方可引导电击 \n -四面注视四周 \n -自我修复 \n -中程攻击范围: 220
class: CustomUnitMetadata

price: 8000
maxHp: 2700
mass: 20000
tags: units

techLevel: 2
buildSpeed: 0.0005
availableInDemo: false

fogOfWarSightRange: 20

radius: 25
#displayRadius: 11
isBio: false
softCollisionOnAll: 0

selfRegenRate:0.08

transportSlotsNeeded: 2

energyMax: 10
energyRegen: -0.005
energyStartingPercentage: 0

autoTriggerCooldownTime: 10

[action_god]
isActive: false
displayType: infoOnly
id: ${section.text}
text: 神压
description: -每一面攻击都会累积能量 \n -当能量充满时对周围敌人造成短暂的强大减缓并回复自身300血量
autoTrigger: if self.energy(greaterThan=9.5)
addResources: hp=300, energy=-10
temporarilyAddTags: 神压
resetCustomTimer: true
fireTurretXAtGround: 1
fireTurretXAtGround_withOffset:0,0
fireTurretXAtGround_withProjectile: 5

[hiddenAction_神压结束]
autoTrigger: if self.customTimer(laterThanSeconds=2) and self.tags(includes="神压")
temporarilyRemoveTags: 神压

[template_提取目标]
takeResources_includeUnitsWithinRange: 350
takeResources_includeUnitsWithinRange_team: enemy
takeResources_excludeUnitsWithoutTags: units
takeResources_maxUnits: 9999

[hiddenAction_状态时间]
@copyFromSection: template_提取目标
autoTrigger: if numberOfUnitsInEnemyTeam(withTag="units", greaterThan=0, withinRange=350) and self.tags(includes="神压")
takeResources: 神压减速=-1
takeResources_excludeUnitsWithTheseResources: 神压减速=2

[resource_神压减速]
displayName: 神压减速
hidden: true

[action_painting]
isVisible: if self.globalTeamTags(includes='时之砂涂装')
convertTo: 四面神[时之砂]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
id: ${section.text}
text: “时之砂”
description: -个性涂装 \n(不影响战斗属性)
displayType: upgrade
buildSpeed: 3.3s
pos: 2

[hiddenAction_涂装解锁]
autoTrigger: if ( self.kills(greaterThan=2) or self.playerName=="今宵" or self.playerName=="风砂" or self.playerName=="砂火共今宵" ) and not self.globalTeamTags(includes='时之砂涂装')
addGlobalTeamTags: 时之砂涂装

[projectile_5]
tags= T-projectile
#areaDamage: 300
areaDamage: 0
areaRadius: 350
areaHitAirAndLandAtSameTime: true
areaDamageNoFalloff: true
life:50
instant:true
pushForce: 1
pushVelocity: 1
explodeEffect:CUSTOM:god, CUSTOM:god4
explodeEffectOnShield:CUSTOM:god, CUSTOM:god4

[effect_god]
image: 神压.png
attachedToUnit: false
life: 90
fadeOut: false
fadeInTime: 3
scaleFrom: 2.1
scaleTo: 2.3
#color: #B8B8B8
alpha: 1.0
alsoPlaySound:FireBallDead.ogg:0.5
alsoEmitEffectsOnDeath: CUSTOM:god2, CUSTOM:god3

[effect_god2]
image: 神压.png
attachedToUnit: false
life: 30
scaleFrom: 2.3
scaleTo: 0
#color: #B8B8B8
alpha: 1.0
dirSpeed: 5

[effect_god3]
drawType: displacement

image: SHARED:ripple_normal_128.png
life: 30
fadeOut: true
attachedToUnit: false
color: #FFFFFF
scaleFrom: 7
scaleTo: 0
alpha: 0.3
drawUnderUnits:false

dirOffsetRandom: 180
dirSpeed: 5

[effect_god4]
drawType: displacement

image: SHARED:ripple_normal_128.png
life: 90
fadeOut: true
attachedToUnit: false
color: #FFFFFF
scaleFrom: 6.8
scaleTo: 7
alpha: 0.3
drawUnderUnits:false

dirOffsetRandom: 180
dirSpeed: -10

[graphics]
total_frames: 1

image:      新四面神.png
image_wreak:  四面神残骸.png
image_turret: NONE

image_shadow: AUTO
shadowOffsetX:3
shadowOffsetY:3

[attack]
canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits: true
canAttackUnderwaterUnits: false

turretSize: 0
turretTurnSpeed: 10

maxAttackRange: 320
shootDelay: 230

turretMultiTargeting: true
turretRotateWithBody: true

[turret_1]
x: 0
y: 0

turnSpeed: 0

canShoot: false

[turret_2]
#第一面-炼狱魔鬼
x: 0
y: 21
attachedTo: 1
idleDir:0

canAttackFlyingUnits: false
canAttackLandUnits: true

warmup: 150
chargeEffectImage:恶魔之火蓄力.png
shoot_flame: CUSTOM:wu*3
shoot_sound:FireBallDead.ogg
shoot_sound_vol:0.15
shoot_light: #FF3BFF00

projectile: 1
aimOffsetSpread: 0

#limitingRange:290
limitingAngle:45
idleSweepAngle:45

resourceUsage: energy=-6

[projectile_1]
tags= T-projectile
#第一面-炼狱魔鬼
life: 300
speed: 4

image: 恶魔之火.png
lightColor: #FF3BFF00
lightSize: 0.4

areaDamage: 333
areaRadius: 65

trailEffect: wu
trailEffectRate: 3
largeHitEffect: true
targetGround: true
targetGroundSpread: 25
deflectionPower: 4

initialUnguidedSpeedHeight: 1.2
gravity: 0.1

explodeEffect: CUSTOM:混沌爆, CUSTOM:混沌波, CUSTOM:扭曲波*4, CUSTOM:混沌光

[turret_3]
#第二面-咒火魔眼
x: -22
y: 0
attachedTo: 1
idleDir:-90

shoot_flame: CUSTOM:火焰光

canAttackFlyingUnits: false
canAttackLandUnits: true

delay: 1

projectile: 2
aimOffsetSpread: 0

limitingRange:220
limitingAngle:45
idleSweepAngle:45

resourceUsage: energy=-0.017

[projectile_2]
tags= T-projectile
#第二面-咒火魔眼
life: 70
speed: 5
targetSpeed: 5
targetSpeedAcceleration: 0.5

speedSpread: 1

frame: 3
drawSize: 1

flameWeapon: true
hitSound: false

targetGround:true
targetGroundSpread: 25

deflectionPower: -1

areaDamage: 3
areaRadius: 80

explodeEffect: CUSTOM:hitFlame1, CUSTOM:炼狱
effectOnCreate: CUSTOM:attachedLight1

[turret_4]
#第三面-激光魔眼
x: 25
y: 0
attachedTo: 1
idleDir:90

canAttackFlyingUnits: true
canAttackLandUnits: true

delay: 30
warmup: 30
chargeEffectImage:魔眼激光蓄力.png
shoot_sound: plasma_fire
shoot_sound_vol: 0.1
shoot_light: #ff0000
shoot_flame: CUSTOM:破坏光, CUSTOM:破坏光2*4

projectile: 3

limitingRange:220
limitingAngle:45
idleSweepAngle:45

resourceUsage: energy=-1

[projectile_3]
tags= T-projectile
#第三面-激光魔眼
directDamage: 127
life: 15

buildingDamageMultiplier: 1.5

pushForce: 5
pushVelocity: 2

largeHitEffect: true
instant: true
laserEffect: true
instantReuseLast: true

color: #6fff0000

explodeEffect: CUSTOM:破坏光, CUSTOM:爆炸, CUSTOM:冲击波
explodeEffectOnShield: CUSTOM:破坏光

[turret_5]
#第四面-短路人偶
x: 0
y: -25
attachedTo: 1
idleDir:180

canAttackFlyingUnits: true
canAttackLandUnits: true

delay: 0.01
warmup: 37
chargeEffectImage:短路.png
shoot_sound: lighting_burst
shoot_sound_vol: 0.1
shoot_flame: CUSTOM:sparks3*15
shoot_light: #FFcceeee

projectile: 4

limitingRange:220
limitingAngle:45
idleSweepAngle:45

resourceUsage: energy=-0.6

[projectile_4]
tags= T-projectile
#第四面-短路人偶
directDamage: 97
life: 20
instant: true
lightingEffect: true
largeHitEffect: true

shieldDamageMultiplier: 1
shieldDefectionMultiplier: 0.1

buildingDamageMultiplier: 0.5

explodeEffect:CUSTOM:lightningShock*1, CUSTOM:sparks*6, CUSTOM:sparks2*3
explodeEffectOnShield:CUSTOM:lightningShock*1, CUSTOM:hitLightFlash, CUSTOM:sparks2*3

[leg_1]
x: -10
y: 11
attach_x: 0
attach_y: 0
moveSpeed: 2.4
moveWarmUp:0.05s

rotateSpeed: 7

heightSpeed: 0.5
resetAngle:25

image_leg:  leg.png
image_foot: foot_small.png

holdDisMin: 22
holdDisMax: 52
endDirOffset:45

[leg_2]
x: 10
y: 11
attach_x: 0
attach_y: 0
copyFrom: 1
endDirOffset:-45

[leg_3]
x: -10
y: -11
attach_x: 0
attach_y: 0
copyFrom: 1
endDirOffset:-45

[leg_4]
x: 10
y: -11
attach_x: 0
attach_y: 0
copyFrom: 1
endDirOffset:45

[effect_混沌波]
stripIndex: shockwave
life: 30
scaleFrom: 0
scaleTo: 2.6
alpha: 1
color: #8CFF00

[effect_扭曲波]
stripIndex: shockwave
attachedToUnit: false
life: 25
scaleFrom: 0
scaleTo: 1.3
alpha: 0.4
color: #8CFF00
xOffsetRelativeRandom: 20
yOffsetRelativeRandom: 20
delayedStartTimerRandom: 20

[effect_混沌爆]
color: #8CFF00
life: 25
attachedToUnit: true
image: 白爆.png
scaleFrom: 1.2
scaleTo: 1.2
total_frames: 14
animateFrameStart: 0
animateFrameEnd: 13
animateFrameSpeed: 0.5
fadeOut: false
alsoPlaySound: missile_hit

[effect_混沌光]
@copyFromSection: effect_hitLightFlash
color: #8CFF00

[effect_wu]
#雾
stripIndex: effects
frameIndex: 0
priority:low

life: 50
fadeOut: true
attachedToUnit: false
color: #8CFF00
fadeInTime:2
hSpeed: 0.3
scaleFrom: 0.6
scaleTo: 1.2
alpha: 0.8
drawUnderUnits:false
#yOffsetRelative:-7
xOffsetRelativeRandom:1
xSpeedRelativeRandom:0.1
ySpeedRelative:0.1
ySpeedRelativeRandom:0.1

shadow: true
atmospheric: true


[effect_hitLightFlash]
priority:high
image: SHARED:light_50.png
life: 17
fadeOut: true
attachedToUnit: false
color: #63e6e8
scaleFrom: 1.8
scaleTo: 1.8
alpha: 0.6
drawUnderUnits:false

[effect_lightningShock]
life: 60
xOffsetRelative: 0
yOffsetRelative: 0
hOffset: 0
dirOffset: 0
dirOffsetRandom:180
fadeInTime: 0
fadeOut: false
attachedToUnit: false
image: SHARED:lightning_shock.png
total_frames: 14
animateFrameStart: 0
animateFrameStartRandomAdd: 2
animateFrameEnd: 13
animateFramePingPong: false
animateFrameSpeed: 0.5
animateFrameSpeedRandom: 0.2
alpha:0.6

[effect_sparks]
attachedToUnit: false
life: 150
physics: true
xSpeedRelativeRandom: 1.6
ySpeedRelativeRandom: 1.6
hSpeed: 2
image: SHARED:spark.png
priority: verylow

[effect_sparks2]
attachedToUnit: false
life: 60
scaleFrom: 0.3
scaleTo: 0.3
xSpeedRelativeRandom: 0.5
ySpeedRelativeRandom: 0.5
image: 短路.png
priority: low

[effect_sparks3]
attachedToUnit: false
life: 40
scaleFrom: 0.3
scaleTo: 0.3
xSpeedRelativeRandom: 0.6
ySpeedRelative: 3.5
ySpeedRelativeRandom: 3.4
image: 短路.png
priority: verylow

[effect_lightSlowFade]
image: SHARED:light_50.png
life: 40
fadeOut: true
attachedToUnit: true
color: #63e6e8
scaleFrom: 0.3
scaleTo: 0.2
alpha: 1.7


[effect_破坏光]
image: SHARED:light_50.png
life: 40
fadeOut: true
attachedToUnit: false
color: #FF0000
scaleFrom: 1.2
scaleTo: 0.8
alpha: 1.0
drawUnderUnits:false

[effect_破坏光2]
image: 魔眼激光蓄力.png
life: 70
fadeOut: true
attachedToUnit: false
color: #FF0000
scaleFrom: 2.0
scaleTo: 3.0
alpha: 0.7
xSpeedRelativeRandom: 0.8
ySpeedRelativeRandom: 0.8
drawUnderUnits:false

[effect_爆炸]
life: 25
attachedToUnit: true
stripIndex: explode_big
total_frames: 14
animateFrameStart: 0
animateFrameEnd: 13
animateFrameSpeed: 0.5
alpha: 0.6
fadeOut: false
alsoPlaySound: missile_hit

[effect_冲击波]
stripIndex: shockwave
life: 25
scaleFrom: 0
scaleTo: 1.2
alpha: 0.8


[effect_火焰光]
image: SHARED:light_50.png
life: 25
fadeOut: true
attachedToUnit: true
color: #FF8324
scaleFrom: 0.25
scaleTo: 0.5
alpha: 0.4
yOffsetRelative: -3
ySpeedRelative: 1
xSpeedRelativeRandom: 0.2
drawUnderUnits: true

[effect_炼狱]
image: SHARED:light_50.png
life: 40
fadeOut: true
attachedToUnit: false
color: #EB5D0C
scaleFrom: 0.7
scaleTo: 0.7
alpha: 0.4
hSpeed: 0.3

[effect_attachedLight1]
priority:high
image: SHARED:light_50.png
life: 80
fadeOut: true
attachedToUnit: true
color: #fdc14d
fadeInTime: 4
scaleFrom: 0.4
scaleTo: 0.4
alpha: 0.5
drawUnderUnits:false
liveAfterAttachedDies: false

[effect_hitFlame1]
priority: low
frameIndex: 3
stripIndex: projectiles
life: 40
fadeOut: true
attachedToUnit: false
color: #fdc14d
scaleFrom: 1.1
scaleTo: 1.3
alpha: 0.5
drawUnderUnits:false
liveAfterAttachedDies: false
physics: true
ySpeedRelative: 0.4
hSpeed: 0.3


[movement]
movementType: OVER_CLIFF
moveSpeed: 0.6
moveAccelerationSpeed: 0.07
moveDecelerationSpeed: 0.17

maxTurnSpeed: 1.5
turnAcceleration: 0.3

moveSlidingMode :false
moveIgnoringBody:true

reverseSpeedPercentage:1


