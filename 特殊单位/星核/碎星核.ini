[core]
#showInEditor: false
name: 碎星核
displayText: 星核
displayDescription: -靠近可拾取为己方星核 \n -首次获取增加[游戏时间/1s×10]资源$ \n -当起始基地被摧毁，星核会伴随能量波动而出现 \n -能量波动会对原所属阵营造成[700|50范围|对建筑*10]伤害
maxHp: 500
mass: 100000
price: 0
maxShield: 100

tags: 虚无

radius: 0
shieldRenderRadius: 9

isBuilding: true

footprint: 1,1,-1,-1
constructionFootprint: 1,1,-1,-1
createOnAggressiveTeam: true

fogOfWarSightRange: 0
disableAllUnitCollisions: true
canNotBeDirectlyAttacked: true
ignoreInUnitCapCalculation: true

numBitsOnDeath:	0
explodeOnDeath:	false
hideScorchMark: true

disableDeathOnZeroHp: true

effectOnDeath: CUSTOM:白雾, CUSTOM:白光

@memory 目标队伍:number

[hiddenAction_碎星核]
autoTriggerOnEvent: created
addResources: setFlag=0


[hiddenAction_星核]
autoTrigger: if self.teamId >=-1
spawnEffects: CUSTOM:光芒, CUSTOM:白雾, CUSTOM:白光
convertTo: 星核
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
addResources: hp=1000, shield=1000

[hiddenAction_重辉]
autoTriggerOnEvent: destroyed
requireConditional: if self.timeAlive <1 or self.resource(type='虚空')>0.99
spawnUnits: 碎星核

[hiddenAction_teamId]
switchToTeam: self.readUnitMemory('目标队伍', type='number')

[hiddenAction_目标队伍]
setUnitMemory: 目标队伍=attacking.teamId

[graphics]
image: 碎核.png
image_shield: 结核白盾.png
disableLowHpFire: true
disableLowHpSmoke: true
showHealthBar: false

[decal_星光]
layer: afterBody
image: 烁星光.png
imageScale: 0.6
alpha: 0.1

[attack]
canAttack: true
canAttackFlyingUnits: if self.lastConverted(laterThanSeconds=0.6)
canAttackLandUnits: if self.lastConverted(laterThanSeconds=0.6)
canAttackUnderwaterUnits: false
canOnlyAttackUnitsWithoutTags: 星核
aimOffsetSpread: 0
turretTurnSpeed: 1000
maxAttackRange: 50
shootDelay: 8

turretMultiTargeting: true

isMelee: true

[turret_1]
x: 0
y: 0
onShoot_triggerActions: teamId

warmup: 180
warmupCallDownRate: 180

[turret_2]
x: 0
y: 0
projectile: 2
onShoot_triggerActions: 目标队伍

[turret_3]
x: 0
y: 0
projectile: 3

[projectile_1]
life: 10
instant: true
moveWithParent: true
beamImage:      beamDoubleNarrow.png
beamImageEnd:   beamTractor_startEnd.png
beamImageStart: beamTractor_startEnd.png
beamImageOffsetRate: -2
explodeEffect: 末白光
explodeEffectOnShield: 末白光
directDamage: -1
mutatorX_ifUnitWithoutTags: ʚ♡⃛ɞ(ू•ᴗ•ू❁)
mutatorX_directDamageMultiplier: 0.00001
color: #AAFFFFFF
spawnProjectilesOnCreate: 1-2

[projectile_1-2]
@copyFromSection: projectile_1
life: 20
beamImage: SHARED:beam3.png

[projectile_2]
@copyFromSection: projectile_1-2
life: 30
beamImage: beamLargeTest.png
color: #60FFFFFF
explodeEffect: NONE
explodeEffectOnShield: NONE
spawnProjectilesOnCreate: NONE

[projectile_3]
life: 25
instant: true
instantReuseLast: true
moveWithParent: true

explodeEffect: 微聚粒
explodeEffectOnShield: 微聚粒

directDamage: -1
mutatorX_ifUnitWithoutTags: ʚ♡⃛ɞ(ू•ᴗ•ू❁)
mutatorX_directDamageMultiplier: 0.00001

color: #50CCCCCC

laserEffect: true

[effect_光芒]
priority: veryhigh
attachedToUnit: true
life: 50
alpha: 1
scaleFrom: 2
scaleTo: 0.5
image: SHARED:light_50.png
color: #FFFFFF
drawUnderUnits: false
createWhenOffscreen: true
showInFog: true

[effect_白光]
priority: low
life: 30
alpha: 2
scaleFrom: 1
scaleTo: 1
image: SHARED:light_50.png
color: #FFFFFF
drawUnderUnits: false

[effect_白雾]
priority: verylow
stripIndex: effects
life: 120
color: #FFFFFF
scaleFrom: 0.9
scaleTo: 1.5
alpha: 0.3
atmospheric: true
dirOffsetRandom: 180
hSpeed: 0.3

[effect_末白光]
priority: low
life: 25
alpha: 0.8
scaleFrom: 1
scaleTo: 0.5
image: SHARED:light_50.png
drawUnderUnits: false

[effect_微聚粒]
priority: low
life: 30
lifeRandom: 5
fadeInTime: 20
fadeOut: false
alpha: 0.8
scaleFrom: 2
scaleTo: 0
image: 星光5.png
drawUnderUnits: false
dirOffsetRandom: 180
dirSpeedRandom: 1
dirSpeed: 5

[movement]
movementType: AIR
targetHeight: 1
targetHeightDrift: 0.5
