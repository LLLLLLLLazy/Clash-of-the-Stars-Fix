
[core]
name: 黑寡妇
displayDescription: -攻击地面与空中 \n -可以越过峭壁 \n -毒素附加: 15
class: CustomUnitMetadata
price: 1300
maxHp: 660
mass: 5000

techLevel: 2
buildSpeed: 0.0015
#availableInDemo: true

radius: 14
displayRadius: 19
isBio: true
isBug: true
tags: units, 虫族, 中型虫, 黑寡妇, 蜘蛛, 固定射击

selfRegenRate: 0.1

softCollisionOnAll: 12

[action_Upgrade]
convertTo:腐败的黑寡妇
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
price:腐蚀=250
text:腐蚀 - 破败
displayType:upgrade
buildSpeed:15.2s
pos:2
description:-毒素大幅提升,但无法对空\n-将所受到的部分伤害转化为毒素\n-射程提升\n-缓慢失去生命……\n-过度的腐蚀会带来恶果……无论对谁……
descriptionAddUnitStats: ${section.convertTo}
iconExtraImage:SHARED:icon_upgrade_top.png
iconExtraColor:#AAFFFFFF
attachments_deleteNumUnits: 1
ai_isHighPriority: true
tags=腐蚀
setUnitMemory: 属性[24]=0, 属性[20]=0

#[action_Upgrade2]
#convertTo:结网魔蛛
#price:腐蚀=200
#text:腐蚀 - 结网
#displayType:upgrade
#buildSpeed:21.7s
#pos:1
#description:-射出蛛丝牵引敌人\n-但不具备攻击力
#descriptionAddUnitStats: ${section.convertTo}
#iconExtraImage:SHARED:icon_upgrade_top.png
#iconExtraColor:#AAFFFFFF
#whenBuilding_cannotMove: true
#whenBuilding_rotateTo: 0
#whenBuilding_rotateTo_orBackwards: true
#isLocked: if self.globalTeamTags(includes='中刻{I}')
#isLockedMessage: AI:停用低级腐蚀

[hiddenAction_腐蚀中]
autoTrigger: if self.queueSize(withActionTag="腐蚀")>0 and not self.tags(includes='腐蚀中')
setUnitMemory: 属性[24]=-${movement.moveSpeed}*0.6
alsoTriggerAction: 属性变化
temporarilyAddTags: 腐蚀中

[hiddenAction_腐蚀停止]
autoTrigger: if self.queueSize(withActionTag="腐蚀")<1 and self.tags(includes='腐蚀中')
setUnitMemory: 属性[24]=0
alsoTriggerAction: 属性变化
temporarilyRemoveTags: 腐蚀中

[hiddenAction_自动腐蚀]
autoTrigger: if (self.hasUnitInTeam(withTag="腐败-黑寡妇") and self.hasUnitInTeam(withTag="腐蚀之意")) and self.hasResources(${action_Upgrade.price}) and self.queueSize(empty=true) and not self.isAttacking
alsoQueueAction: Upgrade
addResourcesWithLogic: ${action_Upgrade.price}*-1


[hiddenAction_女皇强化]
autoTrigger: if numberOfUnitsInTeam(withTag='zz王', withinRange=400)>0 and not self.tags(includes='女皇强化')
setUnitMemory: 属性[20]=50
alsoTriggerAction: 属性变化
temporarilyAddTags: 女皇强化

[hiddenAction_女皇强化结束]
autoTrigger: if numberOfUnitsInTeam(withTag='zz王', withinRange=400)<1 and self.tags(includes='女皇强化')
setUnitMemory: 属性[20]=0
alsoTriggerAction: 属性变化
temporarilyRemoveTags: 女皇强化

[graphics]
total_frames: 1

image: 黑寡妇.png
image_wreak: NONE
image_turret: NONE

#AUTO
image_shadow:AUTO
shadowOffsetX:2
shadowOffsetY:2

lock_body_rotation_with_main_turret:true

animation_moving_start:0
animation_moving_end:0
animation_moving_speed:3

animation_idle_start:0
animation_idle_end:0
animation_idle_speed:80
animation_idle_scale_start:1
animation_idle_scale_end:1.03
animation_idle_pingPong:true

animation_attack_start:0
animation_attack_end:0
animation_attack_speed:15
animation_attack_scale_start:1
animation_attack_scale_end:0.97
animation_attack_pingPong:true

[attack]
canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits: true
canAttackUnderwaterUnits: false

isFixedFiring: true

turretSize: 20
turretTurnSpeed: 9

maxAttackRange: 190
shootDelay: 60

[turret_1]
x:0
y:0

shoot_light:#FF00CCCC

recoilOffset:-3
recoilOutTime:6
recoilReturnTime:18

[projectile_1]
tags= T-projectile
directDamage:50
largeHitEffect:true
life:80
speed:5
targetSpeed:8
#frame: 0
frame:6

lightColor:#00ff00
lightSize:0.6

trailEffect: CUSTOM:尾气雾

explodeEffect: CUSTOM:explode, CUSTOM:shockwave

spawnUnit: 有毒的雾
mutatorX_ifUnitWithoutTags: 毒免疫, 效果免疫, 不会受伤
mutatorX_addResourcesDirectHit: 毒素=15

[resource_毒素]
displayName: 毒素

[effect_尾气雾]
stripIndex: effects
frameIndex: 0
priority: veryhigh

life: 20
fadeOut: true
attachedToUnit: false
color: #FF3BFF00
hSpeed: 0.3
scaleFrom: 0.7
scaleTo: 0.1
alpha: 0.6
drawUnderUnits: false
yOffsetRelative: -1
xOffsetRelativeRandom: 2
xSpeedRelativeRandom: 0.1
atmospheric: true


[effect_explode]
life: 25
fadeOut: false
attachedToUnit: false
image: explode_big2.png
scaleFrom: 1
scaleTo: 1
alpha: 0.9
total_frames: 14
animateFrameStart: 0
animateFrameEnd: 13
animateFrameSpeed: 0.5
alsoPlaySound: missile_hit:0.5

[effect_shockwave]
stripIndex: shockwave_large
life: 25
scaleFrom: 0
scaleTo: 0.75
alpha: 1
color: #B1FF99


[leg_1]
x:-18
y:0
attach_x:0
attach_y:0
moveSpeed:4.1
resetAngle:20

heightSpeed:0.8

image_leg:leg.png
image_foot:NONE

drawLegWhenZoomedOut:true

dust_effect:false

holdDisMin:15
holdDisMax:24

[leg_2]
x:18
y:0
attach_x:0
attach_y:0
copyFrom:1

[leg_3]
x:-15
y:13
attach_x:0
attach_y:2
copyFrom:1

[leg_4]
x:15
y:13
attach_x:0
attach_y:2
copyFrom:1

[leg_5]
x:-15
y:-13
attach_x:0
attach_y:-2
copyFrom:1

[leg_6]
x:15
y:-13
attach_x:0
attach_y:-2
copyFrom:1

[movement]
movementType: OVER_CLIFF
moveSpeed: 0.9

moveAccelerationSpeed:0.04
moveDecelerationSpeed:0.12


maxTurnSpeed:2.6
turnAcceleration:0.5

moveSlidingMode:true
moveIgnoringBody:true
moveSlidingDir:181


[hiddenAction_AIupgrade]
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.queueSize(empty=true) and self.hasResources(腐蚀=200) and self.globalTeamTags(includes='战隙{I}') and not self.globalTeamTags(includes='中刻{I}')
alsoQueueAction: Upgrade
addResources: 腐蚀=-200

[hiddenAction_AI走位]
addWaypoint_type: move
addWaypoint_prepend: true
addWaypoint_maxTime: 3s
addWaypoint_target_mapMustBeReachable: true
addWaypoint_target_fromReference: attachment.getOffsetRelative(y=-80)
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.isAttacking and numberOfUnitsInEnemyTeam(greaterThan=0, withinRange=${attack.maxAttackRange -5}, withTag='units') and attachment.isAttacking and (not self.hasActiveWaypoint(type='move') or distanceBetween(self, activeWaypointTarget) < 20)
[hiddenAction_AIclearWaypoints]
clearAllWaypoints: true
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.isAttacking and not numberOfUnitsInEnemyTeam(greaterThan=0, withinRange=${attack.maxAttackRange +1}, withTag='units') and self.hasActiveWaypoint(type='move')

[attachment_AI向定位]
x: 0
y: 0
onCreateSpawnUnitOf: AI单位向定位
alwaysAllowedToAttackParentsMainTarget: true