[core]

name: 重型穿刺虫

copyFrom: mechs_small_common.ini
displayDescription: -有着穿刺能力的强大范围攻击\n-远程 强大 对地对空
price: 17000
maxHp: 4000
mass: 40000

techLevel: 1
buildSpeed: 0.00025
#availableInDemo: true

experimental: true

radius: 25
displayRadius: 27

softCollisionOnAll: 20

selfRegenRate: 0.15
#energyMax: 4
#energyRegen: 0.02
#energyNeedsToRechargeToFull: true

fogOfWarSightRange: 22

transportSlotsNeeded: 3

isBug: true
isBio: true
tags: units, 虫族, 大型虫, 大型虫-

[action_Upgrade]
convertTo: 航灵穿刺虫
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
price: 腐蚀=4000
text: 腐蚀 - 航灵
displayType: upgrade
buildSpeed: 83.3s
pos: 1
description: -持续追踪穿刺弹\n-随主体意志攻击
descriptionAddUnitStats: ${section.convertTo}
iconExtraImage:SHARED:icon_upgrade_top.png
iconExtraColor:#AAFFFFFF
tags=腐蚀
setUnitMemory: 属性[24]=0

[hiddenAction_腐蚀中]
autoTrigger: if self.queueSize(withActionTag="腐蚀")>0 and not self.tags(includes='腐蚀中')
setUnitMemory: 属性[24]=-${movement.moveSpeed}*0.6
alsoTriggerAction: 属性变化
temporarilyAddTags: 腐蚀中

[hiddenAction_腐蚀停止]
autoTrigger: if self.queueSize(withActionTag="腐蚀")<1 and self.tags(includes='腐蚀中')
setUnitMemory: 属性[24]=0
alsoTriggerAction: 属性变化
temporarilyRemoveTags: 腐蚀中

[hiddenAction_自动腐蚀]
autoTrigger: if (self.hasUnitInTeam(withTag="腐蚀-航灵穿刺虫") and self.hasUnitInTeam(withTag="腐蚀之意")) and self.hasResources(${action_Upgrade.price}) and self.queueSize(empty=true) and not self.isAttacking
alsoQueueAction: Upgrade
addResourcesWithLogic: ${action_Upgrade.price}*-1


[graphics]

image: 底座.png

image_wreak: NONE
image_turret: 主体.png
imageScale: 1.1
scaleTurretImagesTo: 29

image_shadow: AUTO
shadowOffsetX: 4
shadowOffsetY: 4

teamColorsOnTurret: true
lock_body_rotation_with_main_turret: true

[attack]
canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits: true
canAttackUnderwaterUnits: false

turretSize: 0
turretTurnSpeed: 3


maxAttackRange: 310
shootDelay: 105

aimOffsetSpread: 0

turretRotateWithBody: false

[turret_2]
x: 0
y: 18
idleDir: 0

image: 能量.png

turnSpeed: 2.9
turnSpeedAcceleration: 0.3

#canShoot: false


#note: lock_body_rotation_with_main_turret is needed for recoil to work on the body
recoilOffset: -15
recoilOutTime: 5
recoilReturnTime: 90


projectile: 1


shoot_sound: plasma_fire
shoot_sound_vol: 0.03
#shoot_flame: small
#shoot_light: #FFccCCEE
attachedTo: 1
slave: true

[turret_1]
x: 0
y: 0
canShoot: false
image: bug_ranged_t2.png

shoot_light: #FF00CCCC

recoilOffset: -5
recoilOutTime: 4
recoilReturnTime: 50

#shoot_flame: smoke



[projectile_1]
areaDamage: 195
areaRadius: 45
life: 0
areaHitAirAndLandAtSameTime: true

invisible: true
explodeOnEndOfLife: true
explodeEffect: NONE

speed: 0

spawnProjectilesOnEndOfLife: main

[projectile_main]
areaDamage: 195
areaRadius: 45
life: 5
#时间调小点

frame: 11
deflectionPower: -1
drawSize: 1.2
explodeOnEndOfLife: true
#终寿爆炸

image: 弹.png
largeHitEffect: true
speed: 8
turnSpeed: 0
#速度在这可作为两次爆炸间距(不是时间间距，是距离)，需要乘以寿命

targetGround: true
targetGroundSpread: 9999

spawnProjectilesOnEndOfLife: main(recursionLimit=11)
#循环生成

areaHitAirAndLandAtSameTime: true
#空中地面同事伤害

trailEffect: CUSTOM:projectileTrail
trailEffectRate: 1

[effect_projectileTrail]
createWhenZoomedOut: false
priority: low
image: SHARED:light_25.png
life: 28
fadeOut: true
attachedToUnit: false
color: #FF3BFF00
fadeInTime: 2
scaleFrom: 1.0
scaleTo: 0.8
alpha: 0.3
drawUnderUnits: true
ySpeedRelative: -0.4
atmospheric: true







[movement]
#movementType: LAND
movementType: OVER_CLIFF



moveSpeed: 0.5
moveAccelerationSpeed: 0.04
moveDecelerationSpeed: 0.12


maxTurnSpeed: 2.0
turnAcceleration: 0.5

moveSlidingMode: true
moveIgnoringBody: true
moveSlidingDir: 181

[hiddenAction_AIretreat]
clearAllWaypoints: true
addWaypoint_type: touchTarget
addWaypoint_prepend: true
addWaypoint_maxTime: 20s
addWaypoint_target_nearestUnit_tagged: 修复点
addWaypoint_target_nearestUnit_team: own
autoTrigger: if self.globalTeamTags(includes='AI系统') and not self.hasActiveWaypoint(type='touchTarget') and self.hasFlag(id=1)
[hiddenAction_AIsetFlag]
autoTrigger: if self.globalTeamTags(includes='AI系统') and (self.hp(lessThan=1200))
addResources: setFlag=1
[hiddenAction_AIunsetFlag]
autoTrigger: if self.globalTeamTags(includes='AI系统') and (self.hp(full=true))
addResources: unsetFlag=1