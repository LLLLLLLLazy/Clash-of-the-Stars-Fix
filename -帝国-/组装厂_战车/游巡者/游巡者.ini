
[core]
name: 游巡者
displayDescription: -全副武装 \n -攻击地面单位 \n -重型狙击炮 \n -短距离爆弹炮 \n -能够在水面上移动 \n-爆弹炮范围: ${turret_1.limitingRange}

class: CustomUnitMetadata
price: 11000
maxHp: 4000
mass: 30000

fogOfWarSightRange: 18

radius: 40
shieldRenderRadius:	50

techLevel: 2
buildSpeed: 41.7s

tags: units, 坦克, 游巡者

transportSlotsNeeded: 3

selfRegenRate: 0.1

energyMax: 7
energyRegen: 0.004

effectOnDeath: CUSTOM:shockwave_large, large

[action_emergencyShield]
isVisible: if not self.hasFlag(id=1)
resetCustomTimer: true
text: 冲击立场
description: -开启护盾 \n -抵挡1500伤害 \n -护盾被攻击时推开周围的敌人 \n -护盾最多存在5s \n -该技能只可使用一次
displayType: upgrade
resourceAmount: shield
resourceAmount_setValue: 1500
fireTurretXAtGround: 1
fireTurretXAtGround_withOffset:0,0
fireTurretXAtGround_withProjectile: ImpactShield
addResources: setFlag=1
spawnEffects: CUSTOM:emergencyShield
buildSpeed: 0s
pos: 1

[hiddenAction_shieldRetraction]
autoTrigger: if self.customTimer(laterThanSeconds=5) and self.hasFlag(id=1) and not self.hasFlag(id=2)
fireTurretXAtGround: 3
fireTurretXAtGround_withOffset:0,0
fireTurretXAtGround_withProjectile: ImpactShield
addResources: shield=-1500, setFlag=2

[hiddenAction_ImpactShield]
autoTrigger: if self.hasTakenDamage(withinSeconds=1) and self.shield(greaterThan=50)
fireTurretXAtGround: 3
fireTurretXAtGround_withOffset:0,0
fireTurretXAtGround_withProjectile: ImpactShield

[projectile_ImpactShield]
tags= T-projectile
areaDamage: 0
areaRadius: 250
areaExpandTime: 30
life: 50
instant: true
areaHitAirAndLandAtSameTime: true
drawUnderUnits: true
pushForce: 5
pushVelocity: 5

explodeEffect: CUSTOM:ImpactShield

[effect_ImpactShield]
image: 红冲.png
life: 30
scaleFrom: 0
scaleTo: 4
alpha: 1
dirSpeedRandom: 3

[effect_emergencyShield]
image: 护盾.png
life: 50
fadeOut: true
attachedToUnit: true
scaleFrom: 0.6
scaleTo: 0.5
alpha: 2
dirSpeedRandom: 5
drawUnderUnits:false

[graphics]
total_frames: 1
image: 反击者.png
image_wreak: 反击者残骸.png
image_turret: 反击者炮塔.png
image_shield: 护盾.png

image_shadow: AUTO
shadowOffsetX: 3
shadowOffsetY: 3

#scaleImagesTo:55
#scaleTurretImagesTo:30

teamColorsOnTurret: true


[attack]
canAttack: true
canAttackFlyingUnits: false
canAttackLandUnits:  true
canAttackUnderwaterUnits: false

turretSize: 10
turretTurnSpeed: 4

maxAttackRange: 290
shootDelay: 70

aimOffsetSpread: 0

[turret_1]
#爆弹炮
x: -3
y: 18
attachedTo: 3
slave: true

projectile: 1
energyUsage: 1

limitingRange: 190

shoot_sound: large_gun_fire2
shoot_sound_vol: 0.5
shoot_flame: large, CUSTOM:sparks*3
shoot_light: #FFccCCEE

image: 反击者短炮管.png

recoilOffset: -3
recoilOutTime: 3
recoilReturnTime: 15

[turret_2]
#狙击炮
x: 4
y: 30
barrelY: 24
attachedTo: 3
slave: true

projectile: 2

delay: 200

shoot_sound: large_gun_fire1
shoot_sound_vol: 1
shoot_flame: shockwave, CUSTOM:sparks2*3, CUSTOM:反红光
shoot_light: #ff0000

image: 反击者长炮管.png

recoilOffset: -5
recoilOutTime: 8
recoilReturnTime: 35

[turret_3]
#turret
x: 0
y: 2

canShoot: false
shoot_sound: large_gun_fire2
shoot_sound_vol: 0.5

turnSpeed: 2.5
turnSpeedAcceleration: 0.2
turnSpeedDeceleration: 0.4

recoilOffset: -0.75
recoilOutTime: 3
recoilReturnTime: 17

[projectile_1]
tags= T-projectile
directDamage: 180
life: 300
speed: 8
frame: 5
drawSize: 1.4
largeHitEffect: true

lightColor: #FFccCCEE
lightSize: 0.6

spawnProjectilesOnExplode:1-2*3(offsetRandomXY=30)

[projectile_1-2]
tags= T-projectile
life: 0
speed: 0
explodeOnEndOfLife: true
invisible: true

largeHitEffect: true
targetGround: true

areaDamage: 35
areaRadius: 40
areaHitAirAndLandAtSameTime: true

[projectile_2]
tags= T-projectile
directDamage: 300
areaDamage: 135
areaRadius: 40
life: 200

frame: 7
drawSize: 1.3

#speed: 2
speed: 15
#targetSpeed: 8
#targetSpeedAcceleration: 2

deflectionPower: 2

lightColor: #ff0000
lightSize: 1

trailEffect: CUSTOM:projectileLight, CUSTOM:projectileTrail
trailEffectRate: 0.3

explodeEffect: CUSTOM:hitLightFlash, CUSTOM:projectilePassThough, CUSTOM:lightSlowFade, CUSTOM:explodeSmall, CUSTOM:红冲击波

[effect_hitLightFlash]
priority:high

image: SHARED:light_50.png
life: 20
fadeOut: true
attachedToUnit: false
color: #ff0000

scaleFrom: 1.6
scaleTo: 1.6
alpha: 1
drawUnderUnits:false

[effect_projectilePassThough]
priority:high
#frameIndex: 4
#stripIndex: projectiles
image: 激光弹.png
life: 10
#fadeOut: true
attachedToUnit: false
#color: #FFFFFF
scaleFrom: 1.3
scaleTo: 1.3
alpha: 1
drawUnderUnits: false
ySpeedRelative: 6
atmospheric: true

[effect_lightSlowFade]
image: SHARED:light_50.png
life: 40
fadeOut: true
attachedToUnit: true
color: #FF0000
scaleFrom: 1
scaleTo: 0.5
alpha: 1.0
drawUnderUnits:false

[effect_projectileLight]
priority: low

image: 激光弹.png
life: 10
#fadeOut: true
attachedToUnit: false
color: #FFEECCCC
scaleFrom: 1.5
scaleTo: 1.5
alpha: 1.0
drawUnderUnits:false
liveAfterAttachedDies: false

[effect_projectileTrail]
priority: verylow
image: SHARED:light_50.png
life: 35
fadeOut: true
attachedToUnit: false
color: #ff0000
scaleFrom: 0.5
scaleTo: 0.5
alpha: 0.7
drawUnderUnits:true
ySpeedRelative: -0.5
xSpeedRelativeRandom: 0.15

[effect_explodeSmall]
color: #ff0000
life: 25
attachedToUnit: true
image: 白爆.png
scaleFrom: 1
scaleTo: 1
total_frames: 14
animateFrameStart: 0
animateFrameEnd: 13
animateFrameSpeed: 0.5
fadeOut: false
alsoPlaySound: missile_hit

[effect_shockwave]
stripIndex: shockwave
life: 20
scaleFrom: 0
scaleTo: 1
color: #FF8080
ySpeedRelative: -0.5
attachedToUnit: true

[effect_红冲击波]
stripIndex: shockwave
life: 25
scaleFrom: 0
scaleTo: 1.6
color: #FF8080

[effect_反红光]
priority:high

image: SHARED:light_50.png
life: 30
fadeOut: true
attachedToUnit: true
color: #ff0000

scaleFrom: 0.8
scaleTo: 1
alpha: 1
drawUnderUnits:false
ySpeedRelative: -0.5
xSpeedRelativeRandom: 0.1

[effect_sparks]
life: 100
xSpeedRelativeRandom: 0.6
ySpeedRelative: 1.2
ySpeedRelativeRandom: 0.4
image: SHARED:spark.png
scaleFrom: 1.5
scaleTo: 0.1
color: #ffffff

[effect_sparks2]
@copyFromSection: effect_sparks
color: #ff0000
alpha: 0.7


[effect_shockwave_large]
stripIndex: shockwave_large
scaleFrom: 0.2
scaleTo: 1.5
life: 30
color: #C2AFCC

[movement]
movementType: HOVER
moveSpeed: 0.6
moveAccelerationSpeed: 0.03
moveDecelerationSpeed: 0.03

maxTurnSpeed: 0.9
turnAcceleration: 0.08

targetHeight: 1.5
targetHeightDrift: 0.5

reverseSpeedPercentage: 0.8
moveIgnoringBody: true
moveSlidingMode: true