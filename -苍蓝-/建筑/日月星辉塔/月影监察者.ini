
[core]
name: 月影监察者
price: 1200, 月曜=10
maxHp: 360
mass: 1000
tags: units

maxShield: 640
shieldRegen: -0.05

radius: 18
buildSpeed: 0.001
displayDescription: -逆\n-攻击地面单位\n-对目标造成强烈波动,伤害逐渐衰弱\n-高维存在:被摧毁或回收后需支付1000$代价\n-汐月回溯:被摧毁后恢复周围所有单位护盾\n-水中倒月:可建立于水上并显现一个可攻击水下的倒影

isBuilding: true
fogOfWarSightRange: 15

footprint: 0,0,0,0
constructionFootprint: 0,0,0,0

buildingToFootprintOffsetY: -1

borrowResourcesWhileAlive: -1000

energyMax: 6
#energyRegen: -0.0
energyStartingPercentage: 0

fireTurretXAtSelfOnDeath: explode

#autoTriggerCooldownTime: 0.13s
#autoTriggerCooldownTime_allowDangerousHighCPU:true

[hiddenAction_能量清空]
autoTriggerOnEvent: killedAnyUnit
autoTrigger: if not self.isAttacking() or self.ammo(lessThan=1)
addEnergy: -6

[hiddenAction_-ammo]
autoTrigger: true
addResources: ammo=-1
alsoTriggerAction:-ammo2

[hiddenAction_-ammo2]
requireConditional: if self.ammo(greaterThan=4)
addResources: ammo=-1


[hiddenAction_capital]
@global creditsDeduct: 1000
autoTriggerOnEvent: created
addResources: -${creditsDeduct}

[hiddenAction_死亡]
autoTriggerOnEvent: destroyed
requireConditional: if self.resource.credits<1000
showQuickWarLogToPlayer: 因'月影监察者'消失而扣除${creditsDeduct}$


[hiddenAction_水中倒月]
autoTrigger: if getOffsetAbsolute(y=20).isOverwater and self.numberOfAttachedUnits < 1
attachments_addNewUnits: 水中倒月

[attachment_1]
x: 0
y: 0
height: -1


[graphics]
image: 月影监察者.png
#image_shield: yellow_shield.png

[decal_星阵]
isVisible: if getOffsetAbsolute(y=20).isOverwater
layer: beforeBody
image: 五芒星阵.png
imageScale: 0.28
yOffsetAbsolute: 16
color: #63e6e8
alpha: 0.25

[decal_底光]
@copyFromSection: decal_星阵
image: 圆.png
alpha: 0.12

[decal_水中倒影]
isVisible: if getOffsetAbsolute(y=20).isOverwater
layer: shadow
image: 水中倒月.png
yOffsetAbsolute: 37
alpha: 0.5

[decal_倒影盾]
@copyFromSection: decal_水中倒影
image: shield_mid.png
alpha: self.shield * 0.00039
imageScale: 0.52



[attack]
canAttack:true
canAttackFlyingUnits: false
canAttackLandUnits: true
canAttackUnderwaterUnits:false
maxAttackRange: 200
shootDelay: 5
aimOffsetSpread: 0
turretSize: 0

[turret_0]
x: 0
y: 16
canShoot: false
turnSpeed: 3
shouldResetTurret: false

[turret_1.0]
x: 0
y: 0
attachedTo: 0
slave: true
projectile: 1.0
shoot_flame: CUSTOM:shieldwave低透明, CUSTOM:conceptshield低透明

resourceUsage: energy=-0.06, ammo=-1
altProjectile: 1.1
altProjectileCondition: if self.energy(greaterThan=1) and not self.energy(greaterThan=2)
canAttackCondition: if not self.energy(greaterThan=2)
[turret_1.2]
@copyFromSection: turret_1.0
canAttackCondition: if self.energy(greaterThan=1.9) and not self.energy(greaterThan=4)
projectile: 1.2
altProjectile: 1.3
altProjectileCondition: if self.energy(greaterThan=3) and not self.energy(greaterThan=4)
[turret_1.4]
@copyFromSection: turret_1.0
canAttackCondition: if self.energy(greaterThan=3.89) and not self.energy(full=true)
projectile: 1.4
altProjectile: 1.5
altProjectileCondition: if self.energy(greaterThan=5) and not self.energy(full=true)
[turret_1.6]
@copyFromSection: turret_1.0
shoot_flame: NONE
canAttackCondition: if self.energy(greaterThan=5.9)
projectile: 1.6

[projectile_1.0]
tags= T-projectile
life: 20
instant: true
instantReuseLast: true
instantReuseLast_alsoChangeTurretAim: true
moveWithParent: true
beamImage:      SHARED:beam3.png
beamImageEnd:   SHARED:beam1_end.png
beamImageStart: SHARED:beam1_start.png
beamImageOffsetRate: 1.5
sweepOffsetFromTargetRadius:0.2
sweepSpeed:20
explodeEffect: CUSTOM:shieldwave, CUSTOM:conceptshield
explodeEffectOnShield: CUSTOM:shieldwave, CUSTOM:conceptshield

areaDamage: 20
areaRadius: 35
color: #63e6e8
[projectile_1.1]
@copyFromSection:projectile_1.0
areaDamage: 15
[projectile_1.2]
@copyFromSection:projectile_1.0
areaDamage: 12
[projectile_1.3]
@copyFromSection:projectile_1.0
areaDamage: 10
[projectile_1.4]
@copyFromSection:projectile_1.0
areaDamage: 8
[projectile_1.5]
@copyFromSection:projectile_1.0
areaDamage: 6
[projectile_1.6]
@copyFromSection:projectile_1.0
areaDamage: 2
areaRadius: 10
color: #ffffff

explodeEffect: NONE
explodeEffectOnShield: NONE

[turret_explode]
x: 0
y: 0
canShoot: false
projectile: explode

[projectile_explode]
tags= T-projectile
life: 99
instant: true
targetGround: true
areaDamage: 0
spawnUnit: 汐月回溯
explodeEffect: NONE
explodeEffectOnShield: NONE

[effect_shieldwave]
image: hit.png
life: 10
scaleFrom: 1.0
scaleTo: 1.0
alpha: 1.0
alsoPlaySound: laser_deflect

[effect_conceptshield]
image: shield_mid.png
life: 10
scaleFrom: 0.5
scaleTo: 0.5
alpha: 1.0

[effect_shieldwave低透明]
@copyFromSection: effect_shieldwave
alpha: 0.5

[effect_conceptshield低透明]
@copyFromSection: effect_conceptshield
alpha: 0.5

[movement]
movementType: HOVER
targetHeight: 0
moveSpeed: 0
maxTurnSpeed: 0

[ai]
upgradedFrom: 自然飞矢塔
buildPriority: 0.22
noneInBaseExtraPriority: 0.17
maxEachBase: 3


[global_resource_日耀]
hidden: false
displayName: 日耀
displayColor: #A0FF9500
priority: 0.3

[global_resource_月曜]
hidden: false
displayName: 月曜
displayColor: #A04060FF
priority: 0.3