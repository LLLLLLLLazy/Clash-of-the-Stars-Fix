
[core]
name: 核武模块
copyFrom: common_slot.ini

displayLocaleKey: NONE
overrideAndReplace: modularSpider_antinuke

displayText: 核武模块
displayDescription:  -可以拦截从核弹发射井发射的核导弹 \n -若要拦截，需要建造反核导弹 \n -反核范围1500 \n -可以关闭反核功能，关闭后此模块将不会拦截核弹 \n -每120s可消耗资源发射一枚核导弹

price: 20000

energyMax: 120
energyRegen: ${1/60}
energyStartingPercentage: 0
energyNeedsToRechargeToFull: true

isLockedIfGameModeNoNuke: false

tags: ${baseTags}

[action_buildAntiNuke]
price:  3000
id: 建造反核导弹
text: i:gui.actions.buildAntiNuke
description:i:gui.actions.buildAntiNuke.description
displayType: NONE
buildSpeed: 0.001
pos: 0.2
isActive:if self.ammoIncludingQueued(lessThan=12)
addResources: ammo=1

ai_isDisabled: if self.ammo(greaterThan=3)

iconImage: SHARED:icon_build.png


[action_showAntiNukeCount]
#infoOnly: true
addResources: ammo=1
price:  ammo=1
id: 显示反核计数
text: i:gui.actions.antiNukeCount
description:i:gui.actions.antiNukeCount.description
buildSpeed: 0s
pos: 0.1
displayRemainingStockpile: true
displayType: infoOnlyStockpile


isActive:false
isVisible: if self.ammo(greaterThan=0) and not self.hasFlag(id=1)

iconImage: SHARED:icon_nuke_stockpile.png



[action_showAntiNukeCountEmpty]
#infoOnly: true

id: 反核武器计数为空
text: i:gui.actions.antiNukeCountEmpty
description:i:gui.actions.antiNukeCount.descriptionEmpty
buildSpeed: 0s
pos: 0.1
#displayRemainingStockpile: true
displayType: infoOnlyStockpile


isActive:false
isVisible: if self.ammo(lessThan=1) and not self.hasFlag(id=1)

iconImage: SHARED:icon_nuke_stockpile.png

isGuiBlinking: true

[action_showAntiNukeCountOffline]
addResources: ammo=1
price:  ammo=1

id: 离线显示反核计数
text: i:gui.actions.antiNukeCountOffline
description:i:gui.actions.antiNukeCount.descriptionOffline
buildSpeed: 0s
pos: 0.1
displayRemainingStockpile: true
displayType: infoOnlyStockpile


isActive:false
isVisible: if self.hasFlag(id=1)

iconImage: SHARED:icon_nuke_stockpile.png

isGuiBlinking: true


[action_isEnabled]
id: isEnabled
text: i:gui.actions.enabled
description:i:gui.actions.enabled.description

buildSpeed: 0s
pos: 0.3

addResources: setFlag=1
isVisible: if not self.hasFlag(id=1)

iconImage: SHARED:icon_on.png
iconExtraColor: #FFFFFFFF

#don't wait for nuke building
highPriorityQueue: true

ai_isDisabled: true

canPlayerCancel: false
allowMultipleInQueue: false
#No confirm needed on mobile
alwaysSinglePress: true

[action_isDisabled]
id: isDisabled
text: i:gui.actions.disabled
description:i:gui.actions.disabled.description

buildSpeed: 0s
pos: 0.3

addResources: unsetFlag=1
isVisible: if self.hasFlag(id=1)

iconImage: SHARED:icon_off.png
iconExtraColor: #FFFFFFFF

isGuiBlinking: true

#don't wait for nuke building
highPriorityQueue: true

ai_isDisabled: true

canPlayerCancel: false
allowMultipleInQueue: false
#No confirm needed on mobile
alwaysSinglePress: true


[action_launchNuke]
fireTurretXAtGround: siloTop
price: energy=120, 15000

id: launchNuke
text: i:gui.actions.launchNuke
description:i:gui.actions.launchNuke.description
displayType: action
buildSpeed: 6s
pos: 0.4
displayRemainingStockpile: true
highPriorityQueue: true
onlyOneUnitAtATime: true

addActionCooldownTime: 120s

iconImage: SHARED:icon_attack_point.png

[hiddenAction_energyStarting]
autoTrigger: if not self.completed and not self.hasFlag(id=2)
setResourcesWithLogic: energy=0, setFlag=2

[hiddenAction_completed]
autoTrigger: if self.completed and self.hasFlag(id=2)
setResourcesWithLogic: unsetFlag=2
addActionCooldownTime: 120s
addActionCooldownApplyToActions: launchNuke

#--------------------
[action_沙盒-填满能量]
isVisible: if substring(str(createMarker(x=-1000,y=-1000).nearestUnit),0,15) == "editorOrBuilder"
displayType: action
id: ${section.text}
tags=${section.text}
text: 沙盒-填满能量
description: -沙盒特供 \n -回满能量并清除所有冷却 \n -可使模块立即建造完成
iconImage: SHARED:cone_inverted_normal_128.png
addResources: energy=1000
clearAllActionCooldowns: true
buildSpeed: 0.05s

[hiddenAction_沙盒-立即建造]
autoTriggerOnEvent: queueItemAdded(withActionTag='沙盒-填满能量')
requireConditional: if not self.completed
addResources: unsetFlag=2
setBuilt:1
#--------------------

[attack]
canAttack: true
canAttackFlyingUnits: false
canAttackLandUnits:   false
canAttackUnderwaterUnits: false
maxAttackRange: 800



[turret_silo]
#anti-nuke turret
x: 0
y: 0
idleDir:0

invisible: true
delay: 0s

interceptProjectiles_withTags: nuke
interceptProjectiles_andTargetingGroundUnderDistance: 1000
#interceptProjectiles_andUnderDistance: 2200
interceptProjectiles_andUnderDistance: 1500
interceptProjectiles_andOverHeight:50


shoot_sound:nuke_launch
shoot_sound_vol:0.15
shoot_light:#FFEECCCC

projectile: antiNukeProjectile
size: 1

turnSpeed: 40

resourceUsage: ammo=1, hasMissingFlag=1

shoot_flame:shockwave, smoke
#shoot_flame:custom:nukeLaunch



#onShoot_playAnimation: fireNuke

[projectile_antiNukeProjectile]
tags= T-projectile
#anti-nuke
directDamage: 600

life: 99999
speed: 4.0
targetSpeed: 30.0
targetSpeedAcceleration:0.1

trailEffect: smog
trailEffectRate:2

largeHitEffect: true
#ballistic: true
#ballistic_delaymove_height:30
#ballistic_height: 110
frame: 10
#shadowFrame:1

drawType:0

targetGround: true
areaDamage: 100
areaRadius: 60

areaExpandTime:75

deflectionPower:-1

lightColor: #FFEEEE00
lightSize: 1

alwaysVisibleInFog: true

[effect_smog]
stripIndex: effects
frameIndex: 0
priority:low

life: 100
fadeOut: true
attachedToUnit: false
color: #fcbe03
fadeInTime:2
scaleFrom: 0.7
scaleTo: 2.1
alpha: 0.8
drawUnderUnits:false
ySpeedRelative:-0.3



[turret_siloTop]
#nuke turret
x: 0
y: 0
idleDir: 0
barrelHeight: 3

invisible: true
delay: 6s

shoot_sound:nuke_launch
shoot_sound_vol:0.27
shoot_light:#FFEECCCC
resourceUsage: energy=120

projectile: nukeProjectile
size: 1

turnSpeed: 40


#shoot_flame:shockwave
shoot_flame:custom:nukeLaunch_wave, custom:nukeLaunch_light
#custom:nukeLaunch_smoke*6

limitingMinRange: 260

[projectile_nukeProjectile]
#nuke
tags= nuke

directDamage: 123

life: 99999
speed: 0.1
targetSpeed: 15.0
targetSpeedAcceleration:0.02


largeHitEffect: true
ballistic: true
ballistic_delaymove_height: 700
ballistic_height: 1000
frame: 0
shadowFrame:1

drawType:1

targetGround: true
areaDamage: 6500

#hullDamageMultiplier:0 for EMP version
#hullDamageMultiplier: 0

#areaRadiusFromEdge: true
areaHitAirAndLandAtSameTime: true
alwaysVisibleInFog: true

areaRadius: 300

areaExpandTime:75

deflectionPower:-1


shouldRevealFog:true
nukeWeapon:true

lightColor: #FFEEEE00
lightSize: 1

friendlyFire: true

#trailEffect: true
trailEffect: CUSTOM:projectileTrail
trailEffectRate:4

[effect_projectileTrail]

stripIndex: effects
frameIndex: 0


life: 120
fadeOut: true
attachedToUnit: false
color: #FFFFFF
fadeInTime:5
scaleFrom: 0.5
scaleTo: 3.5
alpha: 0.6
drawUnderUnits:false
#ySpeedRelative:-1
atmospheric:true

dirOffsetRandom:180

shadow:true

xSpeedAbsoluteRandom: 0.2
ySpeedAbsoluteRandom: 0.2


[effect_nukeLaunch_wave]
priority:high

stripIndex:shockwave
life: 50
scaleFrom: 0.5
scaleTo: 2.5

[effect_nukeLaunch_smoke]
priority:high

xOffsetAbsoluteRandom: 10
yOffsetAbsoluteRandom: 10

frameIndex: 0
stripIndex: smoke_black

spawnChance: 0.3

life: 90
fadeOut: true
attachedToUnit: false
#color: #fdc14d
color: #FFEEEE00

fadeInTime:5
scaleFrom: 0.3
scaleTo: 0.8
alpha: 0.9
drawUnderUnits:false
liveAfterAttachedDies: false
hSpeed:0.4
xSpeedAbsoluteRandom:0.9
ySpeedAbsoluteRandom:0.9
dirOffsetRandom:180
atmospheric: true


[effect_nukeLaunch_light]
image: SHARED:light_50.png
life: 40
fadeOut: true
attachedToUnit: true
color: #FFFFFF
scaleFrom: 1.7
scaleTo: 1.7
alpha: 0.7
drawUnderUnits:false




[graphics]

image:        antinuke.png


image_shadow: NONE
shadowOffsetX:3
shadowOffsetY:3

drawLayer: bottom

showEnergyBar: false


[ai]

ai_upgradePriority: 0.4




