
[core]
name: bugWasp
altNames: 战斗飞虫
displayText: 战斗飞虫
displayDescription: -攻击地面和空中单位
class: CustomUnitMetadata
price: 700
maxHp: 225
mass: 1200

techLevel: 1
buildSpeed: 0.0025
#availableInDemo: true

radius: 9
displayRadius: 11
isBio: true
isBug: true
tags: units, 虫族, 小型虫, 开端辅虫, 固定射击


selfRegenRate:0.06



softCollisionOnAll: 12

builtFrom_1_name: bugNest
builtFrom_1_pos:  3

#test


overrideAndReplace: bugWasp

autoTriggerCooldownTime: 0.1s

[action_Upgrade]
convertTo:bugWaspLarge
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
price:腐蚀=120
text:腐蚀 - 炙火
displayType:upgrade
buildSpeed:12.8s
pos:1
description:-更强大的体格\n-速度加快\n-炽火射线\n-攻击造成灼烧
descriptionAddUnitStats: ${section.convertTo}
iconExtraImage:SHARED:icon_upgrade_top.png
iconExtraColor:#AAFFFFFF
tags=腐蚀
setUnitMemory: 属性[24]=0

[hiddenAction_腐蚀中]
autoTrigger: if self.queueSize(withActionTag="腐蚀")>0 and not self.tags(includes='腐蚀中')
setUnitMemory: 属性[24]=-${movement.moveSpeed}*0.6
alsoTriggerAction: 属性变化
temporarilyAddTags: 腐蚀中

[hiddenAction_腐蚀停止]
autoTrigger: if self.queueSize(withActionTag="腐蚀")<1 and self.tags(includes='腐蚀中')
setUnitMemory: 属性[24]=0
alsoTriggerAction: 属性变化
temporarilyRemoveTags: 腐蚀中

[hiddenAction_自动腐蚀]
autoTrigger: if (self.hasUnitInTeam(withTag="腐蚀-火烧云") and self.hasUnitInTeam(withTag="腐蚀之意")) and self.hasResources(${action_Upgrade.price}) and self.queueSize(empty=true) and not self.isAttacking
alsoQueueAction: Upgrade
addResourcesWithLogic: ${action_Upgrade.price}*-1

[graphics]
total_frames: 2

image:        bug_wasp.png
image_wreak:  NONE
image_turret: NONE
#scaleImagesTo: 20
#scaleTurretImagesTo: 9

#AUTO
image_shadow: AUTO_ANIMATED
shadowOffsetX:1
shadowOffsetY:1



animation_moving_start: 0
animation_moving_end: 1
animation_moving_speed: 2

animation_idle_start: 0
animation_idle_end: 1
animation_idle_speed: 2

lock_body_rotation_with_main_turret: true

[attack]


canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits:   true
canAttackUnderwaterUnits: false

isFixedFiring: true

turretSize: 10
turretTurnSpeed: 9

maxAttackRange: 140
shootDelay: 55


[turret_1]
x: 0
y: 0

recoilOffset: -5
recoilOutTime: 13
recoilReturnTime: 13

#shoot_light:#FF00CC00
shoot_flame: smoke


[projectile_1]
tags= T-projectile
directDamage: 32
life: 80
speed: 7
#frame: 0

color: #00ff00
drawSize: 2

lightColor: #00ff00
lightSize: 0.3

explodeEffect: CUSTOM:explodeSmall

[effect_explodeSmall]
life: 25
fadeOut: false
attachedToUnit: false
image: explode_big2.png
scaleFrom: 0.5
scaleTo: 0.5
total_frames: 14
animateFrameStart: 0
animateFrameEnd: 13
animateFrameSpeed: 0.6

[movement]
movementType: AIR
moveSpeed: 1.9
moveAccelerationSpeed: 0.04
moveDecelerationSpeed: 0.07


maxTurnSpeed: 5.5
turnAcceleration: 0.5

moveSlidingMode :true
moveIgnoringBody:true
moveSlidingDir:  181



reverseSpeedPercentage:0

[hiddenAction_AIInitialCombat]
autoTrigger: if self.globalTeamTags(includes='AI系统') and not numberOfUnitsInTeam(withTag='战斗虫初队', greaterThan=1) and not self.globalTeamTags(includes='开端{I}')
temporarilyAddTags: 战斗虫初队

[hiddenAction_AIInitialattack]
addWaypoint_type: attack
addWaypoint_prepend: true
addWaypoint_maxTime: 5s
addWaypoint_target_nearestUnit_tagged: 蚊子
addWaypoint_target_nearestUnit_team: enemy
addWaypoint_target_mapMustBeReachable: false
autoTrigger: if self.globalTeamTags(includes='AI系统') and not self.globalTeamTags(includes='AI屯兵') and not self.isAttacking and not self.hasActiveWaypoint(type='attack') and not self.globalTeamTags(includes='战隙{I}') and self.tags(includes='战斗虫初队')

[hiddenAction_AIattackMoveMiddle]
autoTrigger: if self.globalTeamTags(includes='AI系统') and not self.globalTeamTags(includes='AI屯兵') and not self.isAttacking and not self.hasActiveWaypoint(type='attack') and not self.globalTeamTags(includes='开端{I}') and self.tags(includes='战斗虫初队')
addWaypoint_type: attackMove
addWaypoint_prepend: true
addWaypoint_target_mapMustBeReachable: false
addWaypoint_target_nearestUnit_tagged: 中点定位
addWaypoint_target_nearestUnit_team: any

[hiddenAction_AI屯兵集结]
clearAllWaypoints: true
addWaypoint_type: guard
addWaypoint_prepend: true
addWaypoint_maxTime: 8s
addWaypoint_target_nearestUnit_tagged: 资源提取器
addWaypoint_target_nearestUnit_team: own
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.globalTeamTags(includes='AI屯兵') and not self.isAttacking and not self.hasActiveWaypoint(type='guard') and numberOfUnitsInTeam(withTag='资源提取器', greaterThan=0, withinRange=650) and numberOfUnitsInEnemyTeam(withTag='units', lessThan=2, withinRange=420)

[hiddenAction_AI屯兵基地集结]
clearAllWaypoints: true
addWaypoint_type: guard
addWaypoint_prepend: true
addWaypoint_maxTime: 8s
addWaypoint_target_nearestUnit_tagged: 基地
addWaypoint_target_nearestUnit_team: own
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.globalTeamTags(includes='AI屯兵') and not self.isAttacking and not self.hasActiveWaypoint(type='guard') and (numberOfUnitsInTeam(withTag='资源提取器', lessThan=1, withinRange=650) or numberOfUnitsInEnemyTeam(withTag='units', greaterThan=1, withinRange=420))

[hiddenAction_AI爆发突击]
clearAllWaypoints: true
addWaypoint_type: attackMove
addWaypoint_prepend: true
addWaypoint_maxTime: 15s
addWaypoint_target_nearestUnit_tagged: 基地
addWaypoint_target_nearestUnit_team: enemy
addWaypoint_target_mapMustBeReachable: true
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.globalTeamTags(includes='AI爆发') and not self.globalTeamTags(includes='AI屯兵') and not self.isAttacking and not self.hasActiveWaypoint(type='attackMove')

[hiddenAction_AI集群进攻]
addWaypoint_type: guard
addWaypoint_prepend: true
addWaypoint_maxTime: 20s
addWaypoint_target_nearestUnit_tagged: 群虫成体
addWaypoint_target_nearestUnit_team: own
autoTrigger: if self.globalTeamTags(includes='AI系统') and not self.globalTeamTags(includes='AI屯兵') and not self.hasActiveWaypoint(type='guard') and self.globalTeamTags(includes='开端{I}') and not numberOfUnitsInEnemyTeam(withinRange=500, greaterThan=0, withTag='布克布克')

[hiddenAction_AI遭遇布克]
addWaypoint_type: attack
addWaypoint_prepend: true
addWaypoint_maxTime: 20s
addWaypoint_target_nearestUnit_tagged: 布克布克
addWaypoint_target_nearestUnit_team: enemy
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.globalTeamTags(includes='开端{I}') and numberOfUnitsInEnemyTeam(withinRange=500, greaterThan=0, withTag='布克布克')

[hiddenAction_AI走位]
addWaypoint_type: move
addWaypoint_prepend: true
addWaypoint_maxTime: 3s
addWaypoint_target_mapMustBeReachable: true
addWaypoint_target_fromReference: attachment.getOffsetRelative(y=-80)
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.isAttacking and numberOfUnitsInEnemyTeam(greaterThan=0, withinRange=${attack.maxAttackRange -5}, withTag='units') and attachment.isAttacking and (not self.hasActiveWaypoint(type='move') or distanceBetween(self, activeWaypointTarget) < 20)
[hiddenAction_AIclearWaypoints]
clearAllWaypoints: true
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.isAttacking and not numberOfUnitsInEnemyTeam(greaterThan=0, withinRange=${attack.maxAttackRange +1}, withTag='units') and self.hasActiveWaypoint(type='move')

[attachment_AI向定位]
x: 0
y: 0
onCreateSpawnUnitOf: AI单位向定位
alwaysAllowedToAttackParentsMainTarget: true
