
[core]
name: 腐败的黑寡妇
displayDescription:-腐蚀过度?… \n-仅攻击地面 \n-小范围伤害 \n-将所受到的60%伤害转化为毒素 \n-毒素附加: 55
class: CustomUnitMetadata
price: 1300, 腐蚀=${corrode}
maxHp: 660
mass: 5000

techLevel: 2
buildSpeed: 0.0015
#availableInDemo: true

radius: 14
displayRadius: 19
isBio: true
isBug: true
tags: units, 虫族, 中型虫, 黑寡妇, 蜘蛛, 固定射击

softCollisionOnAll: 12

unitsSpawnedOnDeath: 资源返还(addResources=ammo:325|energy:62)

[hiddenAction_亡灵生成]
autoTriggerOnEvent: destroyed
requireConditional: if self.globalTeamTags(includes='狂猎') and self.globalTeamTags(includes='皎红')
spawnUnits: 腐败的黑寡妇[亡灵]

[hiddenAction_腐蚀价格]
@global corrode: 250
autoTrigger: if memory.腐蚀价格!=${corrode}
setUnitMemory: 腐蚀价格=${corrode}

[action_狂猎击杀]
@copyFromSection: template_狂猎击杀

[action_狂猎击杀2]
@copyFromSection: template_狂猎击杀2


[hiddenAction_腐败]
autoTrigger: true
addResources: hp=-0.6


[hiddenAction_血量记录]
autoTrigger: if self.resource.受击前血量!=self.hp
setResourcesWithLogic: 受击前血量=self.hp

[hiddenAction_血量减伤]
autoTriggerOnEvent: tookDamage
requireConditional: if self.resource.受击前血量>self.hp
setResourcesWithLogic: 毒素=self.resource.毒素+(self.resource.受击前血量-self.hp) * 0.6, hp=self.hp+(self.resource.受击前血量-self.hp) * 0.6, 受击前血量=self.hp
spawnUnits: 有毒的雾(setToTeamOfLastAttacker=true)

[hiddenAction_受伤记录]
autoTriggerOnEvent: tookDamage
setResourcesWithLogic: 受击前血量=self.hp

[resource_受击前血量]
hidden: true


[hiddenAction_女皇强化]
autoTrigger: if numberOfUnitsInTeam(withTag='zz王', withinRange=400)>0 and not self.tags(includes='女皇强化')
setUnitMemory: 属性[20]=50
alsoTriggerAction: 属性变化
temporarilyAddTags: 女皇强化

[hiddenAction_女皇强化结束]
autoTrigger: if numberOfUnitsInTeam(withTag='zz王', withinRange=400)<1 and self.tags(includes='女皇强化')
setUnitMemory: 属性[20]=0
alsoTriggerAction: 属性变化
temporarilyRemoveTags: 女皇强化

[graphics]
total_frames: 1

image: 黑寡妇.png
image_wreak: NONE
image_turret: NONE

#AUTO
image_shadow:AUTO
shadowOffsetX:2
shadowOffsetY:2

lock_body_rotation_with_main_turret:true

animation_moving_start:0
animation_moving_end:0
animation_moving_speed:3

animation_idle_start:0
animation_idle_end:0
animation_idle_speed:80
animation_idle_scale_start:1
animation_idle_scale_end:1.03
animation_idle_pingPong:true

animation_attack_start:0
animation_attack_end:0
animation_attack_speed:15
animation_attack_scale_start:1
animation_attack_scale_end:0.97
animation_attack_pingPong:true

[attack]
canAttack: true
canAttackFlyingUnits: false
canAttackLandUnits: true
canAttackUnderwaterUnits: false

isFixedFiring: true

turretSize: 20
turretTurnSpeed: 9

maxAttackRange: 210
shootDelay: 25

[turret_1]
x:0
y:0

shoot_light:#FF00CCCC

recoilOffset:-3
recoilOutTime:6
recoilReturnTime:18

[turret_2]
x: 0
y: 0
invisible:true
attachedTo: 1
slave: true

[projectile_1]
tags= T-projectile
areaDamage: 10
areaRadius: 15
areaRadiusFromEdge: true

shieldDamageMultiplier: 0.9
shieldDefectionMultiplier: 0.9

largeHitEffect: true
life: 80
speed: 5
speedSpread: 1
targetSpeed: 8
#frame: 0
frame: 6

lightColor:#00ff00
lightSize:0.6

trailEffect: CUSTOM:尾气雾

explodeEffect: CUSTOM:explode, CUSTOM:shockwave

spawnUnit: 有毒的雾
mutatorX_ifUnitWithoutTags: 毒免疫, 效果免疫, 不会受伤
mutatorX_addResourcesAreaHit: 毒素=55

[resource_毒素]
displayName: 毒素

[effect_尾气雾]
stripIndex: effects
frameIndex: 0
priority: veryhigh

life: 20
fadeOut: true
attachedToUnit: false
color: #FF3BFF00
hSpeed: 0.3
scaleFrom: 0.7
scaleTo: 0.1
alpha: 0.6
drawUnderUnits: false
yOffsetRelative: -1
xOffsetRelativeRandom: 2
xSpeedRelativeRandom: 0.1
atmospheric: true


[effect_explode]
life: 25
fadeOut: false
attachedToUnit: false
image: explode_big2.png
scaleFrom: 1
scaleTo: 1
alpha: 0.9
total_frames: 14
animateFrameStart: 0
animateFrameEnd: 13
animateFrameSpeed: 0.5
alsoPlaySound: missile_hit:0.5

[effect_shockwave]
stripIndex: shockwave_large
life: 25
scaleFrom: 0
scaleTo: 0.75
alpha: 1
color: #B1FF99


[leg_1]
x:-18
y:0
attach_x:0
attach_y:0
moveSpeed:4.1
resetAngle:20

heightSpeed:0.8

image_leg:leg.png
image_foot:NONE

drawLegWhenZoomedOut:true

dust_effect:false

holdDisMin:15
holdDisMax:24

[leg_2]
x:18
y:0
attach_x:0
attach_y:0
copyFrom:1

[leg_3]
x:-15
y:13
attach_x:0
attach_y:2
copyFrom:1

[leg_4]
x:15
y:13
attach_x:0
attach_y:2
copyFrom:1

[leg_5]
x:-15
y:-13
attach_x:0
attach_y:-2
copyFrom:1

[leg_6]
x:15
y:-13
attach_x:0
attach_y:-2
copyFrom:1

[movement]
movementType: OVER_CLIFF
moveSpeed: 0.9

moveAccelerationSpeed:0.04
moveDecelerationSpeed:0.12


maxTurnSpeed:2.6
turnAcceleration:0.5

targetHeight: 0
targetHeightDrift: 0

moveSlidingMode:true
moveIgnoringBody:true
moveSlidingDir:181

[hiddenAction_AI走位]
addWaypoint_type: move
addWaypoint_prepend: true
addWaypoint_maxTime: 3s
addWaypoint_target_mapMustBeReachable: true
addWaypoint_target_fromReference: attachment.getOffsetRelative(y=-80)
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.isAttacking and numberOfUnitsInEnemyTeam(greaterThan=0, withinRange=${attack.maxAttackRange -5}, withTag='units') and attachment.isAttacking and (not self.hasActiveWaypoint(type='move') or distanceBetween(self, activeWaypointTarget) < 20)
[hiddenAction_AIclearWaypoints]
clearAllWaypoints: true
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.isAttacking and not numberOfUnitsInEnemyTeam(greaterThan=0, withinRange=${attack.maxAttackRange +1}, withTag='units') and self.hasActiveWaypoint(type='move')

[attachment_AI向定位]
x: 0
y: 0
onCreateSpawnUnitOf: AI单位向定位
alwaysAllowedToAttackParentsMainTarget: true