
[core]
name: 双邪虫族出场
tags: 虫族出场
price: 0
maxHp: 800
mass: 0
radius: 18
isBuilding: true

#隐藏单位本身
showInEditor: false
fogOfWarSightRange: 10
ignoreInUnitCapCalculation: true
disableAllUnitCollisions: true
isUnselectable:	true
canNotBeDamaged: true
canOnlyBeAttackedByUnitsWithTags: 不可被攻击

#禁止死亡痕迹
numBitsOnDeath:	0
explodeOnDeath:	false
hideScorchMark: true

showOnMinimap: true

autoTriggerCooldownTime: 0.01s
autoTriggerCooldownTime_allowDangerousHighCPU:true

canBuild_1_name: setRally

[canBuild_builder]
name: bugSpore
pos: 2
isVisible: if not self.globalTeamTags(includes='AI系统') or not self.globalTeamTags(includes='战隙{I}')
isLocked: if self.globalTeamTags(includes='战隙{I}') and self.globalTeamTags(includes='AI系统')
isLockedMessage: AI:进入前期阶段,低级单位已停止建造

[canBuild_3]
name: bugMelee
pos: 3
isVisible: if not self.globalTeamTags(includes='AI系统') or not self.tags(includes='一号地巢')
isLocked: if self.globalTeamTags(includes='战隙{I}') and self.globalTeamTags(includes='AI系统')
isLockedMessage: AI:进入前期阶段,低级单位已停止建造

[canBuild_T1]
name: bugRanged, 炮弹虫, 冲射虫
pos: 3.1
isLocked: if self.globalTeamTags(includes='战隙{I}') and self.globalTeamTags(includes='AI系统')
isLockedMessage: AI:进入前期阶段,低级单位已停止建造

[canBuild_3.3]
name: 毒气
pos: 3.3
isLocked: if self.globalTeamTags(includes='中刻{I}') and self.globalTeamTags(includes='AI系统')
isLockedMessage: AI:进入中期阶段,低级单位已停止建造

[action_up1]
text: 进化 - T2
description: -解锁生产T2兵种
price: 2300
buildSpeed: 30s
pos: -2
iconImage: SHARED:icon_upgrade.png
convertTo: 双邪虫巢T2
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
displayType: upgrade
isLocked: if not self.globalTeamTags(includes='开端{I}') and self.globalTeamTags(includes='AI系统')
isLockedMessage: AI:现在不进行进化

[action_双邪普拉克勒斯]
autoTrigger: if not self.globalTeamTags(includes="启")
isVisible: if numberOfUnitsInTeam(withTag='天神草', lessThan=1, incompleteBuildings=true) and not self.globalTeamTags(includes='天神草初唤')
displayType: queueUnit
text: 已选择·衍黎&狂猎
description: -生成普拉克勒斯并选择分支[衍黎&狂猎]
iconExtraImage: 虫巢[狂猎].png
fireTurretXAtGround: 1
fireTurretXAtGround_withProjectile: summon
fireTurretXAtGround_withOffset: 0, 40
addGlobalTeamTags: 衍黎, 狂猎, 启, 双邪虫族
buildSpeed: 0s
pos: 10.1

[canBuild_1]
#避免开局判定失败
name: 礼花
pos: 100
isVisible: if not self.hasFlag(id=3)

[hiddenAction_create]
autoTrigger: if not self.hasFlag(id=1)
addResources: setFlag=1
spawnUnits: 母体(offsetY=500)

[hiddenAction_correct]
autoTrigger: if not self.hasFlag(id=2) and self.timeAlive(laterThanSeconds=2) and self.lastConverted(laterThanSeconds=2)
addResources: setFlag=2

[hiddenAction_receive]
autoTrigger: if self.hasFlag(id=2) and not self.hasFlag(id=3) and not self.hasFlag(id=4)
addResources: setFlag=3
spawnEffects: CUSTOM:影散, CUSTOM:核眼, CUSTOM:projectileLight2, 黑影胞, 消莹胞, 散莹雾
offsetSelfAbsolute:	0, 0, -20
convertTo: 双邪虫族出场[可选中]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}

[hiddenAction_receive2]
@copyFromSection: hiddenAction_receive
autoTrigger: if self.hasFlag(id=2) and not self.hasFlag(id=3) and self.hasFlag(id=4)
spawnEffects: CUSTOM:核眼, CUSTOM:projectileLight2

[hiddenAction_rise]
autoTrigger: if self.hasFlag(id=3) and self.height(greaterThan=-15, lessThan=0)
offsetSelfAbsolute:	0, 0, 1

[hiddenAction_appear]
autoTrigger: if self.hasFlag(id=3) and self.isAtGroundHeight
fireTurretXAtGround: explode
fireTurretXAtGround_withProjectile: explode
fireTurretXAtGround_withOffset: 0, 0
spawnEffects: CUSTOM:绿闪光
convertTo: 双邪虫巢
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
produceUnits: bugSpore
alsoQueueAction: 起始建造者+, 起始建造者+

[hiddenAction_起始建造者+]
id: 起始建造者+
buildSpeed: 0s

[graphics]
isVisible: if self.hasFlag(id=3)
image:   ROOT:/-虫族-/建筑虫/建筑_虫巢/虫巢[狂猎].png
image_wreak: NONE
disableLowHpSmoke: true
disableLowHpFire: true
icon_zoomed_out_neverShow: true
showHealthBar: false

[attack]
canAttack: false
maxAttackRange: 10

[turret_1]
x: 0
y: 25
shoot_light: #FF00CCCC

[turret_explode]
x:0
y:0
canShoot:false
projectile:explode

[projectile_explode]
life:99
instant:true
largeHitEffect:true
targetGround:true
areaDamage:0
areaRadius:180
spawnProjectilesOnExplode:explode2*2, 衍黎弹*3
explodeEffect: CUSTOM:shockwavebig

[projectile_explode2]
life:99
speed: 2
targetSpeed: 5
targetSpeedAcceleration: 0.07
initialUnguidedSpeedY: -0.5

explodeOnEndOfLife:true
targetGround:true
targetGroundSpread:150
areaDamage:0
areaRadius:60
frame:6
drawSize:1.5
deflectionPower: -1

initialUnguidedSpeedHeight: 1.2
gravity:0.18

lightSize: 0.6
lightColor: #FF3BFF00
explodeEffect: CUSTOM:explodeSmall, CUSTOM:shockwave, CUSTOM:shockwave2, CUSTOM:绿光, CUSTOM:绿闪光

[projectile_衍黎弹]
@copyFromSection: projectile_explode2
targetGroundSpread: 250
spawnUnit: 虫塔(gridAlign=true, addResources=野性:1)

[resource_野性]
displayName: 野性


[projectile_summon]
life: 60
instant: true
areaDamage: 0
spawnUnit: 天神草(alwayStartDirAtZero=true), 碎星核(alwayStartDirAtZero=true, falling=true, offsetHeight=300)
explodeEffect: CUSTOM:毒雾3*4

[projectile_天神草衍黎]
@copyFromSection: projectile_summon
spawnUnit: 天神草(alwayStartDirAtZero=true, addResources=setFlag:1)

[projectile_天神草狂猎]
@copyFromSection: projectile_summon
spawnUnit: 天神草(alwayStartDirAtZero=true, addResources=setFlag:2)

[effect_毒雾3]
stripIndex: effects
frameIndex: 0
priority:low

life: 200
fadeOut: true
attachedToUnit: false
color: #AEFF00
fadeInTime:5
hSpeed: 0.8
scaleFrom: 1.0
scaleTo: 2.5
alpha: 0.4
drawUnderUnits:false
#yOffsetRelative:-7
xSpeedRelativeRandom:0.2
ySpeedRelativeRandom:0.2

shadow: true
atmospheric: true
[effect_explodeSmall]
life: 25
image: explode_big2.png
scaleFrom: 0.9
scaleTo: 0.9
alpha: 0.8
total_frames: 14
animateFrameStart: 0
animateFrameEnd: 13
animateFrameSpeed: 0.5
fadeOut: false


[effect_shockwave]
stripIndex: shockwave
life: 25
scaleFrom: 0
scaleTo: 1
alpha: 0.8
dirSpeed: 5
drawUnderUnits: true

[effect_shockwave2]
@copyFromSection: effect_shockwave
life: 30
scaleTo: 1.3
color: #FF3BFF00
dirSpeed: -5

[effect_shockwavebig]
@copyFromSection: effect_shockwave
life: 20
scaleTo: 1.8
dirSpeed: 0

[effect_绿光]
image: SHARED:light_50.png
life: 40
fadeOut: true
color: #3BFF00
scaleFrom: 1.2
scaleTo: 0.6
alpha: 0.6
drawUnderUnits: true

[effect_绿闪光]
@copyFromSection: effect_绿光
life: 20
scaleFrom: 1.7
scaleTo: 1.3

[movement]
movementType: NONE
moveSpeed: 0
moveAccelerationSpeed: 0
moveDecelerationSpeed: 0
heightChangeRate: 20

[effect_影散]
attachedToUnit: true
createWhenOffscreen: true
priority: critical
image: 别西卜模糊伸影.png
life: 30
scaleFrom: 6.5
scaleTo: 10
alpha: 0.6
total_frames: 2
animateFrameStart: 0
animateFrameEnd: 1
animateFrameSpeed: 0.5
animateFrameLooping: true
ySpeedRelative: 3

[effect_黑影胞]
attachedToUnit: true
createWhenOffscreen: true
priority: critical
image: 模糊神经元胞B.png
life: 40
fadeInTime: 2
scaleFrom: 1
scaleTo: 0.1
alpha: 1
color: #000000
dirOffsetRandom: 180
dirSpeed: 16
trailEffect: 随影胞
trailEffectRate: 2

[effect_随影胞]
attachedToUnit: false
createWhenOffscreen: true
priority: critical
image: 模糊神经元胞B.png
life: 15
lifeRandom: 5
fadeInTime: 2
scaleFrom: 0.6
scaleTo: 0.1
alpha: 0.4
color: #3BFF00
ySpeedRelative: 3
yOffsetRelativeRandom: 1
drawUnderUnits: true

[effect_消莹胞]
createWhenOffscreen: true
priority: critical
image: 模糊神经元胞B.png
life: 150
fadeInTime: 5
scaleFrom: 0.6
scaleTo: 0.7
alpha: 0.2
color: #3BFF00
delayedStartTimer: 35
drawUnderUnits: true

[effect_散莹雾]
attachedToUnit: true
createWhenOffscreen: true
priority: critical
image: fog.png
life: 50
fadeInTime: 5
scaleFrom: 0.6
scaleTo: 2
alpha: 0.5
color: #3BFF00
dirOffsetRandom: 180
delayedStartTimer: 35


[effect_核眼]
attachedToUnit: true
createWhenOffscreen: true
priority: critical
image: 核心.png
life: 60
scaleFrom: 2
scaleTo: 3.5
alpha: 1

[effect_projectileLight]
#未使用
priority:veryhigh
image: SHARED:light_50.png
life: 200
fadeOut: true
attachedToUnit: true
color: #FF3BFF00
fadeInTime:20
scaleFrom: 2.4
scaleTo: 2.4
alpha: 1
drawUnderUnits: true
liveAfterAttachedDies: false

[effect_projectileLight2]
@copyFromSection: effect_projectileLight
life: 60
fadeInTime: 15
scaleFrom: 2.4
scaleTo: 1.2
alpha: 2
drawUnderUnits: false