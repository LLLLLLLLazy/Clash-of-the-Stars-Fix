
[core]
name: bugBee
altNames: 自爆飞虫
displayText: 自爆飞虫
displayDescription: -攻击地面与空中 \n -冲向目标并自爆 \n -死亡后爆炸
class: CustomUnitMetadata
price: 600
maxHp: 110
mass: 500

techLevel: 1
buildSpeed: 0.004
#availableInDemo: true

radius: 8
displayRadius: 10
isBio: true
isBug: true
tags: units, 虫族, 小型虫, 自爆虫, 自爆飞虫, 开端辅虫, 近战飞行, 固定射击

explodeTypeOnDeath: large

selfRegenRate:0.06

softCollisionOnAll: 12

builtFrom_1_name: bugNest
builtFrom_1_pos:  4


overrideAndReplace: bugBee

autoTriggerCooldownTime: 0.01s
autoTriggerCooldownTime_allowDangerousHighCPU: true

[action_explode]
displayType: action

price:  0
text: 自爆
buildSpeed: 0.8s
addResources: setFlag=1
allowMultipleInQueue: false

[hiddenAction_自爆]
autoTrigger: if self.hasFlag(id=1)
addResourcesWithLogic: hp=-250 * (1+memory.属性[27])
fireTurretXAtGround: 2
fireTurretXAtGround_withOffset: 0, 0

[hiddenAction_死亡自爆]
autoTriggerOnEvent: destroyed
requireConditional: if not self.hasFlag(id=1) and self.hp<=0
fireTurretXAtGround: 2
fireTurretXAtGround_withOffset: 0, 0


[hiddenAction_无延迟追击]
@copyFromSection: template_无延迟追击
[hiddenAction_无延迟追击2]
@copyFromSection: template_无延迟追击2

[hiddenAction_攻击修正]
autoTrigger: if activeWaypointTarget==nullUnit and self.hasActiveWaypoint(type="attack")
clearActiveWaypoint: true


[hiddenAction_召唤物单位]
autoTriggerOnEvent: created
requireConditional: if self.hasFlag(id=0)
temporarilyAddTags: 召唤物


[action_扩散移动点开]
@copyFromSection: template_扩散移动点开

[action_扩散移动点关]
@copyFromSection: template_扩散移动点关

[hiddenAction_设置扩散移动点]
@copyFromSection: template_设置扩散移动点

[hiddenAction_清除当前非巡逻路径]
@copyFromSection: template_清除当前非巡逻路径

[hiddenAction_锁定扩散移动点]
@copyFromSection: template_锁定扩散移动点

[hiddenAction_执行扩散移动点]
@copyFromSection: template_执行扩散移动点

[graphics]

total_frames: 2
image:        bug_bee.png
image_wreak:  NONE
image_turret: NONE
#scaleImagesTo: 20
#scaleTurretImagesTo: 9

#AUTO
image_shadow: AUTO_ANIMATED
shadowOffsetX:1
shadowOffsetY:1


animation_moving_start: 0
animation_moving_end: 1
animation_moving_speed: 2

animation_idle_start: 0
animation_idle_end: 1
animation_idle_speed: 2


[attack]

isMelee: true
meleeEngangementDistance: 150

canAttack: true
canAttackFlyingUnits: if self.queueSize(withActionTag="黯回之生", lessThan=1)
canAttackLandUnits:   if self.queueSize(withActionTag="黯回之生", lessThan=1)
canAttackUnderwaterUnits: false

isFixedFiring: true

turretSize: 0
turretTurnSpeed: 3

maxAttackRange: 1
shootDelay: 0

[turret_1]
x:0
y:0
invisible:true
projectile:1
canAttackCondition: if not self.hasFlag(id=1) and (attacking == activeWaypointTarget or not self.hasActiveWaypoint(type='attack') and not self.hasActiveWaypoint(type='move'))
resourceUsage: setFlag=1

[projectile_1]
tags= T-projectile
areaDamage:0
areaRadius:0
life:50
instant:true
explodeEffect:NONE
explodeEffectOnShield:NONE

[turret_2]
x:0
y:0
warmup:30
invisible:true
projectile:explodeArea
canAttackCondition: if attacking == activeWaypointTarget or not self.hasActiveWaypoint(type='attack') and not self.hasActiveWaypoint(type='move')

[projectile_explodeArea]
tags= T-projectile
areaDamage: 240
areaRadius: 60
areaRadiusFromEdge: true

life: 50
instant: true

targetGround:true
areaHitAirAndLandAtSameTime: true

[movement]
movementType: AIR
moveSpeed: 1.8
moveAccelerationSpeed: 0.07
moveDecelerationSpeed: 0.12

targetHeight: 13
targetHeightDrift: 3

maxTurnSpeed: 6.5
turnAcceleration: 0.4

moveSlidingMode :true
moveIgnoringBody:true
moveSlidingDir:  181

[hiddenAction_AIGather]
addWaypoint_type: guard
addWaypoint_prepend: true
addWaypoint_maxTime: 5s
addWaypoint_target_nearestUnit_tagged: 基地
addWaypoint_target_nearestUnit_team: own
autoTrigger: if self.globalTeamTags(includes='AI系统') and not self.hasActiveWaypoint(type='guard') and numberOfUnitsInEnemyTeam(withTag='地震塔T2', greaterThan=0) and (not self.globalTeamTags(includes='开端计攻2') or not self.globalTeamTags(includes='开端{I}'))

[hiddenAction_AI集群进攻]
addWaypoint_type: guard
addWaypoint_prepend: true
addWaypoint_maxTime: 20s
addWaypoint_target_nearestUnit_tagged: 群虫成体
addWaypoint_target_nearestUnit_team: own
autoTrigger: if self.globalTeamTags(includes='AI系统') and not self.hasActiveWaypoint(type='guard') and self.globalTeamTags(includes='开端{I}')

[hiddenAction_AI指定攻击]
addWaypoint_type: attack
addWaypoint_prepend: true
addWaypoint_maxTime: 20s
addWaypoint_target_nearestUnit_tagged: 地震塔T2, 地震塔, T3机枪, 火炮塔, 毒气兵, 布克布克
addWaypoint_target_nearestUnit_team: enemy
addWaypoint_target_nearestUnit_maxRange: 500
autoTrigger: if self.globalTeamTags(includes='AI系统') and self.globalTeamTags(includes='开端{I}')
