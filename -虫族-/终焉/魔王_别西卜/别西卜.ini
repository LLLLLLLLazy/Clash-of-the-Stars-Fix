
[core]
name: 别西卜

displayText: 别西卜
displayDescription: [至高神性] \n 天穹之主 地狱之王 \n 赶鬼祛病 威慑神庭 \n 万物腐败 亦为新生 \n -至此 开启新的篇章
class: CustomUnitMetadata
price: 600000, 腐蚀=${corrode}
maxHp: 40000
mass: 400000

tags: units, 别西卜, 虚无

fogOfWarSightRange: 66

techLevel: 2
buildSpeed: 600s
selfBuildRate: 1

experimental: true

radius: 69
#displayRadius: 11
#isBio: true
isBug:true
#softCollisionOnAll: 3
softCollisionOnAll: 13

selfRegenRate:2

transportSlotsNeeded: 50

unitsSpawnedOnDeath: 魔王之心
soundOnDeath: Darkness5.ogg

numBitsOnDeath:	0
explodeOnDeath:	false
explodeOnDeathGroundCollision: false
hideScorchMark: true

[hiddenAction_腐蚀价格]
@global corrode: 60000
autoTrigger: if memory.腐蚀价格!=${corrode}
setUnitMemory: 腐蚀价格=${corrode}

[hiddenAction_create]
autoTrigger: if not self.hasFlag(id=1) and not self.hasFlag(id=2)
spawnUnits: 通往天堂(alwayStartDirAtZero=true, offsetRandomDir=30)
deleteSelf:true

[hiddenAction_create2]
autoTrigger: if self.hasFlag(id=2)
addResources: setFlag=1, hp=-39999, unsetFlag=2
takeResources: setFlag=1
takeResources_includeUnitsWithinRange: 1000
takeResources_includeUnitsWithinRange_team: own
takeResources_excludeUnitsWithoutTags: 混沌蝇
takeResources_maxUnits: 400

[hiddenAction_面纱]
autoTrigger: true
spawnEffects:CUSTOM:面纱*3, 面纱远, 面纱元纹, 面纱云

[hiddenAction_毒雾赋予]
autoTrigger: if numberOfUnitsInEnemyTeam(withTag='units', withinRange=900)>0
takeResources_includeUnitsWithinRange: 900
takeResources_includeUnitsWithinRange_team: enemy
takeResources_excludeUnitsWithoutTags: units
takeResources_triggerActionForEach: 毒雾生成
takeResources_searchOnly: true
takeResources_maxUnits: 999
fireTurretXAtGround: 1
fireTurretXAtGround_withOffset: 0, 0
fireTurretXAtGround_withProjectile: 万物腐败

[hiddenAction_毒雾生成]
requireConditional: if thisActionTarget.numberOfUnitsInEnemyTeam(withTag='毒素', withinRange=20)<1
fireTurretXAtGround: 1
fireTurretXAtGround_withProjectile: 毒雾生成
fireTurretXAtGround_withTarget: thisActionTarget

[effect_面纱]
priority: critical

life: 400
fadeOut: true
#attachedToUnit: false
image: 模糊闪雾.png
color: #AEFF00
fadeInTime: 20
scaleFrom: 0.5
scaleTo: 0.7
alpha: 0.8
drawUnderUnits:false
#ySpeedRelative:-1
#atmospheric:true

dirOffsetRandom:180

xOffsetRelativeRandom:60
yOffsetRelativeRandom:60

xSpeedAbsoluteRandom: 0.45
ySpeedAbsoluteRandom: 0.45

[effect_面纱远]
@copyFromSection: effect_面纱
priority: veryhigh
life: 500
alpha: 0.4
xSpeedAbsoluteRandom: 1.4
ySpeedAbsoluteRandom: 1.4

[effect_面纱2]
@copyFromSection: effect_面纱
life: 1000
scaleFrom: 1
scaleTo: 3

[effect_面纱元纹]
priority: verylow
life: 260
lifeRandom: 60
fadeInTime: 60
fadeOut: true
image: 模糊神经元胞.png
color: #AEFF00
scaleFrom: 3.6
scaleTo: 4
alpha: 0.1
drawUnderUnits: false

dirOffsetRandom: 180
dirSpeedRandom: 0.1

[effect_面纱云]
@copyFromSection: effect_面纱元纹
life: 600
lifeRandom: 200
fadeInTime: 80
image: 云圈.png
scaleFrom: 1
scaleTo: 4
alpha: 0.2
spawnChance: 0.5


[action_sun]
displayType: action
text: 应许之地
description: -温暖的太阳随你进入希望之乡 \n -那里流淌着奶和蜜
fireTurretXAtGround: 1
fireTurretXAtGround_withOffset: 0,1
fireTurretXAtGround_withProjectile: 太阳

iconImage: 模糊永恒条纹.png
iconExtraImage: Corona.png
addActionCooldownTime: 40s
buildSpeed: 0
pos: 0

[action_gluttony]
displayType: action
text: {暴食}
description: "Wander Away One's time"
fireTurretXAtGround: 1
fireTurretXAtGround_withProjectile: 2
fireTurretXAtGround_onlyOverPassableTileOf: AIR

iconImage: 六边形.png
iconExtraImage: 爪痕.png
addActionCooldownTime: 100s
buildSpeed: 0
pos: 0.1

spawnEffects: CUSTOM:面纱2*8
convertTo: 别西卜[影]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}

[graphics]
total_frames: 2
image:        别西卜.png
image_wreak: NONE
image_turret: NONE
#scaleImagesTo: 20
#scaleTurretImagesTo: 9

image_shadow: AUTO_ANIMATED
shadowOffsetX:1
shadowOffsetY:1

animation_idle_start: 0
animation_idle_end: 1
animation_idle_speed: 3

animation_moving_start: 0
animation_moving_end: 1
animation_moving_speed: 3

lock_body_rotation_with_main_turret: true

disableLowHpFire: true
disableLowHpSmoke: true

[decal_疫之环]
onlyInPreview: true
layer: onTop
alpha: 0.3
image: Corona.png
@define timer_6s: ((self.timeAlive() % 6) / 6)
imageScale: 0.75 + cos( ${timer_6s} * 360) * 0.1
color: #AEFF00
basePosition: getOffsetRelative(x=0, y=0, dirOffset=-self.timeAlive*1)

[decal_疫之光]
onlyWhileAlive: true
layer: onTop
@define timer_6s: ((self.timeAlive() % 6) / 6)
alpha: 0.2+cos( ${timer_6s} * 360) * 0.1
image: 绿光.png
imageScale: 6

[attack]
turretRotateWithBody: false

canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits:   true
canAttackUnderwaterUnits: false

turretSize: 10
turretTurnSpeed: 1
maxAttackRange: 500
shootDelay: 25

#isFixedFiring: true

[turret_1]
#head
invisible: true
canShoot: false
x: 0
y: 0
idleDir:0
limitingRange: ${core.fogOfWarSightRange * 20 - 40}

[turret_2]
#laser
invisible: false
attachedTo: 1
x: 0
y: 70

projectile: 瘟疫
size: 1

delay: 25
recoilOffset: -2

turnSpeed: 0.8
turnSpeedAcceleration: 1

[turret_3]
@copyFromSection: turret_2
projectile: 瘟疫束

[projectile_瘟疫]
tags= T-projectile
life: 500
speed: 10

areaDamage:0
areaRadius:0

image: null.png

deflectionPower: -1

trailEffect:CUSTOM:瘟疫
trailEffectRate:1

explodeEffect: CUSTOM:瘟疫*3
explodeEffectOnShield: CUSTOM:瘟疫*3

spawnUnit: 别西卜瘟疫, 瘟疫散布, 瘟疫散布2(offsetDir=90), 瘟疫散布2(offsetDir=-90)

[projectile_瘟疫束]
directDamage: 0
life: 60
instant: true
instantReuseLast: true
instantReuseLast_alsoChangeTurretAim: true
moveWithParent: true

beamImage:      StreakFire.png
beamImageEnd:  小点疫雾.png
beamImageOffsetRate: 7

explodeEffect: NONE
explodeEffectOnShield: NONE

sweepOffsetFromTargetRadius: 0.4
sweepSpeed: 10

color: #80AEFF00

spawnProjectilesOnEndOfLife: 瘟疫束_2(recursionLimit=9)

[projectile_瘟疫束_2]
@copyFromSection: projectile_瘟疫束
life: 6
beamImage:      StreakFire_2.png
spawnProjectilesOnEndOfLife: 瘟疫束_3(recursionLimit=9)

[projectile_瘟疫束_3]
@copyFromSection: projectile_瘟疫束_2
beamImage:      StreakFire_3.png
spawnProjectilesOnEndOfLife: 瘟疫束_4(recursionLimit=9)

[projectile_瘟疫束_4]
@copyFromSection: projectile_瘟疫束_2
beamImage:      StreakFire_4.png
spawnProjectilesOnEndOfLife: 瘟疫束_5(recursionLimit=9)

[projectile_瘟疫束_5]
@copyFromSection: projectile_瘟疫束_2
beamImage:      StreakFire_5.png
spawnProjectilesOnEndOfLife: 瘟疫束_6(recursionLimit=9)

[projectile_瘟疫束_6]
@copyFromSection: projectile_瘟疫束_2
beamImage:      StreakFire_6.png
spawnProjectilesOnEndOfLife: NONE


[projectile_万物腐败]
areaDamage: 0
areaRadius: 900
areaHitAirAndLandAtSameTime: true
areaHitUnderwaterAlways: true
life: 0
speed: 0
invisible: true
explodeOnEndOfLife: true
explodeEffect: NONE
explodeEffectOnShield: NONE

mutatorX_ifUnitWithoutTags: 毒免疫, 效果免疫, 不会受伤
mutatorX_addResourcesAreaHit: 毒素=5000

[resource_毒素]
displayName: 毒素

[projectile_毒雾生成]
directDamage: 0
invisible: true
instant: true
life: 5
spawnUnit: 有毒的雾
explodeEffect: NONE
explodeEffectOnShield: NONE


[projectile_太阳]
tags= T-projectile
areaDamage:5000
areaRadius:900
areaDamageNoFalloff:true
targetGround: true
areaHitAirAndLandAtSameTime: true
areaHitUnderwaterAlways: true
shieldDefectionMultiplier: 0
shieldDamageMultiplier: 0
life:120
speed:0
deflectionPower: -1
explodeOnEndOfLife:true
effectOnCreate:CUSTOM:刻, 刻2, 刻3, 刻4
explodeEffect:CUSTOM:光*2, 光2*2, 天堂曲光
spawnProjectilesOnExplode:太阳2

[projectile_太阳2]
tags= T-projectile
areaDamage:5000
areaRadius:1200
#areaDamageNoFalloff:true
targetGround: true
areaHitAirAndLandAtSameTime: true
areaHitUnderwaterAlways: true
shieldDefectionMultiplier: 0
shieldDamageMultiplier: 0
life:0
explodeOnEndOfLife:true
explodeEffect:NONE


[projectile_2]
tags= T-projectile
life: 10
instant: true
invisible: true
areaDamage: 0
spawnUnit: 六边封锁(alwayStartDirAtZero=true)
explodeEffect: NONE


[effect_瘟疫]
life: 200
fadeOut: true
attachedToUnit: false
image: 模糊闪雾.png
color: #AEFF00
fadeInTime: 2
scaleFrom: 0.15
scaleTo: 0.25
alpha: 0.8
drawUnderUnits:false

dirOffsetRandom:180

xSpeedAbsoluteRandom: 0.3
ySpeedAbsoluteRandom: 0.3


[effect_光]
priority: critical
image: SHARED:light_50.png
alsoPlaySound:Fire3.ogg:2.0
life: 200
fadeOut: true
attachedToUnit: false
scaleFrom: 50.0
scaleTo: 50.0
dirOffsetRandom:180
drawUnderUnits:false

[effect_光2]
priority: critical
image: Corona.png
life: 240
fadeOut: true
attachedToUnit: false
scaleFrom: 5
scaleTo: 5.2
alpha: 2
dirOffsetRandom:180
drawUnderUnits:false
alsoEmitEffects: 丝光痕

[effect_丝光痕]
priority: critical
image: Corona.png
life: 1000
fadeOut: true
attachedToUnit: false
scaleFrom: 5
scaleTo: 5.2
alpha: 0.2
dirOffsetRandom:180
drawUnderUnits:false

[effect_刻]
priority: critical
fadeInTime: 5
life: 120
dirSpeed: 2
hSpeed: 0.5
attachedToUnit: true
image: StateDown.png
scaleFrom: 1.0
scaleTo: 1.0
alpha: 0.6
total_frames: 15
animateFrameStart: 0
animateFrameEnd: 14
animateFrameSpeed: 0.1
fadeOut: false
drawUnderUnits:false

[effect_刻2]
@copyFromSection: effect_刻
delayedStartTimer: 3
fadeOut: true

[effect_刻3]
@copyFromSection: effect_刻2
delayedStartTimer: 6

[effect_刻4]
@copyFromSection: effect_刻2
delayedStartTimer: 9

[effect_天堂曲光]
priority: critical
drawType: displacement
image: SHARED:cone_inverted_normal_128.png
life: 200
fadeOut: true
attachedToUnit: false
scaleFrom: 20
scaleTo: 20
alpha: 0.2
dirSpeed: 3
dirOffsetRandom: 180


[arm_1]
x: 33
y: 25
image_end: 右苍蝇腿.png
drawOverBody: false

[arm_2]
x: -33
y: 25
image_end: 左苍蝇腿.png
drawOverBody: false

[movement]
movementType: AIR
moveSpeed: 1.1
moveAccelerationSpeed: 0.01
moveDecelerationSpeed: 0.01
targetHeightDrift: 2
landOnGround: false

reverseSpeedPercentage:0.8


maxTurnSpeed: 2
turnAcceleration: 0.03

moveSlidingMode :true
moveIgnoringBody:true
moveSlidingDir:  181


slowDeathFall: true



