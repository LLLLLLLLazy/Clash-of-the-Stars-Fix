
[core]
copyFrom: ROOT:/-帝国-/建筑_帝国前哨站/技能/黑障_建筑/黑障之护.template
name: 通讯中心
displayText: 通讯中心
class: CustomUnitMetadata
price: 3000
maxHp: 2600
mass: 9000

fogOfWarSightRange: 22
fogOfWarSightRangeWhileNotBuilt: 15

generation_credits: 4
generation_delay: 40

tags: units, 通讯中心

footprint:-2,-1,2,1
constructionFootprint:-2,-1,2,1

displayDescription: -根据支配度解锁各种支援技能 \n -每个远征军前哨站都会提供支配度 \n -也可发射卫星获取支配

techLevel: 1
buildSpeed: 0.0005
#availableInDemo: true

energyMax: 500
energyRegen: 0.0
energyStartingPercentage: 0

radius: 40
isBio: false
isBuilding: true
shieldRenderRadius: 45

softCollisionOnAll: 20

exit_x:0
exit_y:-5


[action_satellite]
isVisible: if self.resource.通讯次数<${coNumber}
isActive: if self.resource(type="支配度", lessThan=100)
@define coNumber: 2
displayType: action
price: 20000, 通讯=1
id: ${section.text}
text: 发射卫星
description: -永久增加支配度10 \n -减少其他帝国支配度10 \n -总共发射2次后价格增加10000
buildSpeed: 200s
pos: 1
addResources: 通讯=1, 通讯次数=1

whenBuilding_triggerAction: signal

fireTurretXAtGround: 1
fireTurretXAtGround_withProjectile: satellite
fireTurretXAtGround_withOffset: 0, 10000
spawnUnits: 支配获得

[action_satellite2]
@copyFromSection: action_satellite
isVisible: if self.resource.通讯次数>=${coNumber}
price: 30000, 通讯=1
id: ${section.text}2
description: -永久增加支配度10 \n -减少其他帝国支配度10

[hiddenAction_Communicating]
autoTrigger: if self.resource(type="通讯", equalTo=0)
fireTurretXAtGround: antenna
fireTurretXAtGround_withProjectile: randomLight
fireTurretXAtGround_withOffset: ${turret_antenna.x}, 1000

[hiddenAction_signal]
fireTurretXAtGround: antenna
fireTurretXAtGround_withProjectile: signal
fireTurretXAtGround_withOffset: ${turret_antenna.x}, 1000


[hiddenAction_energyObtain]
autoTrigger: if self.resource(type="支配度", greaterThan=0)
resourceAmount: 能源
resourceAmount_addOtherResource: 支配度

[hiddenAction_energy]
autoTrigger: if self.resource(type="能源", greaterThan=0)
convertResource_from: 能源
convertResource_to: energy
convertResource_maxAmount: 999999
convertResource_multiplyAmountBy: 0.1


[hiddenAction_control]
autoTrigger: if self.resource(type="支配度", greaterThan=99)
convertTo: 通讯中心[支配]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
convertTo_keepCurrentTags: true
alsoTriggerAction: 属性变化
temporarilyAddTags: 支配满
addResources: 暗幕=10

[action_基因工程]
isGuiBlinking: if self.globalTeamTags(includes='基因工程')
isActive: if not self.globalTeamTags(includes='基因工程')
displayType: action
id: ${section.text}
text: 基因工程
description: -解锁生产基因步兵 \n -每训练一个步兵将会获得其价值÷1000的基因种子 \n -生产步兵机械获得其价值÷2000的基因种子
pos: 2.1
price: 2000
buildSpeed: 50s
allowMultipleInQueue: false

addGlobalTeamTags: 基因工程

[action_卫星侦视]
isActive: if self.resource(type="支配度", greaterThan=19)
displayType: action
id: ${section.text}
text: 卫星侦视
description: -一段时间内揭开目标地点的战争迷雾 \n (支配度: 20)
fireTurretXAtGround: 2
fireTurretXAtGround_withProjectile: 卫星侦视
fireTurretXAtGround_onlyOverPassableTileOf: AIR
whenBuilding_triggerAction: signal
allowMultipleInQueue: false
highPriorityQueue: true
buildSpeed: 0.3s
pos: 2.2
iconImage: scan.png
price: energy=100
playSoundToPlayer: message
addActionCooldownTime: 2s

[action_Airdrop]
isVisible: if self.resource(type="支配度", greaterThan=29) and self.resource.credits>=${credits} and self.resource.energy>=${energy} or self.queueSize(withActionTag='空投舱I')>0
isActive: if self.resource(type="支配度", greaterThan=29)
displayType: upgrade
@define credits: 7000
@define energy: 200
price: credits=${credits}, energy=${energy}
id: ${section.text}
tags=${section.text}
text: 空投舱I
description: -在指定位置投下空投舱\n -空投舱内装载 光粒步兵*5,帝国侦察坦克*1 \n (支配度: 30)
iconImage: 空投点.png
iconExtraImage: 没有机枪的空投舱.png
iconExtraColor: #50FFFFFF
fireTurretXAtGround:1
fireTurretXAtGround_withProjectile:1
highPriorityQueue: true
buildSpeed: 10s
pos: 2.3

[action_Airdrop_Display]
@copyFromSection: action_Airdrop
isVisible: if (not self.resource(type="支配度", greaterThan=29) or self.resource.credits<${credits} or self.resource.energy<${energy}) and self.queueSize(withActionTag='空投舱I')==0
fireTurretXAtGround: NONE
id: ${section.text}D

[action_Airdrop2]
@copyFromSection: action_Airdrop
isVisible: if self.resource(type="支配度", greaterThan=39) and self.resource.credits>=${credits} and self.resource.基因种子>=${gene} and self.resource.energy>=${energy} or self.queueSize(withActionTag='空投舱II')>0
isActive: if self.resource(type="支配度", greaterThan=39)
@define credits: 20000
@define energy: 350
@define gene: 4
price: credits=${credits}, 基因种子=${gene}, energy=${energy}
text: 空投舱II
description: -在指定位置投下空投舱\n-空投舱配置一门机枪\n -空投舱内装载 基因战士*4 \n (支配度: 40)
iconExtraImage: 机枪空投舱.png
fireTurretXAtGround_withProjectile:2
pos: 2.4

[action_Airdrop2_Display]
@copyFromSection: action_Airdrop2
isVisible: if (not self.resource(type="支配度", greaterThan=39) or self.resource.credits<${credits} or self.resource.基因种子<${gene} or self.resource.energy<${energy}) and self.queueSize(withActionTag='空投舱II')==0
fireTurretXAtGround: NONE
id: ${section.text}D

[action_暗源侵蚀]
isActive: if self.resource(type="支配度", greaterThan=49)
displayType: action
price: energy=500
id: ${section.text}
text: 暗源侵蚀
description: -扣除全图的3000资金并使自身获得3000资金 \n (支配度: 50)
buildSpeed: 5s
pos: 2.5
iconImage: 魔耀光.png
highPriorityQueue: true
addResources: 6000
takeResources: 3000
takeResources_discardCollected: true
takeResources_includeUnitsWithinRange: 999999
takeResources_includeUnitsWithinRange_team: any
takeResources_excludeUnitsWithoutTags: 单位系统
takeResources_maxUnits: 99
spawnEffects: CUSTOM:暗侵

#[action_军备补给]
#isActive: if self.resource(type="支配度", greaterThan=59)
#displayType: action
#price: energy=250
#text: 军备补给
#description: -立即补给两个剿灭者 \n (支配度: 60)
#buildSpeed: 0.5s
#pos: 2.5
#spawnUnits: 剿灭者*2(offsetY=-5, offsetX=-5)
#highPriorityQueue: true

[action_orbitalbombing]
isActive: if self.resource(type="支配度", greaterThan=79)
displayType: action
price: credits=35000, energy=500
id: ${section.text}
text: 太阳风暴
description: -在指定位置降下太阳之怒 \n -对建筑物只造成20%伤害 \n (支配度: 80)
iconImage: 暗核之光.png
fireTurretXAtGround:1
fireTurretXAtGround_withProjectile:3
highPriorityQueue: true
buildSpeed: 10s
pos: 2.6

[action_卫星地图]
isActive: if self.resource(type="支配度", greaterThan=99)
displayType: action
id: ${section.text}
text: 支配·卫星地图
description: -短暂获取全图视野信息 \n (支配度: 100)
spawnUnits: 卫星地图
allowMultipleInQueue: false
highPriorityQueue: true
price: energy=250
buildSpeed: 1.2s
pos: 2.7
iconImage: 雷达扫描2.png
iconExtraImage: 黑光层波.png
#playSoundToPlayer: message
playSoundGlobally:koukaongen_000.ogg:1.0
spawnEffects: CUSTOM:雷达, CUSTOM:雷达光

[hiddenAction_establish]
autoTriggerOnEvent: created
addResources: 通讯=1

[resource_通讯]
displayName: 通讯

[global_resource_通讯次数]
hidden: true

[resource_能源]
displayName: 能源

[resource_暗幕]
hidden: true

[hiddenAction_支配度1]
autoTrigger: if self.resource(type='支配值', greaterThan=0, lessThan=101) or self.resource(type='支配值', lessThan=10) and self.resource(type='支配度', greaterThan=0) and self.numberOfUnitsInAllyNotOwnTeam(withTag="支配满", lessThan=1) and numberOfUnitsInEnemyTeam(withTag="支配满", lessThan=1) and numberOfUnitsInNeutralTeam(withTag="支配满", lessThan=1)
resourceAmount: 支配度
resourceAmount_setValue: 0
resourceAmount_addOtherResource: 支配值

[hiddenAction_支配度上限100]
autoTrigger: if self.resource(type='支配值', greaterThan=100) and (self.resource(type='支配度', greaterThan=100) or self.resource(type='支配度', lessThan=91)) and self.numberOfUnitsInAllyNotOwnTeam(withTag="支配满", lessThan=1) and numberOfUnitsInEnemyTeam(withTag="支配满", lessThan=1) and numberOfUnitsInNeutralTeam(withTag="支配满", lessThan=1)
resourceAmount: 支配度
resourceAmount_setValue: 100

[hiddenAction_支配度2]
autoTrigger: if self.resource(type='支配值', greaterThan=0, lessThan=91) or self.resource(type='支配值', lessThan=10) and self.resource(type='支配度', greaterThan=0) and (self.numberOfUnitsInAllyNotOwnTeam(withTag="支配满", greaterThan=0) or numberOfUnitsInEnemyTeam(withTag="支配满", greaterThan=0) or numberOfUnitsInNeutralTeam(withTag="支配满", greaterThan=0))
@copyFromSection: hiddenAction_支配度1

[hiddenAction_支配度上限90]
autoTrigger: if self.resource(type='支配值', greaterThan=90) and self.resource(type='支配度', greaterThan=90) and (self.numberOfUnitsInAllyNotOwnTeam(withTag="支配满", greaterThan=0) or numberOfUnitsInEnemyTeam(withTag="支配满", greaterThan=0) or numberOfUnitsInNeutralTeam(withTag="支配满", greaterThan=0))
resourceAmount: 支配度
resourceAmount_setValue: 90

[global_resource_支配度]
hidden: false
displayName: 支配度
displayNameShort: 支配度
displayColor: #1E002B
priority: 0.8

[global_resource_支配值]
hidden: true
displayName: 支配值
displayNameShort: 支配值
priority: 0.8

[graphics]
total_frames: 1
imageScale: 1.5
image:   通讯中心.png
image_back: NONE
image_wreak: NONE
image_shield: 黑境.png

image_shadow: NONE
shadowOffsetX: 2
shadowOffsetY: 2

[attack]
canAttack: true
canAttackFlyingUnits: false
canAttackLandUnits:   if self.globalTeamTags(includes='AI系统')
canAttackUnderwaterUnits: false

maxAttackRange: 9999
shootDelay: 100

turretSize: 0
turretTurnSpeed: 99
aimOffsetSpread: 0
turretMultiTargeting: true


[turret_antenna]
x: -33.5
y: 21
canShoot: false
invisible: true


[projectile_randomLight]
tags= T-projectile
directDamage: 0
life: 0
spawnProjectilesOnCreate: signal(spawnChance=0.3)

[projectile_signal]
tags= T-projectile
life: 15
instant: true
beamImage:      SHARED:beam3.png
beamImageEnd:   SHARED:beam1_end.png
beamImageStart: SHARED:beam1_start.png
beamImageOffsetRate: 1.5
explodeEffect: NONE
explodeEffectOnShield: NONE
directDamage: 0
color: #0D1A1A1A
spawnProjectilesOnCreate: s2, s3, s4, s5, s6, s7, s8, s9, s10
[projectile_s2]
@copyFromSection: projectile_signal
spawnProjectilesOnCreate: NONE
life: 13
[projectile_s3]
@copyFromSection: projectile_s2
life: 12
[projectile_s4]
@copyFromSection: projectile_s2
life: 10
[projectile_s5]
@copyFromSection: projectile_s2
life: 9
[projectile_s6]
@copyFromSection: projectile_s2
life: 8
[projectile_s7]
@copyFromSection: projectile_s2
life: 6
[projectile_s8]
@copyFromSection: projectile_s2
life: 5
[projectile_s9]
@copyFromSection: projectile_s2
life: 3
[projectile_s10]
@copyFromSection: projectile_s2
life: 1

[projectile_satellite]
tags= T-projectile
life: 1000
directDamage: 0
explodeEffect: NONE
invisible: true
speed: 3
targetSpeed: 20
targetSpeedAcceleration: 0.05
deflectionPower: -1

effectOnCreate: CUSTOM:暗芯, CUSTOM:暗环
spawnProjectilesOnCreate: 影随*5(offsetHeight=2)

[projectile_影随]
tags= T-projectile
life: 1000
directDamage: 0
explodeEffect: NONE
speed: 3
targetSpeed: 20
targetSpeedAcceleration: 0.05
deflectionPower: -1

image: SHARED:light_50.png
drawSize: 0.8
color: #000000

wobbleAmplitude: 1.5
wobbleFrequency: 80



[turret_1]
x: 0
y: 0
canShoot: false
invisible: true
shoot_sound: nuke_launch
shoot_sound_vol: 0.3
limitingRange: 9999

[turret_2]
@copyFromSection: turret_antenna
limitingRange: 9999
barrelHeight: 3000


[projectile_1]
tags= T-projectile
life: 50
directDamage: 0
targetGround: true
instant: true
explodeEffect: NONE
spawnUnit: 空投舱召唤(addResources=setFlag:1)

[projectile_2]
@copyFromSection: projectile_1
spawnUnit: 空投舱召唤(addResources=setFlag:2)

[projectile_3]
@copyFromSection: projectile_1
explodeEffect: custom:curewave
spawnUnit: 太阳风暴

[projectile_卫星侦视]
tags= T-projectile
life: 60
instant: true
areaDamage: 0
laserEffect: true
color: #20000000
spawnUnit: 卫星侦视
explodeEffect: NONE
explodeEffectOnShield: NONE


[effect_暗侵]
createWhenOffscreen:true
attachedToUnit: true
drawUnderUnits: true
image: 黑境.png
life: 15
scaleFrom: 0
scaleTo: 5
alpha: 0.1
priority: critical

[effect_暗芯]
image: SHARED:light_50.png
life: 1000
fadeOut: true
attachedToUnit: true
color: #000000
scaleFrom: 1
scaleTo: 1
alpha: 0.8
dirSpeed: 3
fadeInTime: 20

[effect_暗环]
@copyFromSection: effect_暗芯
stripIndex: shockwave_large
image: NONE

[effect_curewave]
createWhenOffscreen:true
showInFog:true
liveAfterAttachedDies: false
fadeOut: false
attachedToUnit: true
drawUnderUnits: true
image: 黑境.png
life: 31
fadeInTime: 30
scaleFrom: 0
scaleTo: 1.1
alpha: 0.6
priority: critical

[effect_雷达]
priority: critical
image: 雷达.png
life: 60
scaleFrom: 1.5
scaleTo: 1.5
showInFog: true
createWhenOffscreen: true

[effect_雷达光]
priority: critical
image: 雷达光.png
life: 60
scaleFrom: 1.5
scaleTo: 1.5
alpha: 2
dirSpeed: 6
showInFog: true
createWhenOffscreen: true


[movement]
movementType: BUILDING
moveSpeed: 0
moveAccelerationSpeed: 0.01
moveDecelerationSpeed: 0.01

maxTurnSpeed: 0
turnAcceleration: 0.1

[hiddenAction_黑障之境]
convertTo: 黑障_通讯中心
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}

