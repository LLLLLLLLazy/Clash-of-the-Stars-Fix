
[core]
name: 贝露天束模块[月]
displayText: 贝露天束模块
copyFrom: common_slot.ini

displayDescription: -激光射束模块 \n -以日月之射束攻击敌军 \n -日月轮换:在不同主模块领域中会切换日光灼烧塔或月影监察者的射束攻击 \n -在日月领域切换时释放大范围日&月塔喷发效果 \n -每1能源供应提供10攻击范围加成(范围上限:320, 基础:200) \n -附加的天束模块越多造价越高

price: 3000

energyMax: 6
energyStartingPercentage: 0

tags: units, 贝露模块, 日月天束模块, 日月模块完成, 贝露中心单位

[action_权能升级]
textAddUnitName: ${section.convertTo}
descriptionAddFromUnit: ${section.convertTo}
descriptionAddUnitStats: ${section.convertTo}
isActive: if self.queueSize(empty=true)
buildSpeed: 300s
convertTo: 碎质合成
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
price: 苍蓝能量=35
setUnitMemory: 属性[20]=0, 属性[19]=0

iconExtraImage: icon_upgrade_top.png
iconExtraColor: #AAFFFFFF

[hiddenAction_日月交替]
autoTrigger: if parent.tags(includes="日耀T1") or parent.tags(includes="日耀T2") or parent.tags(includes="日耀T3")
convertTo: 贝露天束模块[日]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
fireTurretXAtGround: explode
fireTurretXAtGround_withOffset: 0, 0
setUnitMemory: 属性[20]=0, 属性[19]=0

#[hiddenAction_满月转化]
#autoTrigger: if parent.tags(includes="月曜T3")
#convertTo: 贝露天束模块[满月]
#setUnitMemory: 属性[20]=0, 属性[19]=0.5


[hiddenAction_能量清空]
autoTriggerOnEvent: killedAnyUnit
autoTrigger: if not self.isAttacking() or self.ammo(lessThan=1)
addEnergy: -6

[hiddenAction_-ammo]
autoTrigger: true
addResources: ammo=-1
alsoTriggerAction:-ammo2

[hiddenAction_-ammo2]
requireConditional: if self.ammo(greaterThan=4)
addResources: ammo=-1

[hiddenAction_月曜T2]
autoTrigger: if parent.resource.月曜模块==2 and not self.tags(includes="月曜T2")
setUnitMemory: 属性[19]=0.5
temporarilyAddTags: 月曜T2
alsoTriggerAction: 属性变化

[resource_月曜模块]
displayName: 月曜模块

[global_resource_日耀]
displayName: 日耀
displayColor: #A0FF9500
priority: 0.3

[global_resource_月曜]
displayName: 月曜
displayColor: #A04060FF
priority: 0.3

[hiddenAction_月曜无效]
autoTrigger: true
setResourcesWithLogic: 月曜T1攻速=0.01, 月曜T2攻速=0.01


[action_reclaim]
description: -为另一种模块腾出空槽 \n -返还%{${core.price * 0.5} * parent.numberOfAttachedUnits(withTag="日月模块完成")}资金 \n -返还价值随数量变动
addResources: 0
addResourcesWithLogic: credits=${core.price * 0.5} * parent.numberOfAttachedUnits(withTag="日月模块完成")

[action_destroy]
description: -立即破坏此模块 \n -为另一种模块腾出空槽 \n -仅返还%{${core.price * 0.05} * parent.numberOfAttachedUnits(withTag="日月模块完成")}资金 \n -返还价值随数量变动
addResources: 0
addResourcesWithLogic: credits=${core.price * 0.05} * parent.numberOfAttachedUnits(withTag="日月模块完成")


[attack]
canAttack: true
canAttackFlyingUnits: if parent.tags(includes="月曜T1") or parent.tags(includes="月曜T2") or parent.tags(includes="月曜T3")
canAttackLandUnits: if parent.tags(includes="月曜T1") or parent.tags(includes="月曜T2") or parent.tags(includes="月曜T3")
canAttackUnderwaterUnits: false
maxAttackRange: 200
shootDelay: 5
aimOffsetSpread: 0
turretSize: 0

[turret_0]
x: 0
y: 50
canShoot: false
turnSpeed: 3

[turret_1.0]
x: 0
y: 0
attachedTo: 0
slave: true
shoot_flame: CUSTOM:shieldwave低透明, CUSTOM:conceptshield低透明

projectile: 1.0
resourceUsage: energy=-0.06, ammo=-1
altProjectile: 1.1
altProjectileCondition: if self.energy(greaterThan=1) and not self.energy(greaterThan=2)
canAttackCondition: if not self.energy(greaterThan=2)

[turret_1.2]
@copyFromSection: turret_1.0
canAttackCondition: if self.energy(greaterThan=1.9) and not self.energy(greaterThan=4)
projectile: 1.2
altProjectile: 1.3
altProjectileCondition: if self.energy(greaterThan=3) and not self.energy(greaterThan=4)

[turret_1.4]
@copyFromSection: turret_1.0
canAttackCondition: if self.energy(greaterThan=3.89) and not self.energy(full=true)
projectile: 1.4
altProjectile: 1.5
altProjectileCondition: if self.energy(greaterThan=5) and not self.energy(full=true)

[turret_1.6]
@copyFromSection: turret_1.0
canAttackCondition: if self.energy(greaterThan=5.9)
projectile: 1.6

[hiddenAction_供应加成]
autoTrigger: if self.resource(type="能源供应", greaterThan=0) and memory.属性[20]!=min(self.resource.能源供应*10, 120)
#setUnitStats: maxAttackRange=200+min(self.resource.能源供应*25, 160)
setUnitMemory: 属性[20]=min(self.resource.能源供应*10, 120)
alsoTriggerAction: 属性变化

[hiddenAction_失去供应]
autoTrigger: if self.resource(type="能源供应", lessThan=1) and memory.属性[20]>0
#setUnitStats: maxAttackRange=200
setUnitMemory: 属性[20]=0
alsoTriggerAction: 属性变化


[projectile_1.0]
tags= T-projectile
life: 20
instant: true
instantReuseLast: true
instantReuseLast_alsoChangeTurretAim: true
moveWithParent: true
beamImage:      SHARED:beam3.png
beamImageEnd:   SHARED:beam1_end.png
beamImageStart: SHARED:beam1_start.png
beamImageOffsetRate: 1.5
sweepOffsetFromTargetRadius:0.2
sweepSpeed: 20
explodeEffect: CUSTOM:shieldwave, CUSTOM:conceptshield
explodeEffectOnShield: CUSTOM:shieldwave, CUSTOM:conceptshield

areaDamage: 20
areaRadius: 35
color: #63e6e8
[projectile_1.1]
@copyFromSection:projectile_1.0
areaDamage: 15
[projectile_1.2]
@copyFromSection:projectile_1.0
areaDamage: 12
[projectile_1.3]
@copyFromSection:projectile_1.0
areaDamage: 10
[projectile_1.4]
@copyFromSection:projectile_1.0
areaDamage: 8
[projectile_1.5]
@copyFromSection:projectile_1.0
areaDamage: 6
[projectile_1.6]
@copyFromSection:projectile_1.0
areaDamage: 2
areaRadius: 10
color: #ffffff

explodeEffect: NONE
explodeEffectOnShield: NONE

[turret_explode]
x: 0
y: 0
canShoot: false
projectile: explode

[projectile_explode]
tags= T-projectile
life: 99
instant: true
targetGround: true
areaDamage: -400
areaRadius: 360
areaHitAirAndLandAtSameTime: true
areaHitUnderwaterAlways: true
friendlyFire: true
hullDamageMultiplier: 0
deflectionPower: -1
lightColor: #FFD500
lightSize: 1

pushForce: -1
pushVelocity: -5

explodeEffect: CUSTOM:shockwave*3, 大阳
explodeEffectOnShield: CUSTOM:shockwave*3, 大阳

[effect_shockwave]
image: 日月波.png
life: 35
fadeInTime: 3
scaleFrom: 3.2
scaleTo: 0.5
alpha: 0.6
#color: #42F8FF
color: #FFD500
dirSpeed: -8
dirSpeedRandom: 1
dirOffsetRandom: 180

[effect_大阳]
image: 阳.png
life: 40
scaleFrom: 1.3
scaleTo: 1.25
alpha: 1.0

[effect_shieldwave]
image: ROOT:/素材/hit.png
life: 10
scaleFrom: 1.0
scaleTo: 1.0
alpha: 1.0
alsoPlaySound: laser_deflect

[effect_conceptshield]
image: ROOT:/素材/shield_mid.png
life: 10
scaleFrom: 0.5
scaleTo: 0.5
alpha: 1.0

[effect_shieldwave低透明]
@copyFromSection: effect_shieldwave
alpha: 0.5

[effect_conceptshield低透明]
@copyFromSection: effect_conceptshield
alpha: 0.5

[graphics]
image: 苍影日月塔.png




