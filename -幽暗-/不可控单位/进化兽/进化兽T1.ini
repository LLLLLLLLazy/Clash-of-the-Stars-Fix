
[core]
name: 进化兽T1
displayText: 进化兽
displayDescription: -攻击地面与空中 \n -在战斗后逐渐变强 \n -适应所受的伤害 \n -击杀吞噬目标生命

class: CustomUnitMetadata
price: 9000
maxHp: 5000
mass: 40000
tags: units

techLevel: 2
buildSpeed: 0.0004
#availableInDemo: true

canNotBeGivenOrdersByPlayer: true

radius: 26
displayRadius: 28

isBio: true
isBug: false

selfRegenRate: 0.1
@global adaptRate: 0.01

energyMax: 15
energyRegen: 0
energyStartingPercentage: 0

[hiddenAction_$运输]
@copyFrom_skipThisSection:true


[hiddenAction_evolution]
autoTrigger: if self.isEnergyFull()
addResources: hp=500, energy=-15
convertTo: 进化兽T2
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}


[hiddenAction_killed]
autoTriggerOnEvent: killedAnyUnit
addResourcesWithLogic: hp=eventSource.maxHp
spawnEffects: 紫光

[hiddenAction_适应伤害]
autoTriggerOnEvent: tookDamage
autoTrigger: if self.resource.受击前血量>self.hp
requireConditional: if self.resource.受击前血量>self.hp
setResourcesWithLogic: hp=self.hp+( (self.resource.受击前血量-self.hp) * min( (self.resource.适应量 / (self.resource.受击前血量-self.hp)), 0.999 ) ), 受击前血量=self.hp

[hiddenAction_每秒受伤]
autoTrigger: if self.customTimer(laterThanSeconds=1)
setResourcesWithLogic: 每秒受伤=(self.resource.当前血量-self.hp), 适应量=self.resource.适应量+max((self.resource.每秒受伤*${adaptRate}),0), 当前血量=self.hp, 受击前血量=self.hp
resetCustomTimer: true

[hiddenAction_适应光环]
autoTrigger: if self.resource.每秒受伤>1
spawnEffects: 适应光环

[resource_当前血量]
hidden: true

[resource_受击前血量]
hidden: true

[resource_每秒受伤]
hidden: true

[resource_适应量]
displayName: 适应量


[arm_1]
x:0
y:0
image_end: 进化兽光环.png

drawOverBody: true

spinRate:3

[graphics]

total_frames: 1
image:        进化兽身.png
image_wreak:  NONE
image_turret: NONE
#scaleImagesTo: 20
#scaleTurretImagesTo: 9

animation_idle_start: 0
animation_idle_end: 0
animation_idle_speed: 120
animation_idle_scale_start: 1
animation_idle_scale_end: 1.03
animation_idle_pingPong: true

#AUTO
image_shadow: AUTO
shadowOffsetX:1
shadowOffsetY:1

lock_body_rotation_with_main_turret: true

[attack]
canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits: true
canAttackUnderwaterUnits: false

turretSize: 28
turretTurnSpeed: 3

maxAttackRange: 180
shootDelay: 130

isMelee:true
meleeEngangementDistance:99999

[turret_1]
x: 0
y: 0
invisible: true

shoot_sound:large_gun_fire2
shoot_sound_vol:0.4
shoot_flame:CUSTOM:毒雾2*4
shoot_light: #360D70

recoilOffset: -2
recoilOutTime: 6
recoilReturnTime: 18

resourceUsage: energy=-1

projectile: 1

[turret_2]
x: 0
y: 0
invisible: true

linkDelayWithTurret: 1

projectile: 1

[turret_3]
x: 0
y: 0
invisible: true

linkDelayWithTurret: 1

projectile: 1

[projectile_1]
tags= T-projectile
directDamage: 50
areaDamage: 65
areaRadius: 45
areaRadiusFromEdge: true
life:200

speed:0.5
targetSpeed:5

largeHitEffect:true

trailEffect:CUSTOM:毒雾
trailEffectRate:3

lightColor: #360D70
lightSize: 0.5

deflectionPower: 2

image:紫蛋.png

[effect_毒雾]
stripIndex: effects
frameIndex: 0
priority:low

life: 100
fadeOut: true
attachedToUnit: false
color: #360D70
fadeInTime:5
hSpeed: 0.3
scaleFrom: 0.25
scaleTo: 1.0
alpha: 0.3
drawUnderUnits:false
xOffsetRelativeRandom:3
xSpeedRelativeRandom:0.2
ySpeedRelative:1.5
ySpeedRelativeRandom:0.2

shadow: true
atmospheric: true

[effect_毒雾2]
stripIndex: effects
frameIndex: 0
priority:low

life: 100
fadeOut: true
attachedToUnit: false
color: #360D70
fadeInTime:3
hSpeed: 0.1
scaleFrom: 0.4
scaleTo: 1.6
alpha: 0.4
drawUnderUnits:false
yOffsetRelative:-5
xSpeedRelativeRandom:0.2
ySpeedRelative:0.3
ySpeedRelativeRandom:0.2

shadow: true
atmospheric: true



[effect_紫光]
stripIndex: light_50
life: 25
fadeOut: true
scaleFrom: 2
scaleTo: 2
alpha: 0.5
color: #9633FF

[effect_适应光环]
image: 进化兽光环.png
life: 40
fadeOut: true
scaleFrom: 1
scaleTo: 1.2
alpha: 0.6
dirSpeed: 4



[movement]
movementType: OVER_CLIFF
moveSpeed: 0.7
moveAccelerationSpeed: 0.04
moveDecelerationSpeed: 0.08

reverseSpeedPercentage:0.9

maxTurnSpeed: 3
turnAcceleration: 0.05

moveSlidingMode :true
moveIgnoringBody:true

[leg_1]
x: -25
y: 27
attach_x: 0
attach_y: 0
moveSpeed: 2.4
moveWarmUp:0.03s

rotateSpeed: 7

heightSpeed: 0.7
resetAngle:25

image_leg:  进化兽腿.png
image_foot: NONE

#draw_foot_on_top: true
#dust_effect: false

holdDisMin: 22
holdDisMax: 45

endDirOffset:45

[leg_2]
x: 25
y: 27
attach_x: 0
attach_y: 0
copyFrom: 1

endDirOffset:-45

[leg_3]
x: -25
y: -27
attach_x: 0
attach_y: 0
copyFrom: 1

endDirOffset:-45

[leg_4]
x: 25
y: -27
attach_x: 0
attach_y: 0
copyFrom: 1


endDirOffset:45