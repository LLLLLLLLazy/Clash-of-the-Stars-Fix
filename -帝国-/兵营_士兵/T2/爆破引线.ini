[core]
name: 爆破引线
maxHp: 1
price: 0
mass: 0
tags: 爆破引线

isBuilding: true
footprint: 1,1,-1,-1

canOnlyBeAttackedByUnitsWithTags: 爆破师

#隐藏单位本身
showInEditor: false
radius: 0
fogOfWarSightRange: 0
showOnMinimap: false
ignoreInUnitCapCalculation: true
disableAllUnitCollisions: true
isUnselectable: true

#禁止死亡痕迹
numBitsOnDeath:	0
explodeOnDeath:	false
hideScorchMark: true

#------------------
@memory 连接地雷:unit

autoTriggerCooldownTime: 0.1s

[graphics]
image: SHARED:blank.png
icon_zoomed_out_neverShow: true

[decal_1]
layer: beforeUI
image: icon_红标.png
imageScale: max(0.5, 0.7+(cos(180)*self.timeAlive*3))
alpha: min(0.5, self.timeAlive*2)

[attack]
canAttack: false

[hiddenAction_爆破引线连接]
autoTriggerOnEvent: created
requireConditional: if numberOfUnitsInTeam(withTag='激光感束雷', withinRange=60)>0
teleportTo: nearestUnit(withinRange=60, withTag='激光感束雷', relation='own')
setUnitMemory: 连接地雷=nearestUnit(withinRange=60, withTag='激光感束雷', relation='own')
alsoTriggerAction: 引线锁定

[hiddenAction_爆破引线无目标]
autoTriggerOnEvent: created
requireConditional: if numberOfUnitsInTeam(withTag='激光感束雷', withinRange=60)<1
alsoTriggerAction: 停止锁定

[hiddenAction_引线锁定]
sendMessageTo: customTarget1
sendMessageWithTags: 攻击标记
sendMessageWithData: 攻击=self
switchToAggressiveTeam: true

[hiddenAction_攻击结束]
autoTrigger: if self.hasFlag(id=0)
takeResources: hp=500
takeResources_discardCollected: true
takeResources_includeReference: memory.连接地雷
takeResources_excludeUnitsWithoutAllResources: false
sendMessageTo: customTarget1
sendMessageWithTags: 引爆完成, 停止锁定
deleteSelf: true

[hiddenAction_停止锁定]
autoTrigger: if self.timeAlive > 0.1 and (customTarget1.activeWaypointTarget!=self or memory.连接地雷==null)
sendMessageTo: customTarget1
sendMessageWithTags: 停止锁定
deleteSelf: true


[movement]
movementType: NONE

targetHeight: -10
startingHeightOffset: -10

[ai]
notPassivelyTargetedByOtherUnits: true
