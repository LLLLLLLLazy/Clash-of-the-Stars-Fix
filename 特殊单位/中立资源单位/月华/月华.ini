
[core]
showInEditor:false

name: 月华
displayText: 月华
displayDescription: -回收可获得2000资源

class: CustomUnitMetadata
price: 2000
maxHp: 2000
mass: 1000

tags: units, 召唤物, 中立资源

techLevel: 1

buildSpeed: 0.0004
availableInDemo: false

radius: 10

disableAllUnitCollisions: true

numBitsOnDeath:	0
explodeOnDeath:	false
hideScorchMark: true
effectOnDeath: 月华末光, 散月华*2, 散月华光粒*4, 月华闪光

stayNeutral: true
createNeutral: true

resourceRate: 3

autoTriggerCooldownTime: 0.1s

[hiddenAction_hitLightFlash]
autoTriggerOnEvent: created
spawnEffects: CUSTOM:hitLightFlash, 月华闪光, 烁月华, 落月光环
offsetSelfAbsolute: 0, 0, 250

[hiddenAction_落月华曜]
autoTrigger: if not self.hasFlag(id=1) and self.timeAlive>0.5
spawnEffects: 落月华粒子

[hiddenAction_落华波]
autoTrigger: if self.height <= 6 and not self.hasFlag(id=1)
spawnEffects: CUSTOM:shockwave
addResources: setFlag=1

[hiddenAction_散月华]
autoTrigger: if self.hp <= 60 and not self.hasFlag(id=0)
spawnEffects: 散月华*2, 散月华光粒*4, 月华末光, 月华闪光
addResources: setFlag=0

[hiddenAction_月华粒子]
autoTrigger: true
spawnEffects: 月华粒子

[effect_hitLightFlash]
priority: veryhigh

image: SHARED:light_50.png
life: 360
fadeInTime: 60
fadeOut: true
attachedToUnit: true
color: #FFFFCC

scaleFrom: 1
scaleTo: 1
alpha: 1.7
drawUnderUnits: false
imageShadow: 月华光.png

[effect_月华闪光]
priority: low
image: SHARED:light_50.png
life: 20
fadeOut: true
attachedToUnit: false
color: #FFFFCC
scaleFrom: 1.7
scaleTo: 2
alpha: 0.6

[effect_烁月华]
priority: veryhigh

image: 烁星光.png
life: 360
fadeInTime: 60
fadeOut: true
attachedToUnit: true
color: #FFFFCC

scaleFrom: 1
scaleTo: 1
alpha: 0.4
drawUnderUnits: false

[effect_落月光环]
priority: veryhigh

image: 月圆环.png
life: 360
fadeInTime: 60
fadeOut: true
attachedToUnit: true
color: #FFFFCC

scaleFrom: 0.4
scaleTo: 0.4
alpha: 0.15
drawUnderUnits: false


[effect_shockwave]
stripIndex: shockwave_large
life: 100
fadeOut: true
attachedToUnit: false
scaleFrom: 0
scaleTo: 0.8
alpha: 1
color: #FFFFCC
hOffset: -1
physics: true
physicsGravity: 0.2
drawUnderUnits: true


[effect_月华粒子]
priority: verylow
image: 白粒.png
life: 200
lifeRandom: 50
attachedToUnit: false
scaleFrom: 1.8
scaleTo: 0.8
alpha: 0.3
color: #FFFFCC
drawUnderUnits: false
dirSpeedRandom: 3
xSpeedRelativeRandom: 0.3
ySpeedRelativeRandom: 0.3
delayedStartTimerRandom: 5

[effect_落月华粒子]
@copyFromSection: effect_月华粒子
life: 120
lifeRandom: 30
scaleFrom: 2.5
scaleTo: 1.5
alpha: 0.5
dirSpeedRandom: 5
hSpeed: 0.5
xSpeedRelativeRandom: 0.6
ySpeedRelativeRandom: 0.6


[effect_月华末光]
priority: veryhigh
image: SHARED:light_50.png
life: 120
fadeOut: true
attachedToUnit: true
color: #FFFFCC

scaleFrom: 1
scaleTo: 1
alpha: 0.8
drawUnderUnits: false

[effect_散月华]
priority: high
image: 白雾.png
life: 100
lifeRandom: 20
attachedToUnit: false
scaleFrom: 0
scaleTo: 0.8
alpha: 0.3
color: #FFFFCC
drawUnderUnits: false
dirOffsetRandom: 180
dirSpeedRandom: 0.3

[effect_散月华光粒]
priority: low
stripIndex: light_50
life: 120
lifeRandom: 20
attachedToUnit: false
scaleFrom: 0.2
scaleTo: 0.1
alpha: 0.7
color: #FFFFCC
drawUnderUnits: false
xSpeedRelativeRandom: 0.6
ySpeedRelativeRandom: 0.6
delayedStartTimerRandom: 10
spawnChance: 0.8

[graphics]
image: 大空.png
showHealthBar: false

disableLowHpFire: true
disableLowHpSmoke: true

[decal_月华]
layer: afterBody
alpha: 0.7 * min(self.timeAlive, 1) * (0.5+((self.hp/self.maxHp)*0.5))
image: 月华.png
imageScale: 1
basePositionFromLegEnd: arm_2

[decal_月华光]
@copyFromSection: decal_月华
alpha: 0.25 * min(self.timeAlive, 1) * (0.5+((self.hp/self.maxHp)*0.5))
image: 月华光.png
imageScale: 2

[decal_月华渐光]
@copyFromSection: decal_月华光
@define timer_5s: ((self.timeAlive() % 5) / 5)
alpha: (0.6 + cos( ${timer_5s} * 360) * 0.1) * (0.5+((self.hp/self.maxHp)*0.5))
imageScale: 1

[decal_月华环]
@copyFromSection: decal_月华
alpha: 0.15 * min(self.timeAlive/5, 1) * (0.5+((self.hp/self.maxHp)*0.5))
image: 月圆环.png
imageScale: 0.25

[decal_月华外环]
@copyFromSection: decal_月华环
alpha: 0.1 * min(self.timeAlive/5, 1)
image: 月圆环.png
imageScale: 0.4

[arm_2]
x: 0
y: 0
hidden: true
spinRate: 2


[attack]
canAttack: false

[movement]
movementType: AIR
moveSpeed: 0
moveAccelerationSpeed: 0
moveDecelerationSpeed: 0

maxTurnSpeed: 0
turnAcceleration: 0

targetHeight: 2
targetHeightDrift: 1.5
heightChangeRate: 0.8
landOnGround: true

ignoreMoveOrders: true

[ai]
useAsBuilder: true