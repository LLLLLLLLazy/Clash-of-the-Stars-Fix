
[core]
name: 喜鹊
displayText: 喜鹊
price: 0
maxHp: 50
mass: 80
tags: 喜鹊, 可承伤单位

dont_load: true

allowCaptureWhenNeutralByAI: true

selfRegenRate: 0.02

createNeutral: true
isUnrepairableUnit:	true

displayDescription: ~

techLevel: 1
buildSpeed: 0.0016
selfBuildRate: 0.0016

radius: 7
displayRadius: 7
isBio: true

showOnMinimap: false

hideScorchMark: true
explodeOnDeathGroundCollision: false

fogOfWarSightRange: 8

transportSlotsNeeded: 1
maxTransportingUnits: 1
transportUnitsBlockOtherTransports: false

effectOnDeath: 羽毛飞散*5

[hiddenAction_游荡]
autoTrigger: if not self.isMoving and rnd(0, 100)<0.1 and self.isOnNeutralTeam
addWaypoint_type: move
addWaypoint_position_randomOffsetFromSelf: 300, 300
addWaypoint_target_mapMustBeReachable: true
addWaypoint_maxTime: 5s

[hiddenAction_回走检测]
autoTrigger: if self.isOnNeutralTeam
addWaypoint_type: touchTarget
addWaypoint_prepend: true
addWaypoint_target_nearestUnit_tagged: 喜鹊出生
addWaypoint_target_nearestUnit_team: neutral
addWaypoint_target_nearestUnit_maxRange: 300
addWaypoint_triggerActionIfFailed: 回走
addWaypoint_maxTime: 0s

[hiddenAction_回走]
addWaypoint_type: touchTarget
clearAllWaypoints: true
addWaypoint_prepend: true
addWaypoint_target_nearestUnit_tagged: 喜鹊出生
addWaypoint_target_nearestUnit_team: neutral
addWaypoint_target_nearestUnit_maxRange: 500
addWaypoint_maxTime: 5s

[hiddenAction_边界消失]
autoTrigger: if not self.isOverPassableTile(type="AIR") and self.isOnNeutralTeam
deleteSelf: true

[hiddenAction_毒素血量减血]
autoTrigger: if self.resource.毒素>0 and self.isOnNeutralTeam
addResourcesWithLogic: hp=-min(min(self.resource.毒素, 60), self.hp-0.1), 毒素=-min(min(self.resource.毒素, 60), max(self.hp-0.1, 15))

[hiddenAction_弱效毒素减血]
autoTrigger: if self.resource.弱效毒素>0 and self.resource.毒素<=0 and self.isOnNeutralTeam
addResourcesWithLogic: hp=-min(min(self.resource.毒素, 20), self.hp-0.1), 毒素=-min(min(self.resource.毒素, 20), max(self.hp-0.1, 5))

[resource_毒素]
displayName: 毒素

[resource_弱效毒素]
displayName: 弱效毒素


[attachment_1]
x:0
y:0
lockDir:true
canAttack:false
addTransportedUnits:true
#添加到被运输
keepAliveWhenParentDies:true
#母体死亡时附属存活
canBeAttackedAndDamaged:false
#可被攻击损坏
rotateWithParent:false
#附属一同旋转
lockLegMovement:true
#锁定腿脚
isUnselectable:true
#禁止选择
setDrawLayerOnBottom:true
#绘制在底部

[graphics]
image:       SHARED:blank.png
image_wreak: NONE
image_turret: NONE

#AUTO
image_shadow: AUTO_ANIMATED
shadowOffsetX: 0
shadowOffsetY: 0

rotate_with_direction: false


[decal_body]
isVisible: if self.dir<-90 or self.dir>=90
layer: afterBody
image: 喜鹊.png
imageScale: 0.75
total_frames: 5
@define timer_1s: ((self.timeAlive() % 0.3) / 0.3)
frame: select(self.isFlying, 1 + ${timer_1s} * 4, 0)
alwaysStartDirAtZero: true

[decal_body2]
@copyFromSection: decal_body
isVisible: if self.dir>=-90 and self.dir<90
image: 喜鹊右.png

[decal_body阴影]
@copyFromSection: decal_body
layer: shadow
image: SHADOW:喜鹊.png
alwaysStartHeightAtZero: true

[decal_body2阴影]
@copyFromSection: decal_body2
layer: shadow
image: SHADOW:喜鹊右.png
alwaysStartHeightAtZero: true

[attack]
canAttack: false



[effect_羽毛飞散]
priority: low
image: 羽毛.png
life: 100
lifeRandom: 20

fadeOut: true
attachedToUnit: false
scaleFrom: 0.3
scaleTo: 0.3
alpha: 1
drawUnderUnits: false
hSpeedRandom: 0.5
xSpeedRelativeRandom: 0.5
ySpeedRelativeRandom: 0.5

dirOffsetRandom: 180
dirSpeedRandom: 2

atmospheric: true

physics: true
physicsGravity: 0.05

imageShadow: SHADOW:羽毛.png
shadow: true

[movement]
movementType: AIR
moveSpeed: 1
moveAccelerationSpeed: 0.03
moveDecelerationSpeed: 0.03

landOnGround: onlyIdle

targetHeight: 25
targetHeightDrift: 3

maxTurnSpeed: 4
turnAcceleration: 0.15

moveSlidingMode: true
moveIgnoringBody: true

moveSlidingDir: 181

[ai]
lowPriorityTargetForOtherUnits: true
