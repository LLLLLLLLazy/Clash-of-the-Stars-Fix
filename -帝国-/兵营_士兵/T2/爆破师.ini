
[core]
name: 爆破师
displayDescription: -短暂锁定后爆破地面单位 \n -对建筑造成双倍伤害 \n -对护盾伤害减半 \n -不能在移动时攻击

copyFrom: 帝国步兵模板.ini

price: 900
maxHp: 310
mass: 1000

techLevel: 2
buildSpeed: 10.4s

tags: ${tags}, 固定射击, 爆破师

[action_爆破引线]
id: ${section.text}
text: 爆破引线
description: -使用引爆光线激活指定位置的己方[激光感束雷] \n CD:10s
buildSpeed: 0s
pos: 1
displayType: action
iconExtraImage: 激光感束雷.png
allowMultipleInQueue: false
onlyOneUnitAtATime: true
addActionCooldownTime: 0.4s

fireTurretXAtGround: 1
fireTurretXAtGround_withProjectile: 爆破引线
fireTurretXAtGround_showGuideDecals: 红标, 引线检索范围

setUnitMemory: 属性[20]=memory.属性[20]+(350-${attack.maxAttackRange})
alsoTriggerAction: 属性变化

[hiddenAction_引爆完成]
autoTriggerOnEvent: newMessage(withTag='引爆完成')
addActionCooldownTime: 10s
addActionCooldownApplyToActions: 爆破引线

[hiddenAction_引线锁定]
autoTriggerOnEvent: newMessage(withTag='攻击标记')
clearActiveWaypoint: true
addWaypoint_type: attack
addWaypoint_prepend: true
addWaypoint_target_fromReference: eventData(name='攻击', type='unit')

[hiddenAction_停止锁定]
autoTriggerOnEvent: newMessage(withTag='停止锁定')
setUnitMemory: 属性[20]=memory.属性[20]-(350-${attack.maxAttackRange})
alsoTriggerAction: 属性变化

[projectile_爆破引线]
tags= T-projectile
directDamage: 0
life: 50
instant: true
invisible: true
spawnUnit: 爆破引线
explodeEffect: NONE

[decal_红标]
alwaysStartHeightAtZero: true
layer: inactive
image: icon_红标.png
imageScale: 0.5
alpha: 0.5
color: #FF0000

[decal_引线检索范围]
alwaysStartHeightAtZero: true
layer: inactive
image: 圆.png
imageScale: ${60/300}
alpha: 0.1
color: #FF0000
drawLineTo: self

[graphics]
total_frames: 4
image: 破坏者.png

animation_attack_start: 1
animation_attack_end: 3
animation_attack_speed: 4

lock_body_rotation_with_main_turret: false

[attack]
canAttack: true
canAttackFlyingUnits: false
canAttackLandUnits:   true
canAttackUnderwaterUnits: if self.hasActiveWaypoint(type='attack') and activeWaypointTarget.tags(includes='爆破引线')

turretSize: 5
turretTurnSpeed: 3

maxAttackRange: 190
shootDelay: 150

isFixedFiring: true

aimOffsetSpread: 0

[turret_1]
x: 0
y: 0
idleDir:0

turnSpeed: 2.9
turnSpeedAcceleration: 0.3
canShoot: false

limitingRange: 350

[turret_2]
x: 0
y: 0
attachedTo: 1
slave: true

projectile: 1

warmup: 60
warmupStartEffect:CUSTOM:锁定

shoot_sound:cannon_firing
shoot_sound_vol:0.2

canAttackCondition: if not attacking.tags(includes='爆破引线')

[turret_3]
x: 0
y: 0
attachedTo: 1
slave: true

projectile: 2

delay: 20
warmup: 20
warmupStartEffect: CUSTOM:锁定音效
shoot_sound: cannon_firing
shoot_sound_vol: 0.1

canAttackCondition: if attacking.tags(includes='爆破引线')

[projectile_1]
tags= T-projectile
life: 50
speed: 100

largeHitEffect: true

drawSize: 0
deflectionPower: -1

directDamage: 200
areaDamage: 200
areaRadius: 50

shieldDamageMultiplier: 0.5
buildingDamageMultiplier: 2

spawnProjectilesOnCreate: 2
spawnProjectilesOnExplode: 1附

[projectile_1附]
tags= T-projectile
life: 0
speed: 0
explodeOnEndOfLife: true
invisible: true
targetGround: true
directDamage: 0
explodeEffect: CUSTOM:explodeCore, CUSTOM:explodeCore2, CUSTOM:sparks*6, CUSTOM:fire*3

[projectile_2]
tags= T-projectile
life: 12
instant: true
beamImage: 回收.png
directDamage: 0

mutatorX_ifUnitWithTags: 爆破引线
mutatorX_directDamageMultiplier: 0
mutatorX_addResourcesDirectHit: setFlag=0

[effect_explodeCore]
priority: veryhigh
life: 24
attachedToUnit: true
stripIndex: explode_big2
scaleFrom: 2.0
scaleTo: 2.0
alpha: 1
total_frames: 14
animateFrameStart: 0
animateFrameEnd: 13
animateFrameSpeed: 0.6
fadeOut: false

[effect_explodeCore2]
priority: veryhigh
life: 36
attachedToUnit: true
stripIndex: explode_big2
scaleFrom: 1.5
scaleTo: 1.5
alpha: 1
total_frames: 14
animateFrameStart: 0
animateFrameEnd: 13
animateFrameSpeed: 0.4
fadeOut: false

[effect_sparks]
attachedToUnit: false
life: 100
physics: true
xSpeedRelativeRandom: 1.8
ySpeedRelativeRandom: 1.8
hSpeed: 3
image: SHARED:spark.png
color: #FF0000
priority: verylow

[effect_fire]
priority: low
life: 30
lifeRandom: 5
alpha: 1
scaleFrom: 0.8
scaleTo: 0.6
stripIndex: fire
drawUnderUnits: false
atmospheric: true
attachedToUnit: false
hSpeed: 2
xSpeedRelativeRandom: 2.4
ySpeedRelativeRandom: 2.4

[effect_锁定]
priority: veryhigh
life: 60
fadeInTime: 10
fadeOut: false
attachedToUnit: false
image: icon_红标.png
scaleFrom: 0.7
scaleTo: 0.7
alpha: 1
ySpeedRelative: 3.1
dirSpeed: 2
alsoPlaySound:warning.ogg:0.5

[effect_锁定音效]
alsoPlaySound: warning.ogg:0.2
life: 0


[movement]
moveSpeed: 0.7
reverseSpeedPercentage: 0.9