
[core]
name:溃烂
class: CustomUnitMetadata
displayDescription:-对地对空 \n-被溃烂攻击的单位死亡后将化为新的溃烂 \n-当目标价值很高时会产生多个溃烂 \n-对血量低于自身伤害的单位无效 \n-溃质产生的溃烂血量为150+[目标价值÷3] \n-溃质价值最多提升至1100血量 \n-回收不退还资金
tags: units, 虫族, 中型虫, 溃烂, 转向攻击
price:3200, 腐蚀=${corrode}
reclaimPrice: 0, 腐蚀=10
maxHp:800
mass:5600

maxShield:1
shieldRegen:0.1

radius:15
techLevel:2

isBug:true
isBio:true

softCollisionOnAll: 12

selfRegenRate:0.1
buildSpeed:55.6s

#generation_credits:	-1

#unitsSpawnedOnDeath: 资源返还(addResources=ammo:75|energy:25)

[hiddenAction_亡灵生成]
autoTriggerOnEvent: destroyed
requireConditional: if self.globalTeamTags(includes='狂猎') and self.globalTeamTags(includes='皎红')
spawnUnits: 溃烂[亡灵]

[hiddenAction_腐蚀价格]
@global corrode: 1200
autoTrigger: if memory.腐蚀价格!=${corrode}
setUnitMemory: 腐蚀价格=${corrode}

[hiddenAction_死亡返还]
autoTriggerOnEvent: destroyed
requireConditional: if not self.hasFlag(id=0) and self.globalTeamTags(includes='狂猎')
addResources: 800, 腐蚀=300

[action_狂猎击杀]
@copyFromSection: template_狂猎击杀

[action_狂猎击杀2]
@copyFromSection: template_狂猎击杀2

[hiddenAction_召唤物单位]
autoTriggerOnEvent: created
requireConditional: if self.hasFlag(id=0)
temporarilyAddTags: 召唤物
#溃烂血量
setUnitMemory: 属性[14]=min( (customTarget1.readUnitMemory('锁定目标', type='unit').priceCredits + (customTarget1.readUnitMemory('锁定目标', type='unit').readUnitMemory('腐蚀价格', type='float')*3) )/3 - (self.maxHp-150), 1100-self.maxHp), 属性[15]=-self.maxShield
alsoTriggerAction: 属性变化
sendMessageTo: customTarget1
sendMessageWithTags: 消失

[graphics]
image:溃烂.png
scaleImagesTo:32
image_turret:NONE
image_shield: 溃烂盾.png

showShieldBar: false

image_shadow: AUTO_ANIMATED
shadowOffsetX:1
shadowOffsetY:1

total_frames:2
animation_idle_start:0
animation_idle_end:1
animation_idle_speed:1.8
animation_moving_start:0
animation_moving_end:1
animation_moving_speed:1.8

splastEffect:true

lock_body_rotation_with_main_turret:true

movementEffect: CUSTOM:projectileTrail
movementEffectRate: 4

[effect_projectileTrail]
createWhenZoomedOut:false
priority:low
image:SHARED:light_50.png
life:28
fadeOut:true
attachedToUnit:false
color:#FF0000
fadeInTime:2
scaleFrom:1.0
scaleTo:0.8
alpha:0.3
drawUnderUnits:true
ySpeedRelative:-0.4
atmospheric:true

[attack]
canAttack:true
canAttackFlyingUnits:true
canAttackLandUnits:true
canAttackUnderwaterUnits:false

maxAttackRange:180
shootDelay:90
aimOffsetSpread:0

[turret_1]
x:0
y:0
barrelY:10
invisible:true

turnSpeed:4.1

shoot_sound: plasma_fire2
shoot_sound_vol: 0.4
shoot_flame: NONE
shoot_light: #FF0000

recoilOffset:-4
recoilOutTime:7
recoilReturnTime:24

warmup: 30

[projectile_1]
tags= T-projectile
directDamage:80
life:60
speed:6

frame:6
drawSize:1.1

color: #8B0000

lightColor:#bb99dd
lightSize: 0.7

spawnUnit:溃质

[movement]
movementType:AIR
moveSpeed:1.4
moveAccelerationSpeed:0.5
moveDecelerationSpeed:0.1

maxTurnSpeed:4
turnAcceleration:0.5

targetHeight:20
targetHeightDrift:1

[ai]
upgradedFrom: 蜂王