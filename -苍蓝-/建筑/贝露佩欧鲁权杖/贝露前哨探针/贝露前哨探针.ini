
[core]
name: 贝露前哨探针
class: CustomUnitMetadata
displayText: 贝露前哨探针
displayDescription:-苍蓝阵营\n-生成贝露基地\n-护盾损坏后进入攻击模式\n-较广视野
price: 8000
maxHp: 800
mass: 100000
maxShield: 600
shieldRegen: 0.15

tags: units, 贝露之眼, 贝露中心单位
showActionsWithMixedSelectionIfOtherUnitsHaveTag: 贝露之眼

isUnrepairableUnit: true

techLevel: 1

buildSpeed: 13.9s

radius: 15

generation_credits: 18
generation_delay: 40

isBio: false
isBuilder: true
dieOnConstruct: true
nanoRange: 12

energyMax: 500
energyRegen: 0
energyStartingPercentage: 0.01

fogOfWarSightRange: 28

transportSlotsNeeded: 99

autoTriggerCooldownTime: 2
autoTriggerCooldownTime_allowDangerousHighCPU:true

[hiddenAction_破碎之星]
autoTriggerOnEvent: destroyed
requireConditional: if self.hasResources(起始基地=1)
spawnUnits: 碎星核, 基地亡语

[resource_起始基地]
displayName: 起始基地

[hiddenAction_阵营]
autoTrigger: if not self.globalTeamTags(includes='苍蓝')
addGlobalTeamTags: 苍蓝

[hiddenAction_movementEffect]
autoTrigger: if self.numberOfAttachedUnits(withTag="碎质合成")<=0
spawnEffects: CUSTOM:trailL, CUSTOM:trailR, CUSTOM:trailL2, CUSTOM:trailR2

[hiddenAction_碎质-movementEffect]
autoTrigger: if self.numberOfAttachedUnits(withTag="碎质合成")>0
spawnEffects: CUSTOM:紫trailL, CUSTOM:紫trailR, CUSTOM:紫trailL2, CUSTOM:紫trailR2

[hiddenAction_created]
autoTriggerOnEvent: completeAndActive
addResources: T=1

[action_1]
isVisible: if self.resource(type="T", equalTo=1)
isLocked: if self.isOverwater
buildSpeed: 3s
@define units: 贝露佩欧鲁权杖
id: ${section.text}
text: 前哨站生成
description: 生成${units}
displayType: queueUnit
pos: 1
convertTo: ${units}
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
addResources: setFlag=10
alsoTriggerAction: 束1,束2,束3,束4,束5,束6,束7,束8
alwaysSinglePress: true
whenBuilding_cannotMove: true
whenBuilding_rotateTo: -90
setBodyRotation: self.dir-(self.dir+90)
offsetSelfAbsolute: 0, 0, -3

setUnitMemory: 属性[14]=0+self.resource.血量强化, 属性[15]=0

[action_2]
@copyFromSection: action_1
isVisible: if self.resource(type="T", equalTo=2)
text: 前哨站生成T2
@define units: 贝露佩欧鲁权杖T2
buildSpeed: 2s

[action_3]
@copyFromSection: action_1
isVisible: if self.resource(type="T", equalTo=3)
text: 前哨站生成T3
@define units: 贝露佩欧鲁权杖T3
buildSpeed: 1s

[action_4]
@copyFromSection: action_1
isVisible: if self.resource(type="T", equalTo=4)
isLocked: false
text: 前哨站生成T4
@define units: 贝露佩欧鲁权杖T4
buildSpeed: 0.1s

[hiddenAction_束1]
fireTurretXAtGround_withProjectile: 束1
fireTurretXAtGround_withOffset: 0,150
fireTurretXAtGround: magic
playSoundAtUnit: plasma_fire:0.05
spawnEffects: CUSTOM:curewave, CUSTOM:蓝幕

[hiddenAction_束2]
fireTurretXAtGround_withProjectile: 束1
fireTurretXAtGround: magic
fireTurretXAtGround_withOffset: 0,-150

[hiddenAction_束3]
@copyFromSection: hiddenAction_束2
fireTurretXAtGround_withOffset: 150,0

[hiddenAction_束4]
@copyFromSection: hiddenAction_束2
fireTurretXAtGround_withOffset: -150,0

[hiddenAction_束5]
@copyFromSection: hiddenAction_束2
fireTurretXAtGround_withOffset: 300,300

[hiddenAction_束6]
@copyFromSection: hiddenAction_束2
fireTurretXAtGround_withOffset: -300,300

[hiddenAction_束7]
@copyFromSection: hiddenAction_束2
fireTurretXAtGround_withOffset: 300,-300

[hiddenAction_束8]
@copyFromSection: hiddenAction_束2
fireTurretXAtGround_withOffset: -300,-300

[effect_curewave]
stripIndex: shockwave_large
life: 30
scaleFrom: 0
scaleTo: 10
alpha: 0.9
color: #33E8E8
priority: veryhigh
dirSpeed: 5


[hiddenAction_至高权能]
autoTrigger: if numberOfUnitsInTeam(withTag="权能模块", greaterThan=0, withinRange=50) and self.queueSize<1
convertTo: 贝露前哨探针T4
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
resourceAmount: T
resourceAmount_setValue: 4
addGlobalTeamTags: 贝露权杖T4


[hiddenAction_convert]
autoTrigger: if self.Shield(lessThan=10) and self.queueSize(empty=true)
convertTo: 贝露前哨探针[战斗]
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
isVisible: false



[hiddenAction_装甲血量强化]
autoTriggerOnEvent: newMessage(withTag='血量强化')
addResourcesWithLogic: 血量强化=eventData(name='变值', type='float')
setUnitMemory: 属性[14]=(self.resource.血量强化 + eventData(name='变值', type='float')) * 0.25
alsoTriggerAction: 属性变化

[hiddenAction_装甲β血量]
autoTrigger: if self.numberOfAttachedUnits(withTag="贝露装甲模块β", greaterThan=0) and self.shield(greaterThan=300) and self.resource.装甲血量!=self.hp
setResourcesWithLogic: 装甲血量=self.hp

[hiddenAction_回流之盾]
autoTriggerOnEvent: tookDamage
requireConditional: if self.numberOfAttachedUnits(withTag="贝露装甲模块β", greaterThan=0) and self.resource.装甲血量>self.hp and self.shield(greaterThan=300) and not self.hp(full=true)
setResourcesWithLogic: shield=self.shield-(self.resource.装甲血量-self.hp), hp=self.hp+min((self.resource.装甲血量-self.hp), self.maxShield), 装甲血量=self.hp

[resource_装甲血量]
hidden: true




[hiddenAction_白幕之光]
autoTriggerOnEvent: destroyed
requireConditional: if self.hasResources(credits=250000)
spawnUnits: 白暮
spawnEffects: CUSTOM:白光波, CUSTOM:白光

[effect_白光波]
stripIndex: shockwave_large
life: 50
scaleFrom: 0
scaleTo: 5
dirSpeed: 5

[effect_白光]
stripIndex: light_50
life: 50
scaleFrom: 5
scaleTo: 1



[resource_T]
displayName: T

[resource_血量强化]
hidden: true

[attachment_unitSlot1]
x: 0
y: 0
idleDir: 0

addTransportedUnits: true
setDrawLayerOnTop: true
lockLegMovement:false

canBeAttackedAndDamaged: false
isUnselectable: false

lockRotation: true

createIncompleteIfParentIs: false

[attachment_unitSlot2]
@copyFromSection: attachment_unitSlot1

[attachment_unitSlot3]
@copyFromSection: attachment_unitSlot2

[attachment_unitSlot4]
@copyFromSection: attachment_unitSlot2

[attachment_unitSlot5]
@copyFromSection: attachment_unitSlot2


[arm_1]
x: 0
y: 0
spinRate: 0.2

[decal_探针T1]
isVisible: if self.resource(type="T")<=1
layer: afterBody
order: 0.1
image: 探针T1.png
image_shadow: SHADOW:${section.image}
shadowOffsetX: 0
shadowOffsetY: 0

[decal_探针T2]
@copyFromSection: decal_探针T1
isVisible: if self.resource(type="T")==2
image: 探针T2.png

[decal_探针T3]
@copyFromSection: decal_探针T1
isVisible: if self.resource(type="T")==3
image: 探针T3.png

[decal_探针T4]
@copyFromSection: decal_探针T1
isVisible: if self.resource(type="T")==4 and self.numberOfAttachedUnits(withTag="碎质合成")<=0
image: 探针T4.png

[decal_探针T4描边]
isVisible: if self.resource(type="T")==4
onlyWhenSelectedByAnyPlayer: true
layer: beforeUI
order: 1
image: 探针终模描边.png
alpha: 0.4 + ${timerCos_2s}
@define timerCos_2s: cos( ((self.timeAlive % 2) / 2) * 360) * 0.15


[decal_法阵]
isVisible: if self.numberOfAttachedUnits(withTag="碎质合成")<=0
layer: afterBody
order: 0.3
image: 法阵.png
imageScale: 0.31 + (0.031*self.resource(type="T"))
alpha: 0.8 + ${timerCos_5s}
@define timerCos_5s: cos( ((self.timeAlive % 5) / 5) * 360) * 0.3
basePositionFromLegEnd: arm_1

[decal_水晶烁光]
isVisible: if self.numberOfAttachedUnits(withTag="碎质合成")<=0
layer: afterBody
order: 0.6
image: 蓝烁星光.png
imageScale: 0.6 + (0.066*self.resource(type="T"))
alpha: 0.2 + ${timerCos_8s}
@define timerCos_8s: cos( ((self.timeAlive % 8) / 8) * 360) * 0.05
basePositionFromLegEnd: arm_1


[decal_探针-碎质合成]
@copyFromSection: decal_探针T1
isVisible: if self.numberOfAttachedUnits(withTag="碎质合成")>0 and self.resource(type="T")==4
order: 0.12
image: 探针碎质.png

[decal_法阵-碎质合成]
@copyFromSection: decal_法阵
isVisible: if self.numberOfAttachedUnits(withTag="碎质合成")>0
image: 紫法阵.png

[decal_水晶烁光-碎质合成]
@copyFromSection: decal_水晶烁光
isVisible: if self.numberOfAttachedUnits(withTag="碎质合成")>0
image: 紫烁星光.png

[decal_权杖水晶烁光-碎质合成]
isVisible: if self.numberOfAttachedUnits(withTag="碎质合成")>0
layer: afterBody
order: 0.62
image: 紫烁星光.png
imageScale: 0.4
alpha: 0.4 + ${timerCos_8s}
alwaysStartDirAtZero: true
yOffsetAbsolute: -${ShuiJingY} - ${timerCos_5s}

@define timerCos_5s: cos( ((self.timeAlive % 5) / 5) * 360) * 1

@define timerCos_8s: cos( ((self.timeAlive % 8) / 8) * 360) * 0.1

[decal_权杖水晶-碎质合成]
isVisible: if self.numberOfAttachedUnits(withTag="碎质合成")>0
layer: afterBody
order: 0.22
image: 碎质水晶.png
alpha: 0.5
alwaysStartDirAtZero: true
yOffsetAbsolute: -${ShuiJingY} - ${timerCos_5s}
@global ShuiJingY: 50
@define timerCos_5s: cos( ((self.timeAlive % 5) / 5) * 360) * 1

[decal_探针-永恒虚星]
@copyFromSection: decal_探针T1
isVisible: if self.numberOfAttachedUnits(withTag="永恒虚星")>0 and self.resource(type="T")==4
order: 0.12
image: 探针虚星.png

[graphics]
total_frames: 1
image:        大空.png
image_wreak:  NONE
image_turret: NONE
scaleImagesTo: 22

drawLayer: experimentals

showEnergyBar: false

#AUTO
image_shadow: AUTO
shadowOffsetX:1
shadowOffsetY:1

splastEffect: true

[effect_trailL]
createWhenZoomedOut: false
priority:low
image: 白光.png
life: 30
fadeOut: true
attachedToUnit: false
color: #4CE1FF
fadeInTime:2
scaleFrom: 0.4
scaleTo: 0.7
alpha: 0.4
drawUnderUnits:true
ySpeedRelative:-0.8
atmospheric: true
xOffsetRelative:8
yOffsetRelative:0
[effect_trailR]
@copyFromSection: effect_trailL
xOffsetRelative:-8
[effect_trailL2]
@copyFromSection: effect_trailL
xOffsetRelative:8
yOffsetRelative:10
[effect_trailR2]
@copyFromSection: effect_trailL
xOffsetRelative:-8
yOffsetRelative:10


[effect_紫trailL]
@copyFromSection: effect_trailL
color: #C44CFF

[effect_紫trailR]
@copyFromSection: effect_trailR
color: #C44CFF

[effect_紫trailL2]
@copyFromSection: effect_trailL2
color: #C44CFF

[effect_紫trailR2]
@copyFromSection: effect_trailR2
color: #C44CFF


[attack]

canAttack: false
canAttackFlyingUnits: false
canAttackLandUnits:   false
canAttackUnderwaterUnits: false

turretSize: 3
turretTurnSpeed: 5

maxAttackRange: 190
showRangeUIGuide: true
shootDelay: 5

aimOffsetSpread: 0


[turret_1]
x: 0
y: 5
invisible: true
turnSpeedAcceleration: 0.08

limitingRange: 360
showRangeUIGuide: true

[turret_magic]
x: 0
y: 0
canShoot: false

[projectile_束1]
tags= T-projectile
life: 60
speed: 2
areaDamage: 10
areaRadius: 30
explodeEffect: CUSTOM:束光, CUSTOM:束波
largeHitEffect: true
laserEffect: true
color: #1418FFFF
instant:true
spawnProjectilesOnCreate: 束1-2, 束1-3, 束1-4, 束1-5, 束1-6, 束1-7, 束1-8, 束1-9, 束1-10

[projectile_束1-2]
@copyFromSection: projectile_束1
spawnProjectilesOnCreate: NONE
life: 54

[projectile_束1-3]
@copyFromSection: projectile_束1-2
life: 48

[projectile_束1-4]
@copyFromSection: projectile_束1-2
life: 42

[projectile_束1-5]
@copyFromSection: projectile_束1-2
life: 36

[projectile_束1-6]
@copyFromSection: projectile_束1-2
life: 30

[projectile_束1-7]
@copyFromSection: projectile_束1-2
life: 24

[projectile_束1-8]
@copyFromSection: projectile_束1-2
life: 18

[projectile_束1-9]
@copyFromSection: projectile_束1-2
life: 12

[projectile_束1-10]
@copyFromSection: projectile_束1-2
life: 6

[effect_束光]
image: SHARED:light_50.png
life: 60
scaleFrom: 1.5
scaleTo: 0
alpha: 1
color: #33E8E8
priority: veryhigh

[effect_束波]
@copyFromSection: effect_束光
stripIndex: shockwave_large
life: 60
scaleFrom: 0
scaleTo: 1
alsoPlaySound: laser_deflect:2.5
delayedStartTimerRandom: 10

[effect_蓝幕]
priority: critical
image: 白.png
life: 50
alpha: 0.2
scaleFrom: 5.0
scaleTo: 5.0
drawUnderUnits: false
createWhenOffscreen: true
color: #33E8E8

[movement]
movementType: OVER_CLIFF_WATER
moveSpeed: 1.0
moveAccelerationSpeed: 0.05
moveDecelerationSpeed: 0.05

targetHeight: 3
targetHeightDrift: 1

maxTurnSpeed: 4
turnAcceleration: 0.2

moveSlidingMode :true
moveIgnoringBody:true
moveSlidingDir:  181

[ai]
useAsBuilder: true

