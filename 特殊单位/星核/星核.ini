[core]
name: 星核
displayText: 星核
maxHp: 500
mass: 1000000
price: 0
radius: 10
selfRegenRate: 0.1
selfBuildRate: 0.05

tags: 星核, 可承伤单位, 虚无

displayDescription: -生产资源 \n -首次获取时增加[游戏时间/1s×10]资源$ \n -首次获取获得全图视野30s \n -当混沌之源存在时资源产出增加 \n -当起始基地被摧毁，星核会伴随能量波动而出现 \n -能量波动会对原所属阵营造成[700|50范围|对建筑*10]伤害 \n -没有其他单位存在时可消耗大量资源生成己方阵营建造者

maxShield: 100

generation_credits: 15
borrowResourcesWhileAlive: 经济=-${core.generation_credits}

isBuilding: true
experimental: true

footprint: 1,1,-1,-1
constructionFootprint: 1,1,-1,-1

isUnrepairableUnit: true
fogOfWarSightRange: 15
disableAllUnitCollisions: true

numBitsOnDeath:	0
explodeOnDeath: false
hideScorchMark: true

disableDeathOnZeroHp: true

effectOnDeath: shockwave, 白爆炸
soundOnDeath: unit_explode

autoTriggerCooldownTime: 0.1s

[global_resource_经济]
hidden: true

[action_kill]
id: ${section.text}
text: 自毁
pos: 1
displayType: infoOnly
ai_isDisabled: true
allowMultipleInQueue: false
buildSpeed: 5s
setResourcesWithLogic: hp=-99999

[action_新解]
isVisible: if self.globalTeamTags(includes="新之铁锈阵营")
id: ${section.text}
text: 新解
description: -新之铁锈- \n -提取星核深处的能量 \n -获得20新能魔素 \n -会导致星核永久消失
displayType: action
allowMultipleInQueue: false
buildSpeed: 10s
pos: 2
addResources: 新能魔素=20
spawnEffects: CUSTOM:耀光, CUSTOM:耀放光, shockwave
deleteSelf: true

[action_神噬]
isVisible: if ${HalfCorrosion} ${HalfCorrosionLimit} and self.globalTeamTags(includes="虫族") and not self.globalTeamTags(includes="皎红") and numberOfUnitsInTeam(withTag='皎红出场')<1
price: 15000, 腐蚀=2000
id: ${section.text}
text: 神噬
description: =联动-皎洁之红= \n -破碎维度的缝隙 \n -召唤皎红母虫 \n -会导致星核永久消失
displayType: action
onlyOneUnitAtATime: true
buildSpeed: 0s
pos: 3
iconImage: 皎红icon.png
iconExtraImage: 红外光圈2.png
spawnUnits: 皎月升起(offsetHeight=500)
spawnEffects: 红耀光, 红耀放光
deleteSelf: true

[action_皎红锚点]
@copyFromSection: action_神噬
isVisible: if ${HalfCorrosion} ${HalfCorrosionLimit} and self.globalTeamTags(includes="虫族") and self.globalTeamTags(includes="皎红") and numberOfUnitsInTeam(withTag='皎红母虫')<1
price: 6000, 腐蚀=1000
text: 皎红锚点
description: =联动-皎洁之红= \n -再度召唤皎红母虫
spawnUnits: 皎红裂隙
deleteSelf: false

[action_光辉]
autoTrigger: if self.globalTeamTags(includes='狂猎') and not self.hasFlag(id=3)
isActive: false
isVisible: false
text: 光辉
description: -虫族狂猎- \n -净化腐蚀获得资源 \n -持续期间不会被破坏 \n -第一次被获取或进入狂猎时刻时会释放一次 \n -持续20秒
displayType: infoOnly
isGuiBlinking: true
buildSpeed: 0s
pos: 2
convertTo: 光辉星核
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
addResources: setFlag=3


[hiddenAction_created]
autoTriggerOnEvent: completeAndActive
spawnEffects: CUSTOM:光芒

[hiddenAction_death]
autoTrigger: if self.hp<5
convertTo: 碎星核
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}
addResources: hp=1000, shield=1000
setResourcesWithLogic: 毒素=0, 弱效毒素=0
spawnEffects: CUSTOM:耀光, CUSTOM:耀放光, CUSTOM:耀光散*7, shockwave, 白爆炸
playSoundAtUnit: unit_explode
switchToAggressiveTeam: true

[hiddenAction_upgrade]
autoTrigger: if numberOfUnitsInAllTeams(withTag="混沌元素", greaterThan=0)
convertTo: 星核T2
sendMessageTo: ${ConvertUpdate1}
sendMessageWithTags: ${ConvertUpdate2}


[hiddenAction_星核耀光]
autoTrigger: if self.hasFlag(id=0) and numberOfUnitsInTeam(withTag='单位系统')>0
addResources: unsetFlag=0
addResourcesWithLogic: credits=globalSearchForFirstUnit(withTag='单位系统', relation='own').timeAlive*10, 世界意志=1
spawnUnits: 全图视野(addResources=ammo:1)
showQuickWarLogToPlayer: 获得来自星核的%{globalSearchForFirstUnit(withTag='单位系统', relation='own').timeAlive*10}资源$，并揭开30s全图迷雾
spawnEffects: 光芒2, 放光, 散光圈, 微散光粒*6

[hiddenAction_缺少单位系统]
autoTrigger: if self.hasFlag(id=0) and numberOfUnitsInTeam(withTag='单位系统')<1
addResources: unsetFlag=0
showQuickWarLogToPlayer: -缺少单位系统

[global_resource_世界意志]
displayName: 世界意志



[canBuild_铁锈]
isLocked: if numberOfUnitsInTeam(withTag='units', factoryQueue=true)>0
isLockedMessage: 有单位正在生产
isVisible: if self.globalTeamTags(includes="铁锈") and numberOfUnitsInTeam(withTag='units', incompleteBuildings=true)<1
price: 10000
name: 建造者T2

[canBuild_虫族]
isLocked: if numberOfUnitsInTeam(withTag='units', factoryQueue=true)>0
isLockedMessage: 有单位正在生产
isVisible: if self.globalTeamTags(includes="虫族") and numberOfUnitsInTeam(withTag='units', incompleteBuildings=true)<1
price: 10000
name: 筑炼者

[canBuild_帝国]
isLocked: if numberOfUnitsInTeam(withTag='units', factoryQueue=true)>0
isLockedMessage: 有单位正在生产
isVisible: if self.globalTeamTags(includes="帝国") and numberOfUnitsInTeam(withTag='units', incompleteBuildings=true)<1
price: 10000
name: 帝国建造者T2

[canBuild_苍蓝]
isLocked: if numberOfUnitsInTeam(withTag='units', factoryQueue=true)>0
isLockedMessage: 有单位正在生产
isVisible: if self.globalTeamTags(includes="苍蓝") and numberOfUnitsInTeam(withTag='units', incompleteBuildings=true)<1
price: 10000
name: 机械苍蓝眼

[canBuild_新之铁锈阵营]
isLocked: if numberOfUnitsInTeam(withTag='units', factoryQueue=true)>0
isLockedMessage: 有单位正在生产
isVisible: if self.globalTeamTags(includes="新之铁锈阵营") and numberOfUnitsInTeam(withTag='units', incompleteBuildings=true)<1
price: 10000
name: megaBuilder翻山走水

[canBuild_幽暗]
isLocked: if numberOfUnitsInTeam(withTag='units', factoryQueue=true)>0
isLockedMessage: 有单位正在生产
isVisible: if self.globalTeamTags(includes="幽暗") and numberOfUnitsInTeam(withTag='units', incompleteBuildings=true)<1
price: 10000
name: 虚空爬虫



[hiddenAction_毒素血量减血]
autoTrigger: if self.resource.毒素>0
addResourcesWithLogic: hp=-min(min(self.resource.毒素, 6), self.hp-6), 毒素=-min(min(self.resource.毒素, 6), max(self.hp-6, 0.5))

[hiddenAction_弱效毒素减血]
autoTrigger: if self.resource.弱效毒素>0 and self.resource.毒素<=0
addResourcesWithLogic: hp=-min(min(self.resource.毒素, 2), self.hp-6), 毒素=-min(min(self.resource.毒素, 2), max(self.hp-6, 0.16))

[resource_毒素]
displayName: 毒素

[resource_弱效毒素]
displayName: 弱效毒素

[graphics]
image: 星核.png
image_shadow: 白微波.png
image_shield: 光圈.png
drawLayer: experimentals
disableLowHpFire: true
disableLowHpSmoke: true

[decal_星光]
layer: afterBody
image: 烁星光.png
imageScale: 0.7
alpha: 0.2

[arm_1]
x: 0
y: 0
image_end: 星光1.png
drawUnderAllUnits: true
spinRate: 0.1

[arm_2]
x: 0
y: 0
copyFrom: 1
image_end: 星光2.png
spinRate: 0.2

[arm_3]
x: 0
y: 0
copyFrom: 1
image_end: 星光3.png
spinRate: 0.25

[arm_4]
x: 0
y: 0
copyFrom: 1
image_end: 星光4.png
spinRate: 0.32

[arm_5]
x: 0
y: 0
copyFrom: 1
image_end: 星光5.png
spinRate: 0.46


[attack]
canAttack:false

[effect_光芒]
priority: veryhigh
attachedToUnit: true
life: 50
alpha: 1
scaleFrom: 2
scaleTo: 0.5
image: SHARED:light_50.png
color: #FFFFFF
drawUnderUnits: false
createWhenOffscreen: true
showInFog: true

[effect_光芒2]
@copyFromSection: effect_光芒
life: 30
alpha: 0.5
scaleFrom: 3
scaleTo: 3

[effect_放光]
@copyFromSection: effect_光芒
life: 20
alpha: 0.6
scaleFrom: 0.1
scaleTo: 2
dirOffsetRandom: 180
dirSpeedRandom: 5

[effect_散光圈]
@copyFromSection: effect_放光
life: 40
alpha: 0.6
scaleFrom: 0.1
scaleTo: 1.5
image: 光圈.png

[effect_微散光粒]
priority: verylow
attachedToUnit: false
life: 80
lifeRandom: 30
image: 白粒.png
color: #FFFFFF
scaleFrom: 1
scaleTo: 1
alpha: 0.8
dirOffsetRandom: 180
dirSpeedRandom: 5
xSpeedRelativeRandom: 1
ySpeedRelativeRandom: 1
drawUnderUnits: false


[effect_白爆炸]
priority: veryhigh
life: 25
attachedToUnit: true
image: 白爆.png
scaleFrom: 1.1
scaleTo: 1.1
alpha: 0.8
total_frames: 14
animateFrameStart: 0
animateFrameEnd: 13
animateFrameSpeed: 0.5
fadeOut: false


[effect_耀光]
priority: veryhigh
attachedToUnit: true
life: 50
alpha: 0.7
scaleFrom: 1.7
scaleTo: 0
image: SHARED:light_50.png
color: #E6E6E6
fadeOut: false
drawUnderUnits: false

[effect_红耀光]
@copyFromSection: effect_耀光
color: #FF0000

[effect_耀放光]
@copyFromSection: effect_耀光
fadeOut: true
life: 20
alpha: 0.7
scaleFrom: 0.5
scaleTo: 1.5

[effect_红耀放光]
@copyFromSection: effect_耀放光
color: #FF0000

[effect_耀光散]
@copyFromSection: effect_耀光
life: 40
lifeRandom: 15
alpha: 0.9
scaleFrom: 0.3
scaleTo: 0.1
color: #FFFFFF
fadeOut: true
atmospheric: true
xSpeedRelativeRandom: 2
ySpeedRelativeRandom: 2

[effect_光辉]
priority:high

image: SHARED:light_50.png
life: 15
fadeOut: true
attachedToUnit: true
color: #FFFFFF

scaleFrom: 1
scaleTo: 1
alpha: 0.3
drawUnderUnits:false

[effect_光粒]
priority: verylow
attachedToUnit: false
life: 30
image: SHARED:spark.png
color: #FFFFFF
scaleFrom: 1.5
scaleTo: 1
hSpeed: 1
hSpeedRandom: 0.2
xOffsetRelativeRandom: 15
yOffsetRelativeRandom: 15
drawUnderUnits: false

[movement]
movementType: OVER_CLIFF_WATER
targetHeight: 0
targetHeightDrift: 0.1



[global_resource_玩家总数]
displayName: 玩家总数
