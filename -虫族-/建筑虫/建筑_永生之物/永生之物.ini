
[core]
name: 永生之物
displayDescription: -可装载一个虫族单位 \n -随后进入的单位将炼化为第一个单位提供[永生之物]提升血量上限 \n -每8价值或2腐蚀的单位可提供1血量上限的[永生之物] \n -可继承80%[永生之物]

price: 45000
maxHp: 5000
mass: 90000

footprint: -3,-1,3,1
constructionFootprint: -3,-2,3,2
displayFootprint: -3,-1,3,2

techLevel: 2
buildSpeed: 0.0002

isBio: true
isBug: true
isBuilding: true

selfRegenRate: 0.25
selfBuildRate: 0.0002

tags: units, 虫族, 虫建筑

radius: 55
softCollisionOnAll: 10

maxTransportingUnits: 100
transportUnitsRequireTag: 虫族
transportUnitsBlockAirAndWaterUnits: false
transportUnitsBlockOtherTransports: false
transportUnitsKillOnDeath: false

[action_永生之物]
isVisible: if self.transportingCount>0
isActive: false
id: 永生之物显示
text: 永生之物: (%{self.transporting(slot=0).resource.永生之物})
description: [%{self.transporting(slot=0)}]
pos: 1
displayType: infoOnly
buildSpeed: 0s

[hiddenAction_生神之赠]
autoTriggerOnEvent: transportingNewUnit
requireConditional: if self.transportingCount>1 and not self.transporting(slot=1).tags(includes='召唤物')
sendMessageTo: self.transporting(slot=0)
sendMessageWithTags: 数据更新
sendMessageWithData: 血量加值=int(self.transporting(slot=1).priceCredits/8 + self.transporting(slot=1).readUnitMemory('腐蚀价格', type='float')/2 + self.transporting(slot=1).resource.永生之物*0.8), 永生之物=int(self.transporting(slot=1).priceCredits/8 + self.transporting(slot=1).readUnitMemory('腐蚀价格', type='float')/2 + self.transporting(slot=1).resource.永生之物*0.8)
alsoTriggerAction: 生滅
spawnEffects: 主旋生成, 光粒子*8

[hiddenAction_生滅]
deleteNumUnitsFromTransport: 1

[hiddenAction_无价回还]
autoTriggerOnEvent: transportingNewUnit
requireConditional: if self.transporting(slot=1).tags(includes='召唤物')
forceUnloadTransportNow: true
forceUnloadTransportNow_onlyOnSlot: 1

#--------------------
[action_沙盒-永生之物]
isVisible: if substring(str(createMarker(x=-1000,y=-1000).nearestUnit),0,15) == "editorOrBuilder" and self.transportingCount>0
displayType: action
id: ${section.text}
text: 沙盒-神格
description: -沙盒特供 \n -增加1000000永生之物
iconImage: SHARED:cone_inverted_normal_128.png
sendMessageTo: self.transporting(slot=0)
sendMessageWithTags: 数据更新
sendMessageWithData: 血量加值=1000000, 永生之物=1000000
spawnEffects: 主旋生成*2, 光粒子*20
buildSpeed: 0.05s
#--------------------


[effect_主旋生成]
priority: veryhigh
image: SHARED:blank.png
life: 60
trailEffect: 主旋, 主聚, 光粒子
trailEffectRate: 3

[effect_主旋]
priority: high
life: 70
fadeInTime: 20
image: 风.png
scaleFrom: 2.5
scaleTo: 0
alpha: 0.2
hSpeed: 1.6
dirSpeedRandom: 4

[effect_主聚]
priority: high
life: 60
fadeInTime: 10
image: 风卷.png
scaleFrom: 1
scaleTo: 0
alpha: 0.2
dirSpeedRandom: 4
drawUnderUnits: true

[effect_光粒子]
attachedToUnit: false
life: 120
fadeInTime: 20
xOffsetRelativeRandom: 60
yOffsetRelativeRandom: 60
xSpeedRelativeRandom: 2
ySpeedRelativeRandom: 2
scaleFrom: 0.15
scaleTo: 0.1
alpha: 0.6
hSpeed: 3
hSpeedRandom: 1.5
physics: true
physicsGravity: -1
image: SHARED:light_50.png
priority: verylow
color: #FF3BFF00

dirSpeedRandom: 3
dirOffsetRandom: 180
delayedStartTimerRandom: 10



[attachment_1]
x: 0
y: -2
idleDir: 0
canAttack: false
lockLegMovement: true
resetRotationWhenNotAttacking: true
addTransportedUnits: true
keepAliveWhenParentDies: true
canBeAttackedAndDamaged: true
prioritizeParentsMainTarget: true
isUnselectable: true

smoothlyBlendPositionWhenExistingUnitAdded: true

[attachment_2]
x: 0
y: 0
isVisible: false
canAttack: false
addTransportedUnits: true
keepAliveWhenParentDies: true
canBeAttackedAndDamaged: false
isUnselectable: true

[animation_1]
onActions: idle
pingPong: true
scale_start: 1
scale_end: 1.01
speed: 100

[graphics]
image: 永生之物_上.png
image_back: 永生之物.png

showTransportBar: false

[decal_底光]
onlyWhileAlive: true
layer: afterBody
@define timer_3s: ((self.timeAlive() % 3) / 3)
alpha: 0.1+cos( ${timer_3s} * 360) * 0.05
image: 绿光.png
imageScale: 4

[decal_芯光]
onlyWhileAlive: true
layer: afterBody
@define timer_3s: ((self.timeAlive() % 3) / 3)
alpha: 0.5+cos( ${timer_3s} * 360) * 0.2
image: 绿光.png
imageScale: 0.8
yOffsetRelative: 45

[decal_主光]
onlyWhileAlive: true
layer: beforeUI
isVisible: if self.transportingCount>0
@define timer_3s: ((self.timeAlive() % 3) / 3)
alpha: 0.15+cos( ${timer_3s} * 360) * 0.03
image: 主绿光.png
imageScale: 3.5+cos( ${timer_3s} * 360) * 0.7

[attack]
canAttack: false
canAttackFlyingUnits: false
canAttackLandUnits: false
canAttackUnderwaterUnits: false

[movement]
movementType: BUILDING

[ai]
maxGlobal: 0