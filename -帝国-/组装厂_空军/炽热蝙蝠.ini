
[core]
name: 炽热蝙蝠
displayText: 炽热蝙蝠
displayDescription: -攻击空中单位 \n -开火逐渐加快
class: CustomUnitMetadata
price: 2500
maxHp: 1200
mass: 10000

#maxShield: 
#shieldRegen: -
#shieldRenderRadius: 22

tags: units, 空军, 转向攻击
techLevel: 1

buildSpeed: 20.8s

radius: 18

autoTriggerCooldownTime: 0.01s
autoTriggerCooldownTime_allowDangerousHighCPU:true

[action_炽热裂痕]
isVisible: true
isActive: false
text: 炽热裂痕×%{1+(0.1 * ((min(self.resource.炽热裂痕, 800)/200) * (min(self.resource.炽热裂痕, 800)/200)))}
description: -短时间内受到伤害越高攻速越快
pos: 1
displayType: infoOnly
buildSpeed: 0s
iconImage: 紫裂痕.png
isGuiBlinking: if self.resource.炽热裂痕>200

autoTrigger: if min(self.resource.炽热裂痕, 800)>0
setUnitMemory: 属性[18]=0+(0.1 * ((min(self.resource.炽热裂痕, 800)/200) * (min(self.resource.炽热裂痕, 800)/200)))
alsoTriggerAction: 属性变化
addResourcesWithLogic: 炽热裂痕=-(1 + (self.resource.炽热裂痕*0.004))

[hiddenAction_血量记录]
autoTrigger: if self.resource.受击前血量!=self.hp
setResourcesWithLogic: 受击前血量=self.hp

[hiddenAction_受伤血量]
autoTriggerOnEvent: tookDamage
requireConditional: if self.resource.受击前血量>self.hp
setResourcesWithLogic: 炽热裂痕=self.resource.炽热裂痕+(self.resource.受击前血量-self.hp), 受击前血量=self.hp

[resource_受击前血量]
hidden: true

[resource_炽热裂痕]
displayName: 炽热裂痕
displayColor: #7900A1

[decal_1]
onlyWhileAlive: true
layer: afterBody
image: 紫裂痕.png
alpha: 0.9 * (self.resource.炽热裂痕/800)
imageScale: 0.25

[graphics]
total_frames: 1

image:        炽热蝙蝠.png
image_wreak: 炽热蝙蝠残骸.png
image_turret: NONE

lock_body_rotation_with_main_turret: true
teamColorsOnTurret: true

image_shadow:AUTO
shadowOffsetX:1
shadowOffsetY:1

movementEffect: CUSTOM:尾光
movementEffectRate: 2

[effect_尾光]
color: #7900A1
createWhenZoomedOut: false
priority:low
image: 白光.png
life: 40
fadeOut: true
attachedToUnit: false
fadeInTime:2
scaleFrom: 1.0
scaleTo: 0.8
alpha: 0.6
drawUnderUnits: true
ySpeedRelative:-0.4
atmospheric: true

[attack]
canAttack: true
canAttackFlyingUnits: true
canAttackLandUnits:   false
canAttackUnderwaterUnits: false

maxAttackRange: 190
shootDelay: 35

[hiddenAction_属性改变设定]
setUnitMemory: 属性[41]=cos(180)*(${turret_2.warmupShootDelayTransfer} / ${attack.shootDelay})

[turret_1]
invisible: true
x: 0
y: 0
idleDir:0

projectile: 1
size: 10

turnSpeed: 5.1
#turnSpeedAcceleration: 0.5

canShoot: false

[turret_2]
x: 0
y: 0
attachedTo: 1
slave: true

size: 30

turnSpeed: 0
turnSpeedAcceleration: 0

shoot_sound:plasma_fire
shoot_sound_vol:0.06
shoot_flame: NONE
shoot_light: #7900A1

warmup: 50
warmupCallDownRate: 1
warmupNoReset: true
warmupShootDelayTransfer: 15

warmupStartEffect:CUSTOM:shockwave*1

[projectile_1]
tags= T-projectile
directDamage: 70
life: 80
speed: 0
targetSpeed: 16
targetSpeedAcceleration: 0.7

drawType:2
frame:4
drawSize: 1
trailEffect: CUSTOM:尾光
trailEffectRate:0.5

#trailEffectRate: true

wobbleAmplitude: 2.5
wobbleFrequency: 5s

color:#7900A1

autoTargetingOnDeadTarget: true
autoTargetingOnDeadTargetRange: 50

explodeEffect: CUSTOM:projectilePassThough, smallExplosion, CUSTOM:hitLightFlash
explodeEffectOnShield: CUSTOM:hitLightFlash

effectOnCreate: CUSTOM:projectileLight

[effect_projectileLight]
priority:veryhigh

image: SHARED:light_50.png
life: 100
fadeOut: true
attachedToUnit: true
color: #7900A1
fadeInTime:2
scaleFrom: 0.3
scaleTo: 0.8
alpha: 0.8
drawUnderUnits:false
liveAfterAttachedDies: false

[effect_hitLightFlash]
priority:high

image: SHARED:light_50.png
life: 19
fadeOut: true
attachedToUnit: false
color: #7900A1

scaleFrom: 1.8
scaleTo: 1.8
alpha: 0.6
drawUnderUnits:false

[effect_projectilePassThough]

priority:high
frameIndex: 4
stripIndex: projectiles2
life: 20
fadeOut: true
attachedToUnit: false
color: #7900A1
scaleFrom: 1
scaleTo: 1
alpha: 1
drawUnderUnits:false
ySpeedRelative:2
atmospheric: true


[effect_shockwave]
stripIndex: shockwave
life: 8
scaleFrom: 0.5
scaleTo: 0
color: #7900A1

[movement]
movementType: AIR
moveSpeed: 2.1
moveAccelerationSpeed: 0.07
moveDecelerationSpeed: 0.1

maxTurnSpeed: 5.0
turnAcceleration: 0.3

reverseSpeedPercentage: 0.8

targetHeight: 20
targetHeightDrift: 1

moveSlidingMode :true
moveIgnoringBody:true
moveSlidingDir:  181

slowDeathFall: true
